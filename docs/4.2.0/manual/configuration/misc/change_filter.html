

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.5.24.2. ChangeFilter &mdash; Buildbot 4.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/buildbot_rtd.css?v=915d5e18" />

  
    <link rel="shortcut icon" href="../../../_static/icon.png"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=d0ae6d56"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.5.24.3. GitCredentialOptions" href="git_credential_options.html" />
    <link rel="prev" title="2.5.24.1. SourceStampFilter" href="source_stamp_filter.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Buildbot
              <img src="../../../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/index.html">2.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../secretsmanagement.html">2.4. Secret Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">2.5. Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro.html">2.5.1. Configuring Buildbot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../global.html">2.5.2. Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changesources.html">2.5.3. Change Sources and Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changesources.html#changes">2.5.4. Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../schedulers.html">2.5.5. Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workers.html">2.5.6. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builders.html">2.5.7. Builder Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../projects.html">2.5.8. Projects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../buildfactories.html">2.5.9. Build Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../buildsets.html">2.5.10. Build Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../properties.html">2.5.11. Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../steps/index.html">2.5.12. Build Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interlocks.html">2.5.13. Interlocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../report_generators/index.html">2.5.14. Report Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reporters/index.html">2.5.15. Reporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../www.html">2.5.16. Web Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wwwhooks.html">2.5.17. Change Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../services/index.html">2.5.18. Custom Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dbconfig.html">2.5.19. DbConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configurators.html">2.5.20. Configurators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manhole.html">2.5.21. Manhole</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multimaster.html">2.5.22. Multimaster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multicodebase.html">2.5.23. Multiple-Codebase Builds</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">2.5.24. Miscellaneous Configuration</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="source_stamp_filter.html">2.5.24.1. SourceStampFilter</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">2.5.24.2. ChangeFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="git_credential_options.html">2.5.24.3. GitCredentialOptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tests/index.html">2.5.25. Testing Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmdline.html">2.7. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources.html">2.8. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization.html">2.9. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">2.10. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deploy.html">2.11. Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrading/index.html">2.12. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><span class="section-number">2. </span>Buildbot Manual</a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">2.5. </span>Configuration</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">2.5.24. </span>Miscellaneous Configuration</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.5.24.2. </span>ChangeFilter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/manual/configuration/misc/change_filter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="changefilter">
<span id="id1"></span><h1><span class="section-number">2.5.24.2. </span>ChangeFilter<a class="headerlink" href="#changefilter" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.util.ChangeFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.util.</span></span><span class="sig-name descname"><span class="pre">ChangeFilter</span></span><a class="headerlink" href="#buildbot.util.ChangeFilter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<p>This class is used to filter changes.
It is conceptually very similar to <code class="docutils literal notranslate"><span class="pre">SourceStampFilter</span></code> except that it operates on changes.
The class accepts a set of conditions.
A change is considered <em>acepted</em> if all conditions are satisfied.
The conditions are specified via the constructor arguments.</p>
<p>The following parameters are supported by the <code class="xref py py-class docutils literal notranslate"><span class="pre">ChangeFilter</span></code>:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">project</span></code>, <code class="docutils literal notranslate"><span class="pre">repository</span></code>, <code class="docutils literal notranslate"><span class="pre">branch</span></code>, <code class="docutils literal notranslate"><span class="pre">category</span></code>, <code class="docutils literal notranslate"><span class="pre">codebase</span></code></dt><dd><p>(optional, a string or a list of strings)
The corresponding attribute of the change must match exactly to at least one string from the value supplied by the argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">branch</span></code> uses <code class="docutils literal notranslate"><span class="pre">util.NotABranch</span></code> as its default value which indicates that no checking should be done, because the branch may actually have <code class="docutils literal notranslate"><span class="pre">None</span></code> value to be checked.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">project_not_eq</span></code>, <code class="docutils literal notranslate"><span class="pre">repository_not_eq</span></code>, <code class="docutils literal notranslate"><span class="pre">branch_not_eq</span></code>, <code class="docutils literal notranslate"><span class="pre">category_not_eq</span></code>, <code class="docutils literal notranslate"><span class="pre">codebase_not_eq</span></code></dt><dd><p>(optional, a string or a list of strings)
The corresponding attribute of the change must not match exactly to any of the strings from the value supplied by the argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">branch</span></code> uses <code class="docutils literal notranslate"><span class="pre">util.NotABranch</span></code> as its default value which indicates that no checking should be done, because the branch may actually have <code class="docutils literal notranslate"><span class="pre">None</span></code> value to be checked.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">project_re</span></code>, <code class="docutils literal notranslate"><span class="pre">repository_re</span></code>, <code class="docutils literal notranslate"><span class="pre">branch_re</span></code>, <code class="docutils literal notranslate"><span class="pre">category_re</span></code>, <code class="docutils literal notranslate"><span class="pre">codebase_re</span></code></dt><dd><p>(optional, a string or a list of strings or regex pattern objects)
The corresponding attribute of the change must match to at least one regex from the value supplied by the argument.
Any strings passed via this parameter are converted to a regex via <code class="docutils literal notranslate"><span class="pre">re.compile</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">project_not_re</span></code>, <code class="docutils literal notranslate"><span class="pre">repository_not_re</span></code>, <code class="docutils literal notranslate"><span class="pre">branch_not_re</span></code>, <code class="docutils literal notranslate"><span class="pre">category_not_re</span></code>, <code class="docutils literal notranslate"><span class="pre">codebase_not_re</span></code></dt><dd><p>(optional, a string or a list of strings or regex pattern objects)
The corresponding attribute of the change must not match to at least any regex from the value supplied by the argument.
Any strings passed via this parameter are converted to a regex via <code class="docutils literal notranslate"><span class="pre">re.compile</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">property_eq</span></code></dt><dd><p>(optional, a dictionary containing string keys and values each of which with a string or a list of strings)
The property of the change with corresponding name must match exactly to at least one string from the value supplied by the argument.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">property_not_eq</span></code></dt><dd><p>(optional, a string or a list of strings)
The property of the change with corresponding name must not be present or not match exactly to at least one string from the value supplied by the argument.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">property_re</span></code></dt><dd><p>(optional, a string or a list of strings or regex pattern objects)
The property of the change with corresponding name must match to at least one regex from the value supplied by the argument.
Any strings passed via this parameter are converted to a regex via <code class="docutils literal notranslate"><span class="pre">re.compile</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">property_not_re</span></code></dt><dd><p>(optional, a string or a list of strings or regex pattern objects)
The property of the change with corresponding name must not be present or not match to at least one regex from the value supplied by the argument.
Any strings passed via this parameter are converted to a regex via <code class="docutils literal notranslate"><span class="pre">re.compile</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">project_fn</span></code>, <code class="docutils literal notranslate"><span class="pre">repository_fn</span></code>, <code class="docutils literal notranslate"><span class="pre">branch_fn</span></code>, <code class="docutils literal notranslate"><span class="pre">category_fn</span></code>, <code class="docutils literal notranslate"><span class="pre">codebase_fn</span></code></dt><dd><p>(optional, a callable accepting a string and returning a boolean)
The given function will be passed the value from the change that corresponds to the parameter name.
It is expected to return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the change is matched, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.
In case of a match, all other conditions will still be evaluated.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">filter_fn</span></code></dt><dd><p>(optional, a callable accepting a <code class="docutils literal notranslate"><span class="pre">Change</span></code> object and returning a boolean)
The given function will be passed the change.
It is expected to return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the change is matched, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.
In case of a match, all other conditions will still be evaluated.</p>
</dd>
</dl>
<section id="secrets-in-conditions">
<h2>Secrets in conditions<a class="headerlink" href="#secrets-in-conditions" title="Link to this heading"></a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">ChangeFilter</span></code> does not support renderables. Accordingly, secrets cannot be used to
construct the conditions that will later be used to filter changes.</p>
<p>This does not reduce security of the system because in order for secret values to be useful for
filtering, they will need to be present in the changes themselves. The change information is stored
in the database and frequently appears in the logs.</p>
<p>Best practice is to make sure secret values are not encoded in changes such as in repository URLs.
Most of the source steps support passing authentication information separately from repository URL.</p>
<p>If encoding secrets is unavoidable, then changes should be filtered using regex (e.g. via
<code class="docutils literal notranslate"><span class="pre">repository_re</span></code> argument) or custom callback functions (e.g. via <code class="docutils literal notranslate"><span class="pre">repository_fn</span></code> or
<code class="docutils literal notranslate"><span class="pre">filter_fn</span></code> arguments).</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">ChangeFilter</span></code> can be setup like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">util</span>
<span class="n">my_filter</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">project_re</span><span class="o">=</span><span class="s2">&quot;^baseproduct/.*&quot;</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="s2">&quot;devel&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and then assigned to a scheduler with the <code class="docutils literal notranslate"><span class="pre">change_filter</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sch</span> <span class="o">=</span> <span class="n">SomeSchedulerClass</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">change_filter</span><span class="o">=</span><span class="n">my_filter</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">buildbot.www.hooks.github.GitHubEventHandler</span></code> has a special <code class="docutils literal notranslate"><span class="pre">github_distinct</span></code> property that can be used to specify whether or not non-distinct changes should be considered.
For example, if a commit is pushed to a branch that is not being watched and then later pushed to a watched branch, by default, this will be recorded as two separate changes.
In order to record a change only the first time the commit appears, you can use a custom <code class="xref py py-class docutils literal notranslate"><span class="pre">ChangeFilter</span></code> like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">filter_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;github_distinct&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>For anything more complicated, a Python function can be defined to recognize the wanted strings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_branch_fn</span><span class="p">(</span><span class="n">branch</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches_to_build</span> <span class="ow">and</span> <span class="n">branch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">branches_to_ignore</span>
<span class="n">my_filter</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch_fn</span><span class="o">=</span><span class="n">my_branch_fn</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="source_stamp_filter.html" class="btn btn-neutral float-left" title="2.5.24.1. SourceStampFilter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="git_credential_options.html" class="btn btn-neutral float-right" title="2.5.24.3. GitCredentialOptions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
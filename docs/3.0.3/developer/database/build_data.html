

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>3.8.5. Build data connector &mdash; Buildbot 3.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/buildbot_rtd.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/icon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.8.6. Steps connector" href="steps.html" />
    <link rel="prev" title="3.8.4. Builds connector" href="builds.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Buildbot
          

          
            
            <img src="../../_static/full_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/index.html">2. Buildbot Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">3. Buildbot Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html">3.1. Development Quick-start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pull-request.html">3.2. Submitting Pull Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general.html">3.3. General Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rest.html">3.4. REST API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../raml/index.html">3.5. REST API Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data.html">3.6. Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database.html">3.7. Database</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">3.8. Database connectors API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="buildsets.html">3.8.1. Buildsets connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildrequests.html">3.8.2. Buildrequests connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="builders.html">3.8.3. Builders connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="builds.html">3.8.4. Builds connector</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.8.5. Build data connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="steps.html">3.8.6. Steps connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="logs.html">3.8.7. Logs connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="changes.html">3.8.8. Changes connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="changesources.html">3.8.9. Change sources connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="schedulers.html">3.8.10. Schedulers connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="sourcestamps.html">3.8.11. Source stamps connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="state.html">3.8.12. State connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="users.html">3.8.13. Users connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="masters.html">3.8.14. Masters connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="workers.html">3.8.15. Workers connector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mq.html">3.9. Messaging and Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../classes.html">3.10. Classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">6. API Indices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Buildbot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">3. </span>Buildbot Development</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">3.8. </span>Database connectors API</a> &raquo;</li>
        
      <li><span class="section-number">3.8.5. </span>Build data connector</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/developer/database/build_data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Buildbot no longer supports Python 2.7 on the Buildbot master.</p>
</div>
<div class="section" id="module-buildbot.db.build_data">
<span id="build-data-connector"></span><h1><span class="section-number">3.8.5. </span>Build data connector<a class="headerlink" href="#module-buildbot.db.build_data" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="buildbot.db.build_data.BuildDataConnectorComponent">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">buildbot.db.build_data.</span></code><code class="sig-name descname"><span class="pre">BuildDataConnectorComponent</span></code><a class="headerlink" href="#buildbot.db.build_data.BuildDataConnectorComponent" title="Permalink to this definition">¶</a></dt>
<dd><p>This class handles build data.
Build data is potentially large transient text data attached to the build that the steps can use for their operations.
One of the use cases is to carry large amount of data from one step to another where storing that data on the worker is not feasible.
This effectively forms a key-value store for each build.
It is valid only until build finishes and all reporters finish reporting the build result.
After that the data may be removed from the database.</p>
<p>An instance of this class is available at <code class="docutils literal notranslate"><span class="pre">master.db.build_data</span></code>.</p>
<p>Builds are indexed by <em>build_dataid</em> and their contents represented as <em>build_datadicts</em> (build data dictionaries), with the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> (the build data ID, globally unique)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">buildid</span></code> (the ID of the build that the data is attached to)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (the name of the data)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> (the value of the data. It must be an instance of <code class="docutils literal notranslate"><span class="pre">bytes</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code> (an string identifying the source of this value)</p></li>
</ul>
<dl class="py method">
<dt id="buildbot.db.build_data.BuildDataConnectorComponent.setBuildData">
<code class="sig-name descname"><span class="pre">setBuildData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buildid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.db.build_data.BuildDataConnectorComponent.setBuildData" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buildid</strong> (<em>integer</em>) – build id to attach data to</p></li>
<li><p><strong>name</strong> (<em>unicode</em>) – the name of the data</p></li>
<li><p><strong>value</strong> (<em>bytestr</em>) – the value of the data as <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Parma unicode source</dt>
<dd class="field-even"><p>the source of the data</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Deferred</p>
</dd>
</dl>
<p>Adds or replaces build data attached to the build.</p>
</dd></dl>

<dl class="py method">
<dt id="buildbot.db.build_data.BuildDataConnectorComponent.getBuildData">
<code class="sig-name descname"><span class="pre">getBuildData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buildid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.db.build_data.BuildDataConnectorComponent.getBuildData" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buildid</strong> (<em>integer</em>) – build id retrieve data for</p></li>
<li><p><strong>name</strong> (<em>unicode</em>) – the name of the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Build data dictionary as above or <code class="docutils literal notranslate"><span class="pre">None</span></code>, via Deferred</p>
</dd>
</dl>
<p>Get a single build data, in the format described above, specified by build and by name.
Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if build has no data with such name.</p>
</dd></dl>

<dl class="py method">
<dt id="buildbot.db.build_data.BuildDataConnectorComponent.getBuildDataNoValue">
<code class="sig-name descname"><span class="pre">getBuildDataNoValue</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buildid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.db.build_data.BuildDataConnectorComponent.getBuildDataNoValue" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buildid</strong> (<em>integer</em>) – build id retrieve data for</p></li>
<li><p><strong>name</strong> (<em>unicode</em>) – the name of the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Build data dictionary as above or <code class="docutils literal notranslate"><span class="pre">None</span></code>, via Deferred</p>
</dd>
</dl>
<p>Get a single build data, in the format described above, specified by build and by name.
The <code class="docutils literal notranslate"><span class="pre">value</span></code> field is omitted.
Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if build has no data with such name.</p>
</dd></dl>

<dl class="py method">
<dt id="buildbot.db.build_data.BuildDataConnectorComponent.getAllBuildDataNoValues">
<code class="sig-name descname"><span class="pre">getAllBuildDataNoValues</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buildid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.db.build_data.BuildDataConnectorComponent.getAllBuildDataNoValues" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buildid</strong> (<em>integer</em>) – build id retrieve data for</p></li>
<li><p><strong>name</strong> (<em>unicode</em>) – the name of the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of build data dictionaries</p>
</dd>
</dl>
<p>Returns all data for a specific build.
The values are not loaded.
The returned values can be filtered by name</p>
</dd></dl>

<dl class="py method">
<dt id="buildbot.db.build_data.BuildDataConnectorComponent.deleteOldBuildData">
<code class="sig-name descname"><span class="pre">deleteOldBuildData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">older_than_timestamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.db.build_data.BuildDataConnectorComponent.deleteOldBuildData" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>older_than_timestamp</strong> (<em>integer</em>) – the build data whose build’s <code class="docutils literal notranslate"><span class="pre">complete_at</span></code> is older than <code class="docutils literal notranslate"><span class="pre">older_than_timestamp</span></code> will be deleted.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deferred</p>
</dd>
</dl>
<p>Delete old build data (helper for the <code class="docutils literal notranslate"><span class="pre">build_data_horizon</span></code> policy).
Old logs have their build data deleted from the database as they are only useful while build is running and shortly afterwards.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="steps.html" class="btn btn-neutral float-right" title="3.8.6. Steps connector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="builds.html" class="btn btn-neutral float-left" title="3.8.4. Builds connector" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Buildbot Team Members.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
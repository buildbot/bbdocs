

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>3.3.10. Javascript Data Module &mdash; Buildbot 3.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/buildbot_rtd.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/icon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.3.11. Base web application" href="www-base-app.html" />
    <link rel="prev" title="3.3.9. WWW Server" href="www-server.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Buildbot
          

          
            
            <img src="../_static/full_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">2. Buildbot Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. Buildbot Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">3.1. Development Quick-start</a></li>
<li class="toctree-l2"><a class="reference internal" href="pull-request.html">3.2. Submitting Pull Requests</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="general.html">3.3. General Documents</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="master-overview.html">3.3.1. Master Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="style.html">3.3.2. Buildbot Coding Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="tests.html">3.3.3. Buildbot’s Test Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html">3.3.4. Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#configuration-in-angularjs">3.3.5. Configuration in AngularJS</a></li>
<li class="toctree-l3"><a class="reference internal" href="schedulers.html">3.3.6. Writing Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">3.3.7. Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="results.html">3.3.8. Build Result Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="www-server.html">3.3.9. WWW Server</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.3.10. Javascript Data Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#base-concepts">3.3.10.1. Base Concepts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="www-base-app.html">3.3.11. Base web application</a></li>
<li class="toctree-l3"><a class="reference internal" href="auth.html">3.3.12. Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="authz.html">3.3.13. Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="master-worker.html">3.3.14. Master-Worker API</a></li>
<li class="toctree-l3"><a class="reference internal" href="br-claiming.html">3.3.15. Claiming Build Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="encodings.html">3.3.16. String Encodings</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html">3.3.17. Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="secrets.html">3.3.18. Secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="secrets.html#secrets-manager">3.3.19. Secrets manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="secrets.html#secrets-providers">3.3.20. Secrets providers</a></li>
<li class="toctree-l3"><a class="reference internal" href="stats-service.html">3.3.21. Statistics Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins-publish.html">3.3.22. How to package Buildbot plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rest.html">3.4. REST API</a></li>
<li class="toctree-l2"><a class="reference internal" href="raml/index.html">3.5. REST API Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">3.6. Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="database.html">3.7. Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="database/index.html">3.8. Database connectors API</a></li>
<li class="toctree-l2"><a class="reference internal" href="mq.html">3.9. Messaging and Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes.html">3.10. Classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices.html">6. API Indices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Buildbot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">3. </span>Buildbot Development</a> &raquo;</li>
        
          <li><a href="general.html"><span class="section-number">3.3. </span>General Documents</a> &raquo;</li>
        
      <li><span class="section-number">3.3.10. </span>Javascript Data Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/developer/www-data-module.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Buildbot no longer supports Python 2.7 on the Buildbot master.</p>
</div>
<div class="section" id="javascript-data-module">
<span id="www-data-module"></span><h1><span class="section-number">3.3.10. </span>Javascript Data Module<a class="headerlink" href="#javascript-data-module" title="Permalink to this headline">¶</a></h1>
<p>Data_module is a reusable angularJS module used to access buildbot’s data api from the browser.
Its main purpose is to handle the 3 way binding.</p>
<p>2 way binding is the angular MVVM concept, which seamlessly synchronise the view and the model.
Here we introduce an additional way of synchronisation, which is from the server to the model.</p>
<div><svg height="120" viewBox="0 0 640 120" width="640" xmlns="http://www.w3.org/2000/svg" xmlns:inkspace="http://www.inkscape.org/namespaces/inkscape" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs id="defs_block">
    <filter height="1.504" id="filter_blur" inkspace:collect="always" width="1.1575" x="-0.07875" y="-0.252">
      <feGaussianBlur id="feGaussianBlur3780" inkspace:collect="always" stdDeviation="4.2" />
    </filter>
  </defs>
  <title>blockdiag</title>
  <desc />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="67" y="46" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="259" y="46" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="451" y="46" />
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="64" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="24" x="128.0" y="66">View</text>
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="256" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="30" x="320.0" y="66">Model</text>
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="448" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="36" x="512.0" y="66">Server</text>
  <path d="M 200 60 L 256 60" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="193,60 200,56 200,64 193,60" stroke="rgb(0,0,0)" />
  <path d="M 392 60 L 448 60" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="385,60 392,56 392,64 385,60" stroke="rgb(0,0,0)" />
</svg>
</div>
<p>We use the message queue and the websocket interfaces to maintain synchronisation between the server and the client.</p>
<p>The client application just needs to query needed data using a highlevel API, and the data module is using the best approach to make the data always up to date.</p>
<p>Once the binding is setup by the controller, everything is automatically up-to-date.</p>
<div class="section" id="base-concepts">
<h2><span class="section-number">3.3.10.1. </span>Base Concepts<a class="headerlink" href="#base-concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="collections">
<h3>Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<p>All the data you can get are Collections.
Even a query to a single resource returns a collection.
A collection is an Array subclass which has extra capabilities:</p>
<ul class="simple">
<li><p>It listen to the event stream and is able to maintain itself up-to-date</p></li>
<li><p>It implements client side query in order to guarantee up-to-date filtering, ordering and limiting queries.</p></li>
<li><p>It has a fast access to each item it contains via its id.</p></li>
<li><p>It has its own event handlers so that client code can react when the Collection is changing</p></li>
</ul>
</div>
<div class="section" id="wrappers">
<h3>Wrappers<a class="headerlink" href="#wrappers" title="Permalink to this headline">¶</a></h3>
<p>Each data type contain in a collection is wrapped in a javascript object.
This allows to create some custom enhancements to the data model.
For example the Change wrapper decodes the author name and email from the “author” field.</p>
<p>Each wrapper class also has specific access method, which allow to access more data from the REST hierarchy.</p>
<div><svg height="200" viewBox="0 0 832 200" width="832" xmlns="http://www.w3.org/2000/svg" xmlns:inkspace="http://www.inkscape.org/namespaces/inkscape" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs id="defs_block">
    <filter height="1.504" id="filter_blur" inkspace:collect="always" width="1.1575" x="-0.07875" y="-0.252">
      <feGaussianBlur id="feGaussianBlur3780" inkspace:collect="always" stdDeviation="4.2" />
    </filter>
  </defs>
  <title>blockdiag</title>
  <desc />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="67" y="46" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="259" y="46" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="451" y="46" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="451" y="126" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="643" y="46" />
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="64" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="84" x="128.0" y="66">data.getBuilds</text>
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="256" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="60" x="320.0" y="66">Collection</text>
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="448" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="36" x="512.0" y="66">Builds</text>
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="448" y="120" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="30" x="512.0" y="146">Steps</text>
  <rect fill="rgb(255,255,255)" height="40" stroke="rgb(0,0,0)" width="128" x="640" y="40" />
  <text fill="rgb(0,0,0)" font-family="sans-serif" font-size="11" font-style="normal" font-weight="normal" text-anchor="middle" textLength="60" x="704.0" y="66">b.getSteps</text>
  <path d="M 192 60 L 248 60" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="255,60 248,56 248,64 255,60" stroke="rgb(0,0,0)" />
  <path d="M 384 60 L 440 60" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="447,60 440,56 440,64 447,60" stroke="rgb(0,0,0)" />
  <path d="M 384 60 L 416 60" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 416 60 L 416 140" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 416 140 L 440 140" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="447,140 440,136 440,144 447,140" stroke="rgb(0,0,0)" />
  <path d="M 576 60 L 632 60" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="639,60 632,56 632,64 639,60" stroke="rgb(0,0,0)" />
  <path d="M 768 60 L 784 60" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 784 60 L 784 25" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 320 25 L 784 25" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 320 25 L 320 32" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="320,39 316,32 324,32 320,39" stroke="rgb(0,0,0)" />
</svg>
</div>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>The Data module is available as a standalone AngularJS module.
Installation via yarn:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>yarn add buildbot-data
</pre></div>
</div>
</div></blockquote>
<p>Inject the <code class="docutils literal notranslate"><span class="pre">bbData</span></code> module to your application:</p>
<blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;bbData&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="service-api">
<h3>Service API<a class="headerlink" href="#service-api" title="Permalink to this headline">¶</a></h3>
<div class="section" id="dataservice">
<h4>DataService<a class="headerlink" href="#dataservice" title="Permalink to this headline">¶</a></h4>
<p>DataService is the service used for accessing the Buildbot data API.
It has a modern interface for accessing data in such a way that the updating of the data via web socket is transparent.</p>
<p>Methods:</p>
<p><code class="docutils literal notranslate"><span class="pre">.open()</span></code>: returns a DataAccessor, which handles 3 way data binding</p>
<blockquote>
<div><ul class="simple">
<li><p>open a new accessor every time you need updating data in a controller</p></li>
<li><p>it registers on $destroy event on the scope, and thus automatically unsubscribes from updates when the data is not used anymore.</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// open a new accessor every time you need updating data in a controller</span>
<span class="kd">class</span> <span class="nx">DemoController</span> <span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">dataService</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// automatically closes all the bindings when the $scope is destroyed</span>
        <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">dataService</span><span class="p">.</span><span class="nx">open</span><span class="p">().</span><span class="nx">closeOnDestroy</span><span class="p">(</span><span class="nx">$scope</span><span class="p">);</span>

        <span class="c1">// request new data, it updates automatically</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">builders</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getBuilders</span><span class="p">({</span><span class="nx">limit</span><span class="o">:</span> <span class="mf">10</span><span class="p">,</span> <span class="nx">order</span><span class="o">:</span> <span class="s1">&#39;-started_at&#39;</span><span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.getXs([id],</span> <span class="pre">[query])</span></code>: returns Collection which will eventually contain all the requested data</p>
<blockquote>
<div><ul class="simple">
<li><p>it’s highly advised to use these instead of the lower level <code class="docutils literal notranslate"><span class="pre">.get('string')</span></code> function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Xs</span></code> can be the following: <code class="docutils literal notranslate"><span class="pre">Builds</span></code>, <code class="docutils literal notranslate"><span class="pre">Builders</span></code>, <code class="docutils literal notranslate"><span class="pre">Buildrequests</span></code>, <code class="docutils literal notranslate"><span class="pre">Buildsets</span></code>, <code class="docutils literal notranslate"><span class="pre">Workers</span></code>, <code class="docutils literal notranslate"><span class="pre">Changes</span></code>, <code class="docutils literal notranslate"><span class="pre">Changesources</span></code>, <code class="docutils literal notranslate"><span class="pre">Forceschedulers</span></code>, <code class="docutils literal notranslate"><span class="pre">Masters</span></code>, <code class="docutils literal notranslate"><span class="pre">Schedulers</span></code>, <code class="docutils literal notranslate"><span class="pre">Sourcestamps</span></code></p></li>
<li><p>The collections returns without using an accessor are not automatically updated.
So use those methods only when you know the data are not changing</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// assign builds to $scope.builds and then load the steps when the builds are discovered</span>
<span class="c1">// onNew is called at initial load</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span> <span class="o">=</span> <span class="nx">dataService</span><span class="p">.</span><span class="nx">getBuilds</span><span class="p">({</span><span class="nx">builderid</span><span class="o">:</span> <span class="mf">1</span><span class="p">});</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span><span class="p">.</span><span class="nx">onNew</span> <span class="o">=</span> <span class="nx">build</span> <span class="p">=&gt;</span> <span class="nx">build</span><span class="p">.</span><span class="nx">loadSteps</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.get(endpoint,</span> <span class="pre">[id],</span> <span class="pre">[query])</span></code>: returns a &lt;Collection&gt;, when the promise is resolved, the Collection contains all the requested data</p>
<blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// assign builds to $scope.builds once the Collection is filled</span>
<span class="kd">const</span> <span class="nx">builderid</span> <span class="o">=</span> <span class="mf">1</span><span class="p">;</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span> <span class="o">=</span> <span class="nx">dataService</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`builders/</span><span class="si">${</span><span class="nx">builderid</span><span class="si">}</span><span class="sb">/builds`</span><span class="p">,</span> <span class="p">{</span><span class="nx">limit</span><span class="o">:</span> <span class="mf">1</span><span class="p">});</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span><span class="p">.</span><span class="nx">onNew</span> <span class="o">=</span> <span class="nx">build</span> <span class="p">=&gt;</span> <span class="nx">build</span><span class="p">.</span><span class="nx">loadSteps</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// assign builds to $scope.builds before the Collection is filled using the</span>
<span class="c1">// .getArray() function</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span> <span class="o">=</span> <span class="nx">dataService</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;builds&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">builderid</span><span class="o">:</span> <span class="mf">1</span><span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.control(url,</span> <span class="pre">method,</span> <span class="pre">[params])</span></code>: returns a promise, sends a JSON RPC2 POST request to the server</p>
<blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// open a new accessor every time you need updating data in a controller</span>
<span class="nx">dataService</span><span class="p">.</span><span class="nx">control</span><span class="p">(</span><span class="s1">&#39;forceschedulers/force&#39;</span><span class="p">,</span> <span class="s1">&#39;force&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="p">=&gt;</span> <span class="nx">$log</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nx">response</span><span class="p">),</span>
          <span class="nx">reason</span> <span class="p">=&gt;</span> <span class="nx">$log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">reason</span><span class="p">));</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="dataaccessor">
<h4>DataAccessor<a class="headerlink" href="#dataaccessor" title="Permalink to this headline">¶</a></h4>
<p>DataAccessor object is returned by the dataService.open() method.</p>
<p>Methods:</p>
<p><code class="docutils literal notranslate"><span class="pre">.closeOnDestroy($scope)</span></code>: registers scope destruction as waterfall destruction for all collection accessed via this accessor.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">.close()</span></code>: Destruct all collections previously accessed via this accessor.</dt><dd><p>Destroying a collection means it will unsubscribe to any events necessary to maintain it up-to-date.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.getXs([id],</span> <span class="pre">[query])</span></code>: returns Collection which will eventually contain all the requested data</dt><dd><p>Same methods as in the dataService, except here the data will be maintained up-to-date.</p>
</dd>
</dl>
</div>
<div class="section" id="id1">
<h4>Collections<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">.get(id)</span></code>: returns one element of the collection by id, or undefined, if this id is unknown to the collection.</dt><dd><p>This method does not do any network access, and thus only know about data already fetched.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">.hasOwnProperty(id)</span></code>: returns true if this id is known by this collection.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">.close()</span></code>: forcefully unsubscribe this connection from auto-update.</dt><dd><p>Normally, this is done automatically on scope destruction, but sometimes, when you got enough data, you want to save bandwidth and disconnect the collection.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.put(object)</span></code>: insert one plain object to the collection.</dt><dd><p>As an external API, this method is only useful for the unit tests to simulate new data coming asynchronously.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.from(object_list)</span></code>: insert several plain objects to the collection.</dt><dd><p>This method is only useful for the unit tests to simulate new data coming asynchronously.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.onNew</span> <span class="pre">=</span> <span class="pre">(object)</span> <span class="pre">-&gt;</span></code>: Callback method which is called when a new object arrives in the collection.</dt><dd><p>This can be called either when initial data is coming via REST api, or when data is coming via the event stream.
The affected object is given in parameter.
<cite>this</cite> context is the collection.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.onUpdate</span> <span class="pre">=</span> <span class="pre">(object)</span> <span class="pre">-&gt;</span></code>: Callback method which is called when an object is modified.</dt><dd><p>This is called when data is coming via the event stream.
The affected object is given in parameter.
<cite>this</cite> context is the collection.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.onChange</span> <span class="pre">=</span> <span class="pre">(collection)</span> <span class="pre">-&gt;</span></code>: Callback method which is called when an object is modified.</dt><dd><p>This is called when data is coming via the event stream.
<cite>this</cite> context is the collection.
The full collection is given in parameter (in case you override <code class="docutils literal notranslate"><span class="pre">this</span></code> via fat arrow).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.$ready</span></code>: attribute similar to what <code class="docutils literal notranslate"><span class="pre">ngResource</span></code> provides.</dt><dd><p>True after first server interaction is completed, false before that.
Knowing if the Collection has been resolved is useful in data-binding (for example to display a loading graphic).</p>
</dd>
</dl>
</div>
<div class="section" id="wrapper">
<h4>Wrapper<a class="headerlink" href="#wrapper" title="Permalink to this headline">¶</a></h4>
<p>Wrapper objects are objects stored in the collection.
Those objects have specific methods, depending on their types. methods:</p>
<p><code class="docutils literal notranslate"><span class="pre">.getXs([id],</span> <span class="pre">[query])</span></code>: returns a Collection, when the promise is resolved, the Collection contains all the requested data</p>
<blockquote>
<div><ul class="simple">
<li><p>same as <code class="docutils literal notranslate"><span class="pre">dataService.getXs</span></code>, but with relative endpoint</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// assign builds to $scope.builds once the Collection is filled</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span> <span class="o">=</span> <span class="nx">dataService</span><span class="p">.</span><span class="nx">getBuilds</span><span class="p">({</span><span class="nx">builderid</span><span class="o">:</span> <span class="mf">1</span><span class="p">});</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">builds</span><span class="p">.</span><span class="nx">onNew</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">complete_steps</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getSteps</span><span class="p">({</span><span class="nx">complete</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">running_steps</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getSteps</span><span class="p">({</span><span class="nx">complete</span><span class="o">:</span><span class="kc">false</span><span class="p">});</span>
<span class="p">};</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.loadXs([id],</span> <span class="pre">[query])</span></code>: returns a Collection, the Collection contains all the requested data, which is also assigned to <code class="docutils literal notranslate"><span class="pre">o.Xs</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">o.loadXs()</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">o.xs</span> <span class="pre">=</span> <span class="pre">o.getXs()</span></code></p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// get builder with id = 1</span>
<span class="nx">dataService</span><span class="p">.</span><span class="nx">getBuilders</span><span class="p">(</span><span class="mf">1</span><span class="p">).</span><span class="nx">onNew</span> <span class="o">=</span> <span class="nx">builder</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// load all builds in builder.builds</span>
    <span class="nx">builder</span><span class="p">.</span><span class="nx">loadBuilds</span><span class="p">().</span><span class="nx">onNew</span><span class="p">(</span><span class="nx">build</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// load all buildsteps in build.steps</span>
        <span class="nx">build</span><span class="p">.</span><span class="nx">loadSteps</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">};</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.control(method,</span> <span class="pre">params)</span></code>: returns a promise, sends a JSON RPC2 POST request to the server</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="www-base-app.html" class="btn btn-neutral float-right" title="3.3.11. Base web application" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="www-server.html" class="btn btn-neutral float-left" title="3.3.9. WWW Server" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Buildbot Team Members.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
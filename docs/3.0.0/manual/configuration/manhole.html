

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2.5.20. Manhole &mdash; Buildbot 3.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/buildbot_rtd.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/icon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.5.21. Multimaster" href="multimaster.html" />
    <link rel="prev" title="2.5.19. Configurators" href="configurators.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Buildbot
          

          
            
            <img src="../../_static/full_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/index.html">2.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../secretsmanagement.html">2.4. Secret Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">2.5. Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">2.5.1. Configuring Buildbot</a></li>
<li class="toctree-l3"><a class="reference internal" href="global.html">2.5.2. Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="changesources.html">2.5.3. Change Sources and Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="changesources.html#changes">2.5.4. Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="schedulers.html">2.5.5. Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="workers.html">2.5.6. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="builders.html">2.5.7. Builder Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildfactories.html">2.5.8. Build Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildsets.html">2.5.9. Build Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties.html">2.5.10. Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="steps/index.html">2.5.11. Build Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="interlocks.html">2.5.12. Interlocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="report_generators/index.html">2.5.13. Report Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="reporters/index.html">2.5.14. Reporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="www.html">2.5.15. Web Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="wwwhooks.html">2.5.16. Change Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="services.html">2.5.17. Custom Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="dbconfig.html">2.5.18. DbConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html">2.5.19. Configurators</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.5.20. Manhole</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-manhole">2.5.20.1. Using manhole</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="multimaster.html">2.5.21. Multimaster</a></li>
<li class="toctree-l3"><a class="reference internal" href="multicodebase.html">2.5.22. Multiple-Codebase Builds</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline.html">2.7. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources.html">2.8. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization.html">2.9. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins.html">2.10. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deploy.html">2.11. Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrading/index.html">2.12. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">6. API Indices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Buildbot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">2. </span>Buildbot Manual</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">2.5. </span>Configuration</a> &raquo;</li>
        
      <li><span class="section-number">2.5.20. </span>Manhole</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/manual/configuration/manhole.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Buildbot no longer supports Python 2.7 on the Buildbot master.</p>
</div>
<span class="target" id="module-buildbot.plugins.util"><span id="manhole"></span></span><div class="section" id="id1">
<h1><span class="section-number">2.5.20. </span>Manhole<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Manhole is an interactive Python shell which allows full access to the Buildbot master instance.
It is probably only useful for buildbot developers.</p>
<p>Using Manhole requires <code class="docutils literal notranslate"><span class="pre">cryptography</span></code> and <code class="docutils literal notranslate"><span class="pre">pyasn1</span></code> python packages to be installed.
These are not part of the normal Buildbot dependencies.</p>
<p>There are multiple implementations of Manhole available which differ by the authentication mechanisms and the security of the connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Manhole exposes full access to the buildmaster’s account (including the ability to modify and delete files).
It’s recommended not to expose the manhole to the public internet or to use a strong password.</p>
</div>
<dl class="py class">
<dt id="buildbot.plugins.util.AuthorizedKeysManhole">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">buildbot.plugins.util.</span></code><code class="sig-name descname"><span class="pre">AuthorizedKeysManhole</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssh_hostkey_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.plugins.util.AuthorizedKeysManhole" title="Permalink to this definition">¶</a></dt>
<dd><p>A manhole implementation that accepts encrypted ssh connections and authenticates by ssh keys.
The prospective client have an ssh private key that matches one of the public keys in our authorized keys file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port</strong> (<em>string</em><em> or </em><em>int</em>) – The port to listen on.
This is a <a class="reference external" href="https://twistedmatrix.com/documents/current/api/twisted.internet.endpoints.html#serverFromString">strports</a> specification string, like <code class="docutils literal notranslate"><span class="pre">tcp:12345</span></code> or <code class="docutils literal notranslate"><span class="pre">tcp:12345:interface=127.0.0.1</span></code>.
Bare integers are treated as a simple tcp port.</p></li>
<li><p><strong>keyfile</strong> (<em>string</em>) – The path to the file containing public parts of the authorized SSH keys.
The path is interpreted relative to the buildmaster’s basedir.
The file should contain one public SSH key per line.
This is the exact same format as used by sshd in <code class="docutils literal notranslate"><span class="pre">~/.ssh/authorized_keys</span></code>.</p></li>
<li><p><strong>ssh_hostkey_dir</strong> (<em>str</em>) – The path to the directory which contains ssh host keys for this server.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="buildbot.plugins.util.PasswordManhole">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">buildbot.plugins.util.</span></code><code class="sig-name descname"><span class="pre">PasswordManhole</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssh_hostkey_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.plugins.util.PasswordManhole" title="Permalink to this definition">¶</a></dt>
<dd><p>A manhole implementation that accepts encrypted ssh connections and authenticates by username and password.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port</strong> (<em>string</em><em> or </em><em>int</em>) – The port to listen on.
This is a <a class="reference external" href="https://twistedmatrix.com/documents/current/api/twisted.internet.endpoints.html#serverFromString">strports</a> specification string, like <code class="docutils literal notranslate"><span class="pre">tcp:12345</span></code> or <code class="docutils literal notranslate"><span class="pre">tcp:12345:interface=127.0.0.1</span></code>.
Bare integers are treated as a simple tcp port.</p></li>
<li><p><strong>username</strong> (<em>string</em>) – The username to authenticate</p></li>
<li><p><strong>password</strong> (<em>string</em>) – The password of the user to authenticate.</p></li>
<li><p><strong>ssh_hostkey_dir</strong> (<em>str</em>) – The path to the directory which contains ssh host keys for this server.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="buildbot.plugins.util.TelnetManhole">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">buildbot.plugins.util.</span></code><code class="sig-name descname"><span class="pre">TelnetManhole</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.plugins.util.TelnetManhole" title="Permalink to this definition">¶</a></dt>
<dd><p>A manhole implementation that accepts unencrypted telnet connections and authenticates by username and password.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This connection method is not secure and should not be used anywhere where the port is exposed to the public internet.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port</strong> (<em>string</em><em> or </em><em>int</em>) – The port to listen on.
This is a <a class="reference external" href="https://twistedmatrix.com/documents/current/api/twisted.internet.endpoints.html#serverFromString">strports</a> specification string, like <code class="docutils literal notranslate"><span class="pre">tcp:12345</span></code> or <code class="docutils literal notranslate"><span class="pre">tcp:12345:interface=127.0.0.1</span></code>.
Bare integers are treated as a simple tcp port.</p></li>
<li><p><strong>username</strong> (<em>string</em>) – The username to authenticate</p></li>
<li><p><strong>password</strong> (<em>string</em>) – The password of the user to authenticate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="using-manhole">
<h2><span class="section-number">2.5.20.1. </span>Using manhole<a class="headerlink" href="#using-manhole" title="Permalink to this headline">¶</a></h2>
<p>The interactive Python shell can be entered by simply connecting to the host in question.
For example, in the case of ssh password-based manhole, the configuration may look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot</span> <span class="kn">import</span> <span class="n">manhole</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;manhole&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">manhole</span><span class="o">.</span><span class="n">PasswordManhole</span><span class="p">(</span><span class="s2">&quot;tcp:1234:interface=127.0.0.1&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;passwd&quot;</span><span class="p">,</span>
                                       <span class="n">ssh_hostkey_dir</span><span class="o">=</span><span class="s2">&quot;/data/ssh_host_keys/&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A connection attempt may look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh -p1234 admin@127.0.0.1
<span class="c1"># enter passwd at prompt</span>
</pre></div>
</div>
<p>After connection is established, objects can be explored in more depth using <cite>dir(x)</cite> or the helper function <cite>show(x)</cite>.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">master</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">workers</span>
<span class="go">{&#39;example-worker&#39;: &lt;Worker &#39;example-worker&#39;, current builders: runtests&gt;}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">show</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
<span class="go">data attributes of &lt;buildbot.master.BuildMaster instance at 0x7f7a4ab7df38&gt;</span>
<span class="go">                       basedir : &#39;/home/dustin/code/buildbot/t/buildbot/&#39;...</span>
<span class="go">                     botmaster : &lt;type &#39;instance&#39;&gt;</span>
<span class="go">                buildCacheSize : None</span>
<span class="go">                  buildHorizon : None</span>
<span class="go">                   buildbotURL : http://localhost:8010/</span>
<span class="go">               changeCacheSize : None</span>
<span class="go">                    change_svc : &lt;type &#39;instance&#39;&gt;</span>
<span class="go">                configFileName : master.cfg</span>
<span class="go">                            db : &lt;class &#39;buildbot.db.connector.DBConnector&#39;&gt;</span>
<span class="go">                        db_url : sqlite:///state.sqlite</span>
<span class="go">                              ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show</span><span class="p">(</span><span class="n">master</span><span class="o">.</span><span class="n">botmaster</span><span class="o">.</span><span class="n">builders</span><span class="p">[</span><span class="s1">&#39;win32&#39;</span><span class="p">])</span>
<span class="go">data attributes of &lt;Builder &#39;&#39;builder&#39;&#39; at 48963528&gt;</span>
</pre></div>
</div>
<p>The buildmaster’s SSH server will use a different host key than the normal sshd running on a typical unix host.
This will cause the ssh client to complain about a <cite>host key mismatch</cite>, because it does not realize there are two separate servers running on the same host.
To avoid this, use a clause like the following in your <code class="file docutils literal notranslate"><span class="pre">.ssh/config</span></code> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Host remotehost-buildbot
HostName remotehost
HostKeyAlias remotehost-buildbot
Port 9999
# use &#39;user&#39; if you use PasswordManhole and your name is not &#39;admin&#39;.
# if you use AuthorizedKeysManhole, this probably doesn&#39;t matter.
User admin
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="multimaster.html" class="btn btn-neutral float-right" title="2.5.21. Multimaster" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="configurators.html" class="btn btn-neutral float-left" title="2.5.19. Configurators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Buildbot Team Members.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
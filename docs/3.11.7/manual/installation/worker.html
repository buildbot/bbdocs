<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.2.5. Worker Setup &mdash; Buildbot 3.11.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/buildbot_rtd.css?v=915d5e18" />

  
    <link rel="shortcut icon" href="../../_static/icon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=428c4438"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2.6. Next Steps" href="misc.html" />
    <link rel="prev" title="2.2.4. Buildmaster Setup" href="buildmaster.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Buildbot
              <img src="../../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.11.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">2.2. Installation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="components.html">2.2.1. Buildbot Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="requirements.html">2.2.2. Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html">2.2.3. Installing the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildmaster.html">2.2.4. Buildmaster Setup</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.2.5. Worker Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-worker">2.2.5.1. Creating a worker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="misc.html">2.2.6. Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../secretsmanagement.html">2.4. Secret Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.html">2.5. Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline.html">2.7. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources.html">2.8. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization.html">2.9. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins.html">2.10. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deploy.html">2.11. Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrading/index.html">2.12. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">2. </span>Buildbot Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">2.2. </span>Installation</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.2.5. </span>Worker Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/manual/installation/worker.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="worker-setup">
<h1><span class="section-number">2.2.5. </span>Worker Setup<a class="headerlink" href="#worker-setup" title="Link to this heading"></a></h1>
<section id="creating-a-worker">
<span id="id1"></span><h2><span class="section-number">2.2.5.1. </span>Creating a worker<a class="headerlink" href="#creating-a-worker" title="Link to this heading"></a></h2>
<p>Typically, you will be adding a worker to an existing buildmaster, to provide additional architecture coverage.
The Buildbot administrator will give you several pieces of information necessary to connect to the buildmaster.
You should also be somewhat familiar with the project being tested so that you can troubleshoot build problems locally.</p>
<p>Buildbot exists to make sure that the project’s stated <code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">to</span> <span class="pre">build</span> <span class="pre">it</span></code> process actually works.
To this end, the worker should run in an environment just like that of your regular developers.
Typically the project’s build process is documented somewhere (<code class="file docutils literal notranslate"><span class="pre">README</span></code>, <code class="file docutils literal notranslate"><span class="pre">INSTALL</span></code>, etc), in a document that should mention all library dependencies and contain a basic set of build instructions.
This document will be useful as you configure the host and account in which worker runs.</p>
<p>Here’s a good checklist for setting up a worker:</p>
<ol class="arabic simple">
<li><p>Set up the account</p></li>
</ol>
<blockquote>
<div><p>It is recommended (although not mandatory) to set up a separate user account for the worker.
This account is frequently named <code class="docutils literal notranslate"><span class="pre">buildbot</span></code> or <code class="docutils literal notranslate"><span class="pre">worker</span></code>.
This serves to isolate your personal working environment from that of the worker’s, and helps to minimize the security threat posed by letting possibly-unknown contributors run arbitrary code on your system.
The account should have a minimum of fancy init scripts.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Install the Buildbot code</p></li>
</ol>
<blockquote>
<div><p>Follow the instructions given earlier (<a class="reference internal" href="installation.html#installing-the-code"><span class="std std-ref">Installing the code</span></a>).
If you use a separate worker account, and you didn’t install the Buildbot code to a shared location, then you will need to install it with <code class="docutils literal notranslate"><span class="pre">--home=~</span></code> for each account that needs it.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Set up the host</p></li>
</ol>
<blockquote>
<div><p>Make sure the host can actually reach the buildmaster.
Usually the buildmaster is running a status webserver on the same machine, so simply point your web browser at it and see if you can get there.
Install whatever additional packages or libraries the project’s INSTALL document advises.
(or not: if your worker is supposed to make sure that building without optional libraries still works, then don’t install those libraries.)</p>
<p>Again, these libraries don’t necessarily have to be installed to a site-wide shared location, but they must be available to your build process.
Accomplishing this is usually very specific to the build process, so installing them to <code class="file docutils literal notranslate"><span class="pre">/usr</span></code> or <code class="file docutils literal notranslate"><span class="pre">/usr/local</span></code> is usually the best approach.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Test the build process</p></li>
</ol>
<blockquote>
<div><p>Follow the instructions in the <code class="file docutils literal notranslate"><span class="pre">INSTALL</span></code> document, in the worker’s account.
Perform a full CVS (or whatever) checkout, configure, make, run tests, etc.
Confirm that the build works without manual fussing.
If it doesn’t work when you do it manually, it will be unlikely to work when Buildbot attempts to do it in an automated fashion.</p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Choose a base directory</p></li>
</ol>
<blockquote>
<div><p>This should be somewhere in the worker’s account, typically named after the project which is being tested.
The worker will not touch any file outside of this directory.
Something like <code class="file docutils literal notranslate"><span class="pre">~/Buildbot</span></code> or <code class="file docutils literal notranslate"><span class="pre">~/Workers/fooproject</span></code> is appropriate.</p>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Get the buildmaster host/port, workername, and password</p></li>
</ol>
<blockquote>
<div><p>When the Buildbot admin configures the buildmaster to accept and use your worker, they will provide you with the following pieces of information:</p>
<ul class="simple">
<li><p>your worker’s name</p></li>
<li><p>the password assigned to your worker</p></li>
<li><p>the hostname and port number of the buildmaster</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Create the worker</p></li>
</ol>
<blockquote>
<div><p>Now run the ‘worker’ command as follows:</p>
<blockquote>
<div><p><code class="samp docutils literal notranslate"><span class="pre">buildbot-worker</span> <span class="pre">create-worker</span> <em><span class="pre">BASEDIR</span></em> <em><span class="pre">MASTERHOST</span></em><span class="pre">:</span><em><span class="pre">PORT</span></em> <em><span class="pre">WORKERNAME</span></em> <em><span class="pre">PASSWORD</span></em></code></p>
</div></blockquote>
<p>This will create the base directory and a collection of files inside, including the <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code> file that contains all the information you passed to the <strong class="command">buildbot-worker</strong> command.</p>
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>Fill in the hostinfo files</p></li>
</ol>
<blockquote>
<div><p>When it first connects, the worker will send a few files up to the buildmaster which describe the host that it is running on.
These files are presented on the web status display so that developers have more information to reproduce any test failures that are witnessed by the Buildbot.
There are sample files in the <code class="file docutils literal notranslate"><span class="pre">info</span></code> subdirectory of the Buildbot’s base directory.
You should edit these to correctly describe you and your host.</p>
<p><code class="file docutils literal notranslate"><em><span class="pre">BASEDIR</span></em><span class="pre">/info/admin</span></code> should contain your name and email address.
This is the <code class="docutils literal notranslate"><span class="pre">worker</span> <span class="pre">admin</span> <span class="pre">address</span></code>, and will be visible from the build status page (so you may wish to munge it a bit if address-harvesting spambots are a concern).</p>
<p><code class="file docutils literal notranslate"><em><span class="pre">BASEDIR</span></em><span class="pre">/info/host</span></code> should be filled with a brief description of the host: OS, version, memory size, CPU speed, versions of relevant libraries installed, and finally the version of the Buildbot code which is running the worker.</p>
<p>The optional <code class="file docutils literal notranslate"><em><span class="pre">BASEDIR</span></em><span class="pre">/info/access_uri</span></code> can specify a URI which will connect a user to the machine.
Many systems accept <code class="docutils literal notranslate"><span class="pre">ssh://hostname</span></code> URIs for this purpose.</p>
<p>If you run many workers, you may want to create a single <code class="file docutils literal notranslate"><span class="pre">~worker/info</span></code> file and share it among all the workers with symlinks.</p>
</div></blockquote>
<section id="worker-options">
<span id="id2"></span><h3>Worker Options<a class="headerlink" href="#worker-options" title="Link to this heading"></a></h3>
<p>There are a handful of options you might want to use when creating the worker with the <code class="samp docutils literal notranslate"><span class="pre">buildbot-worker</span> <span class="pre">create-worker</span> <span class="pre">&lt;options&gt;</span> <span class="pre">DIR</span> <span class="pre">&lt;params&gt;</span></code> command.
You can type <code class="docutils literal notranslate"><span class="pre">buildbot-worker</span> <span class="pre">create-worker</span> <span class="pre">--help</span></code> for a summary.
To use these, just include them on the <code class="docutils literal notranslate"><span class="pre">buildbot-worker</span> <span class="pre">create-worker</span></code> command line, like this</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>buildbot-worker<span class="w"> </span>create-worker<span class="w"> </span>--umask<span class="o">=</span>0o22<span class="w"> </span>~/worker<span class="w"> </span>buildmaster.example.org:42012<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">{</span>myworkername<span class="o">}</span><span class="w"> </span><span class="o">{</span>mypasswd<span class="o">}</span>
</pre></div>
</div>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-protocol">
<span class="sig-name descname"><span class="pre">--protocol</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-protocol" title="Link to this definition"></a></dt>
<dd><p>This is a string representing a protocol to be used when creating master-worker connection.
The default option is Perspective Broker (<code class="docutils literal notranslate"><span class="pre">pb</span></code>).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-no-logrotate">
<span class="sig-name descname"><span class="pre">--no-logrotate</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-no-logrotate" title="Link to this definition"></a></dt>
<dd><p>This disables internal worker log management mechanism.
With this option worker does not override the default logfile name and its behaviour giving a possibility to control those with command-line options of twistd daemon.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-umask">
<span class="sig-name descname"><span class="pre">--umask</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-umask" title="Link to this definition"></a></dt>
<dd><p>This is a string (generally an octal representation of an integer) which will cause the worker process’ <code class="docutils literal notranslate"><span class="pre">umask</span></code> value to be set shortly after initialization.
The <code class="docutils literal notranslate"><span class="pre">twistd</span></code> daemonization utility forces the umask to 077 at startup (which means that all files created by the worker or its child processes will be unreadable by any user other than the worker account).
If you want build products to be readable by other accounts, you can add <code class="docutils literal notranslate"><span class="pre">--umask=0o22</span></code> to tell the worker to fix the umask after twistd clobbers it.
If you want build products to be <em>writable</em> by other accounts too, use <code class="docutils literal notranslate"><span class="pre">--umask=0o000</span></code>, but this is likely to be a security problem.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-keepalive">
<span class="sig-name descname"><span class="pre">--keepalive</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-keepalive" title="Link to this definition"></a></dt>
<dd><p>This is a number that indicates how frequently <code class="docutils literal notranslate"><span class="pre">keepalive</span></code> messages should be sent from the worker to the buildmaster, expressed in seconds.
The default (600) causes a message to be sent to the buildmaster at least once every 10 minutes.
To set this to a lower value, use e.g. <code class="docutils literal notranslate"><span class="pre">--keepalive=120</span></code>.</p>
<p>If the worker is behind a NAT box or stateful firewall, these messages may help to keep the connection alive: some NAT boxes tend to forget about a connection if it has not been used in a while.
When this happens, the buildmaster will think that the worker has disappeared, and builds will time out.
Meanwhile the worker will not realize that anything is wrong.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-maxdelay">
<span class="sig-name descname"><span class="pre">--maxdelay</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-maxdelay" title="Link to this definition"></a></dt>
<dd><p>This is a number that indicates the maximum amount of time the worker will wait between connection attempts, expressed in seconds.
The default (300) causes the worker to wait at most 5 minutes before trying to connect to the buildmaster again.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-maxretries">
<span class="sig-name descname"><span class="pre">--maxretries</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-maxretries" title="Link to this definition"></a></dt>
<dd><p>This is a number that indicates the maximum number of times the worker will make connection attempts.
After that amount, the worker process will stop.
This option is useful for <a class="reference internal" href="../configuration/workers.html#latent-workers"><span class="std std-ref">Latent Workers</span></a> to avoid consuming resources in case of misconfiguration or master failure.</p>
<p>For VM based latent workers, the user is responsible for halting the system when the Buildbot worker has exited.
This feature is heavily OS dependent, and cannot be managed by the Buildbot worker.
For example, with <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">systemd</a>, one can add <code class="docutils literal notranslate"><span class="pre">ExecStopPost=shutdown</span> <span class="pre">now</span></code> to the Buildbot worker service unit configuration.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-log-size">
<span class="sig-name descname"><span class="pre">--log-size</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-log-size" title="Link to this definition"></a></dt>
<dd><p>This is the size in bytes when exceeded to rotate the Twisted log files.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-log-count">
<span class="sig-name descname"><span class="pre">--log-count</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-log-count" title="Link to this definition"></a></dt>
<dd><p>This is the number of log rotations to keep around.
You can either specify a number or <code class="docutils literal notranslate"><span class="pre">None</span></code> to keep all <code class="file docutils literal notranslate"><span class="pre">twistd.log</span></code> files around.
The default is 10.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-allow-shutdown">
<span class="sig-name descname"><span class="pre">--allow-shutdown</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-allow-shutdown" title="Link to this definition"></a></dt>
<dd><p>Can also be passed directly to the worker constructor in <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code>.
If set, it allows the worker to initiate a graceful shutdown, meaning that it will ask the master to shut down the worker when the current build, if any, is complete.</p>
<p>Setting allow_shutdown to <code class="docutils literal notranslate"><span class="pre">file</span></code> will cause the worker to watch <code class="file docutils literal notranslate"><span class="pre">shutdown.stamp</span></code> in basedir for updates to its mtime.
When the mtime changes, the worker will request a graceful shutdown from the master.
The file does not need to exist prior to starting the worker.</p>
<p>Setting allow_shutdown to <code class="docutils literal notranslate"><span class="pre">signal</span></code> will set up a SIGHUP handler to start a graceful shutdown.
When the signal is received, the worker will request a graceful shutdown from the master.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>, in which case this feature will be disabled.</p>
<p>Both master and worker must be at least version 0.8.3 for this feature to work.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-use-tls">
<span class="sig-name descname"><span class="pre">--use-tls</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-use-tls" title="Link to this definition"></a></dt>
<dd><p>Can also be passed directly to the Worker constructor in <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code>.
If set, the generated connection string starts with <code class="docutils literal notranslate"><span class="pre">tls</span></code> instead of with <code class="docutils literal notranslate"><span class="pre">tcp</span></code>, allowing encrypted connection to the buildmaster.
Make sure the worker trusts the buildmasters certificate. If you have an non-authoritative certificate (CA is self-signed) see option <code class="docutils literal notranslate"><span class="pre">--connection-string</span></code> and also <a class="reference internal" href="#worker-tls-config">Worker-TLS-Config</a> below.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-delete-leftover-dirs">
<span class="sig-name descname"><span class="pre">--delete-leftover-dirs</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-delete-leftover-dirs" title="Link to this definition"></a></dt>
<dd><p>Can also be passed directly to the Worker constructor in <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code>.
If set, unexpected directories in worker base directory will be removed.
Otherwise, a warning will be displayed in <code class="file docutils literal notranslate"><span class="pre">twistd.log</span></code> so that you can manually remove them.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-connection-string">
<span class="sig-name descname"><span class="pre">--connection-string</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-connection-string" title="Link to this definition"></a></dt>
<dd><p>Can also be passed directly to the Worker constructor in <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code>.
If set, the worker connection to master will be made using this <code class="docutils literal notranslate"><span class="pre">connection_string</span></code>. See <a class="reference internal" href="#worker-tls-config">Worker-TLS-Config</a> below for more details.
Note that this option will override required positional argument <code class="docutils literal notranslate"><span class="pre">masterhost[:port]</span></code> and also option <code class="docutils literal notranslate"><span class="pre">--use-tls</span></code>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-buildbot-worker-create-worker-proxy-connection-string">
<span class="sig-name descname"><span class="pre">--proxy-connection-string</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-buildbot-worker-create-worker-proxy-connection-string" title="Link to this definition"></a></dt>
<dd><p>Can also be passed directly to the Worker constructor in <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code>.
If set, the worker connection will be tunneled through a HTTP proxy specified by the option value.</p>
</dd></dl>

</section>
<section id="other-worker-configuration">
<span id="id3"></span><h3>Other Worker Configuration<a class="headerlink" href="#other-worker-configuration" title="Link to this heading"></a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">unicode_encoding</span></code></dt><dd><p>This represents the encoding that Buildbot should use when converting unicode commandline arguments into byte strings in order to pass to the operating system when spawning new processes.</p>
<p>The default value is what Python’s <code class="xref py py-func docutils literal notranslate"><span class="pre">sys.getfilesystemencoding</span></code> returns, which on Windows is ‘mbcs’, on Mac OSX is ‘utf-8’, and on Unix depends on your locale settings.</p>
<p>If you need a different encoding, this can be changed in your worker’s <code class="file docutils literal notranslate"><span class="pre">buildbot.tac</span></code> file by adding a <code class="docutils literal notranslate"><span class="pre">unicode_encoding</span></code> argument to the Worker constructor.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">buildmaster_host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">workername</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">basedir</span><span class="p">,</span>
           <span class="n">keepalive</span><span class="p">,</span> <span class="n">usepty</span><span class="p">,</span> <span class="n">umask</span><span class="o">=</span><span class="n">umask</span><span class="p">,</span> <span class="n">maxdelay</span><span class="o">=</span><span class="n">maxdelay</span><span class="p">,</span>
           <span class="n">unicode_encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">allow_shutdown</span><span class="o">=</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="worker-tls-configuration">
<span id="worker-tls-config"></span><h3>Worker TLS Configuration<a class="headerlink" href="#worker-tls-configuration" title="Link to this heading"></a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">tls</span></code></dt><dd><p>See <code class="docutils literal notranslate"><span class="pre">--useTls</span></code> option above as an alternative to setting the <code class="docutils literal notranslate"><span class="pre">conneciton_string</span></code> manually.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">connection_string</span></code></dt><dd><p>For TLS connections to the master, the <code class="docutils literal notranslate"><span class="pre">connection_string</span></code>-argument must be passed to the worker constructor. <code class="docutils literal notranslate"><span class="pre">buildmaster_host</span></code> and <code class="docutils literal notranslate"><span class="pre">port</span></code> must then be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">connection_string</span></code> will be used to create a client endpoint with <a class="reference external" href="https://docs.twistedmatrix.com/en/stable/api/twisted.internet.endpoints.html#clientFromString">clientFromString</a>. An example of <code class="docutils literal notranslate"><span class="pre">connection_string</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;TLS:buildbot-master.com:9989&quot;</span></code>.</p>
<p>See more about how to formulate the connection string in <a class="reference external" href="https://docs.twistedmatrix.com/en/stable/core/howto/endpoints.html">ConnectionStrings</a>.</p>
<p>Example TLS connection string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">workername</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">basedir</span><span class="p">,</span> <span class="n">keepalive</span><span class="p">,</span>
           <span class="n">connection_string</span><span class="o">=</span><span class="s1">&#39;TLS:buildbot-master.com:9989&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Make sure the worker trusts the certificate of the master. If you have a non-authoritative certificate
(CA is self-signed), the trustRoots parameter can be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">workername</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">basedir</span><span class="p">,</span> <span class="n">keepalive</span><span class="p">,</span>
           <span class="n">connection_string</span><span class="o">=</span>
           <span class="s1">&#39;TLS:buildbot-master.com:9989:trustRoots=/dir-with-ca-certs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It must point to a directory with PEM-encoded certificates. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>/dir-with-ca-certs/ca.pem
-----BEGIN<span class="w"> </span>CERTIFICATE-----
MIIE9DCCA9ygAwIBAgIJALEqLrC/m1w3MA0GCSqGSIb3DQEBCwUAMIGsMQswCQYD
VQQGEwJaWjELMAkGA1UECBMCUUExEDAOBgNVBAcTB05vd2hlcmUxETAPBgNVBAoT
CEJ1aWxkYm90MRkwFwYDVQQLExBEZXZlbG9wbWVudCBUZWFtMRQwEgYDVQQDEwtC
dWlsZGJvdCBDQTEQMA4GA1UEKRMHRWFzeVJTQTEoMCYGCSqGSIb3DQEJARYZYnVp
bGRib3RAaW50ZWdyYXRpb24udGVzdDAeFw0xNjA5MDIxMjA5NTJaFw0yNjA4MzEx
MjA5NTJaMIGsMQswCQYDVQQGEwJaWjELMAkGA1UECBMCUUExEDAOBgNVBAcTB05v
d2hlcmUxETAPBgNVBAoTCEJ1aWxkYm90MRkwFwYDVQQLExBEZXZlbG9wbWVudCBU
ZWFtMRQwEgYDVQQDEwtCdWlsZGJvdCBDQTEQMA4GA1UEKRMHRWFzeVJTQTEoMCYG
CSqGSIb3DQEJARYZYnVpbGRib3RAaW50ZWdyYXRpb24udGVzdDCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBALJZcC9j4XYBi1fYT/fibY2FRWn6Qh74b1Pg
I7iIde6Sf3DPdh/ogYvZAT+cIlkZdo4v326d0EkuYKcywDvho8UeET6sIYhuHPDW
lRl1Ret6ylxpbEfxFNvMoEGNhYAP0C6QS2eWEP9LkV2lCuMQtWWzdedjk+efqBjR
Gozaim0lr/5lx7bnVx0oRLAgbI5/9Ukbopansfr+Cp9CpFpbNPGZSmELzC3FPKXK
5tycj8WEqlywlha2/VRnCZfYefB3aAuQqQilLh+QHyhn6hzc26+n5B0l8QvrMkOX
atKdznMLzJWGxS7UwmDKcsolcMAW+82BZ8nUCBPF3U5PkTLO540CAwEAAaOCARUw
ggERMB0GA1UdDgQWBBT7A/I+MZ1sFFJ9jikYkn51Q3wJ+TCB4QYDVR0jBIHZMIHW
gBT7A/I+MZ1sFFJ9jikYkn51Q3wJ+aGBsqSBrzCBrDELMAkGA1UEBhMCWloxCzAJ
BgNVBAgTAlFBMRAwDgYDVQQHEwdOb3doZXJlMREwDwYDVQQKEwhCdWlsZGJvdDEZ
MBcGA1UECxMQRGV2ZWxvcG1lbnQgVGVhbTEUMBIGA1UEAxMLQnVpbGRib3QgQ0Ex
EDAOBgNVBCkTB0Vhc3lSU0ExKDAmBgkqhkiG9w0BCQEWGWJ1aWxkYm90QGludGVn
cmF0aW9uLnRlc3SCCQCxKi6wv5tcNzAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEB
CwUAA4IBAQCJGJVMAmwZRK/mRqm9E0e3s4YGmYT2jwX5IX17XljEy+1cS4huuZW2
33CFpslkT1MN/r8IIZWilxT/lTujHyt4eERGjE1oRVKU8rlTH8WUjFzPIVu7nkte
09abqynAoec8aQukg79NRCY1l/E2/WzfnUt3yTgKPfZmzoiN0K+hH4gVlWtrizPA
LaGwoslYYTA6jHNEeMm8OQLNf17OTmAa7EpeIgVpLRCieI9S3JIG4WYU8fVkeuiU
cB439SdixU4cecVjNfFDpq6JM8N6+DQoYOSNRt9Dy0ioGyx5D4lWoIQ+BmXQENal
gw+XLyejeNTNgLOxf9pbNYMJqxhkTkoE
-----END<span class="w"> </span>CERTIFICATE-----
</pre></div>
</div>
<p>Using TCP in <code class="docutils literal notranslate"><span class="pre">connection_string</span></code> is the equivalent to using the <code class="docutils literal notranslate"><span class="pre">buildmaster_host</span></code> and <code class="docutils literal notranslate"><span class="pre">port</span></code> arguments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">workername</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">basedir</span><span class="p">,</span> <span class="n">keepalive</span>
           <span class="n">connection_string</span><span class="o">=</span><span class="s1">&#39;TCP:buildbot-master.com:9989&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="s1">&#39;buildbot-master.com&#39;</span><span class="p">,</span> <span class="mi">9989</span><span class="p">,</span> <span class="n">workername</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">basedir</span><span class="p">,</span>
           <span class="n">keepalive</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="buildmaster.html" class="btn btn-neutral float-left" title="2.2.4. Buildmaster Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="misc.html" class="btn btn-neutral float-right" title="2.2.6. Next Steps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
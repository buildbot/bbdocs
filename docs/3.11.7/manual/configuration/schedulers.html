<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.5.5. Schedulers &mdash; Buildbot 3.11.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/buildbot_rtd.css?v=915d5e18" />

  
    <link rel="shortcut icon" href="../../_static/icon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=428c4438"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.5.6. Workers" href="workers.html" />
    <link rel="prev" title="2.5.3. Change Sources and Changes" href="changesources.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Buildbot
              <img src="../../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.11.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/index.html">2.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../secretsmanagement.html">2.4. Secret Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">2.5. Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">2.5.1. Configuring Buildbot</a></li>
<li class="toctree-l3"><a class="reference internal" href="global.html">2.5.2. Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="changesources.html">2.5.3. Change Sources and Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="changesources.html#changes">2.5.4. Changes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.5.5. Schedulers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuring-schedulers">2.5.5.1. Configuring Schedulers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scheduler-resiliency">2.5.5.2. Scheduler Resiliency</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage-example">2.5.5.3. Usage example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scheduler-types">2.5.5.4. Scheduler Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="workers.html">2.5.6. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="builders.html">2.5.7. Builder Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html">2.5.8. Projects</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildfactories.html">2.5.9. Build Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildsets.html">2.5.10. Build Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties.html">2.5.11. Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="steps/index.html">2.5.12. Build Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="interlocks.html">2.5.13. Interlocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="report_generators/index.html">2.5.14. Report Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="reporters/index.html">2.5.15. Reporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="www.html">2.5.16. Web Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="wwwhooks.html">2.5.17. Change Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/index.html">2.5.18. Custom Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="dbconfig.html">2.5.19. DbConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html">2.5.20. Configurators</a></li>
<li class="toctree-l3"><a class="reference internal" href="manhole.html">2.5.21. Manhole</a></li>
<li class="toctree-l3"><a class="reference internal" href="multimaster.html">2.5.22. Multimaster</a></li>
<li class="toctree-l3"><a class="reference internal" href="multicodebase.html">2.5.23. Multiple-Codebase Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="misc/index.html">2.5.24. Miscellaneous Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="tests/index.html">2.5.25. Testing Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline.html">2.7. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources.html">2.8. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization.html">2.9. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins.html">2.10. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deploy.html">2.11. Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrading/index.html">2.12. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">2. </span>Buildbot Manual</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">2.5. </span>Configuration</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.5.5. </span>Schedulers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/manual/configuration/schedulers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="schedulers">
<span id="id1"></span><h1><span class="section-number">2.5.5. </span>Schedulers<a class="headerlink" href="#schedulers" title="Link to this heading">ÔÉÅ</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#configuring-schedulers" id="id10">Configuring Schedulers</a></p></li>
<li><p><a class="reference internal" href="#scheduler-resiliency" id="id11">Scheduler Resiliency</a></p></li>
<li><p><a class="reference internal" href="#usage-example" id="id12">Usage example</a></p></li>
<li><p><a class="reference internal" href="#scheduler-types" id="id13">Scheduler Types</a></p>
<ul>
<li><p><a class="reference internal" href="#singlebranchscheduler" id="id14">SingleBranchScheduler</a></p></li>
<li><p><a class="reference internal" href="#anybranchscheduler" id="id15">AnyBranchScheduler</a></p></li>
<li><p><a class="reference internal" href="#dependent-scheduler" id="id16">Dependent Scheduler</a></p></li>
<li><p><a class="reference internal" href="#periodic-scheduler" id="id17">Periodic Scheduler</a></p></li>
<li><p><a class="reference internal" href="#nightly-scheduler" id="id18">Nightly Scheduler</a></p></li>
<li><p><a class="reference internal" href="#try-schedulers" id="id19">Try Schedulers</a></p></li>
<li><p><a class="reference internal" href="#triggerable-scheduler" id="id20">Triggerable Scheduler</a></p></li>
<li><p><a class="reference internal" href="#nightlytriggerable-scheduler" id="id21">NightlyTriggerable Scheduler</a></p></li>
<li><p><a class="reference internal" href="#forcescheduler-scheduler" id="id22">ForceScheduler Scheduler</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>Schedulers are responsible for initiating builds on builders.</p>
<p>Some schedulers listen for changes from ChangeSources and generate build sets in response to these changes.
Others generate build sets without changes, based on other events in the buildmaster.</p>
<section id="configuring-schedulers">
<span id="id2"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">2.5.5.1. </span>Configuring Schedulers</a><a class="headerlink" href="#configuring-schedulers" title="Link to this heading">ÔÉÅ</a></h2>
<p id="cfg-schedulers">The <a class="reference internal" href="#cfg-schedulers" title="schedulers"><code class="xref bb bb-cfg docutils literal notranslate"><span class="pre">schedulers</span></code></a> configuration parameter gives a list of scheduler instances, each of which causes builds to be started on a particular set of Builders.
The two basic scheduler classes you are likely to start with are <a class="reference internal" href="#sched-SingleBranchScheduler" title="SingleBranchScheduler"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">SingleBranchScheduler</span></code></a> and <a class="reference internal" href="#sched-Periodic" title="Periodic"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Periodic</span></code></a>, but you can write a customized subclass to implement more complicated build scheduling.</p>
<p>Scheduler arguments should always be specified by name (as keyword arguments), to allow for future expansion:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sched</span> <span class="o">=</span> <span class="n">SingleBranchScheduler</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;quick&quot;</span><span class="p">,</span> <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="s1">&#39;win&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>There are several common arguments for schedulers, although not all are available with all schedulers.</p>
<p id="scheduler-attr-name"><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>Each Scheduler must have a unique name.
This is used in status displays, and is also available in the build property <code class="docutils literal notranslate"><span class="pre">scheduler</span></code>.</p>
</div></blockquote>
<p id="scheduler-attr-buildernames"><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>This is the set of builders which this scheduler should trigger, specified as a list of names (strings).
This can also be an <code class="xref py py-class docutils literal notranslate"><span class="pre">IRenderable</span></code> object which will render to a list of builder names (or a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">IRenderable</span></code> that will render to builder names).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">builderNames</span></code> is rendered, these additional <code class="xref py py-class docutils literal notranslate"><span class="pre">Properties</span></code> attributes are available:</p>
<p><code class="docutils literal notranslate"><span class="pre">master</span></code></p>
<blockquote>
<div><p>A reference to the <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildMaster</span></code> object that owns this scheduler.
This can be used to access the data API.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">sourcestamps</span></code></p>
<blockquote>
<div><p>The list of sourcestamps that triggered the scheduler.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">changes</span></code></p>
<blockquote>
<div><p>The list of changes associated with the sourcestamps.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">files</span></code></p>
<blockquote>
<div><p>The list of modified files associated with the changes.</p>
</div></blockquote>
<p>Any property attached to the change(s) that triggered the scheduler will be combined and available when rendering <cite>builderNames</cite>.</p>
</div>
<p>Here is a simple example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">util</span><span class="p">,</span> <span class="n">schedulers</span>

<span class="nd">@util</span><span class="o">.</span><span class="n">renderer</span>
<span class="k">def</span> <span class="nf">builderNames</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
    <span class="n">builders</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.rst&#39;</span><span class="p">):</span>
            <span class="n">builders</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;check_docs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.c&#39;</span><span class="p">):</span>
            <span class="n">builders</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;check_code&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span>

<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">schedulers</span><span class="o">.</span><span class="n">AnyBranchScheduler</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
        <span class="n">builderNames</span><span class="o">=</span><span class="n">builderNames</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>And a more complex one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fnmatch</span>

<span class="kn">from</span> <span class="nn">twisted.internet</span> <span class="kn">import</span> <span class="n">defer</span>

<span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">util</span><span class="p">,</span> <span class="n">schedulers</span>

<span class="nd">@util</span><span class="o">.</span><span class="n">renderer</span>
<span class="nd">@defer</span><span class="o">.</span><span class="n">inlineCallbacks</span>
<span class="k">def</span> <span class="nf">builderNames</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
    <span class="c1"># If &quot;buildername_pattern&quot; is defined with &quot;buildbot sendchange&quot;,</span>
    <span class="c1"># check if the builder name matches it.</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;buildername_pattern&#39;</span><span class="p">)</span>

    <span class="c1"># If &quot;builder_tags&quot; is defined with &quot;buildbot sendchange&quot;,</span>
    <span class="c1"># only schedule builders that have the specified tags.</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;builder_tags&#39;</span><span class="p">)</span>

    <span class="n">builders</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">(</span><span class="k">yield</span> <span class="n">props</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s1">&#39;builders&#39;</span><span class="p">,))):</span>
        <span class="k">if</span> <span class="n">pattern</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatchcase</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">pattern</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">tags</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">])):</span>
            <span class="k">continue</span>
        <span class="n">builders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">builders</span>

<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
   <span class="n">schedulers</span><span class="o">.</span><span class="n">AnyBranchScheduler</span><span class="p">(</span>
      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span>
      <span class="n">builderNames</span><span class="o">=</span><span class="n">builderNames</span><span class="p">,</span>
   <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<p id="scheduler-attr-properties"><span id="index-0"></span><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>This is a dictionary specifying properties that will be transmitted to all builds started by this scheduler.
The <code class="docutils literal notranslate"><span class="pre">owner</span></code> property may be of particular interest, as its contents (list) will be added to the list of ‚Äúinterested users‚Äù (<a class="reference internal" href="../concepts.html#doing-things-with-users"><span class="std std-ref">Doing Things With Users</span></a>) for each triggered build.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sched</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="o">...</span><span class="p">,</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;zorro@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;silver@example.com&#39;</span><span class="p">]</span>
    <span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
<p id="scheduler-attr-codebases"><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>Specifies codebase definitions that are used when the scheduler processes data from more than one repository at the same time.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">codebases</span></code> parameter is only used to fill in missing details about a codebase when scheduling a build.
For example, when a change to codebase <code class="docutils literal notranslate"><span class="pre">A</span></code> occurs, a scheduler must invent a sourcestamp for codebase <code class="docutils literal notranslate"><span class="pre">B</span></code>.
Source steps that specify codebase <code class="docutils literal notranslate"><span class="pre">B</span></code> as their codebase will use the invented timestamp.</p>
<p>The parameter does not act as a filter on incoming changes ‚Äì use a change filter for that purpose.</p>
<p>This parameter can be specified in two forms:</p>
<blockquote>
<div><ul class="simple">
<li><p>as a list of strings.
This is the simplest form; use it if no special overrides are needed.
In this form, just the names of the codebases are listed.</p></li>
<li><p>as a dictionary of dictionaries.
In this form, the per-codebase overrides of repository, branch and revision can be specified.</p></li>
</ul>
</div></blockquote>
<p>Each codebase definition dictionary is a dictionary with any of the keys: <code class="docutils literal notranslate"><span class="pre">repository</span></code>, <code class="docutils literal notranslate"><span class="pre">branch</span></code>, <code class="docutils literal notranslate"><span class="pre">revision</span></code>.
The codebase definitions are combined in a dictionary keyed by the name of the codebase.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">codebases</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;codebase1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;repository&#39;</span><span class="p">:</span><span class="s1">&#39;....&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;branch&#39;</span><span class="p">:</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;revision&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
             <span class="s1">&#39;codebase2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;repository&#39;</span><span class="p">:</span><span class="s1">&#39;....&#39;</span><span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p id="scheduler-attr-fileisimportant"><code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> (optional)</p>
<blockquote>
<div><p>A callable which takes as argument a Change instance and returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the change is worth building, and <code class="docutils literal notranslate"><span class="pre">False</span></code> if it is not.
Unimportant Changes are accumulated until the build is triggered by an important change.
The default value of <code class="docutils literal notranslate"><span class="pre">None</span></code> means that all Changes are important.</p>
</div></blockquote>
<p id="scheduler-attr-changefilter"><code class="docutils literal notranslate"><span class="pre">change_filter</span></code> (optional)</p>
<blockquote>
<div><p>The change filter that will determine which changes are recognized by this scheduler (see <a class="reference internal" href="misc/change_filter.html#changefilter"><span class="std std-ref">ChangeFilter</span></a>).
Note that this is different from <code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code>; if the change filter filters out a change, the change is completely ignored by the scheduler.
If a change is allowed by the change filter but is deemed unimportant, it will not cause builds to start but will be remembered and shown in status displays.
The default value of <code class="docutils literal notranslate"><span class="pre">None</span></code> does not filter any changes at all.</p>
</div></blockquote>
<p id="scheduler-attr-onlyimportant"><code class="docutils literal notranslate"><span class="pre">onlyImportant</span></code> (optional)</p>
<blockquote>
<div><p>A boolean that, when <code class="docutils literal notranslate"><span class="pre">True</span></code>, only adds important changes to the buildset as specified in the <code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> callable.
This means that unimportant changes are ignored the same way a <code class="docutils literal notranslate"><span class="pre">change_filter</span></code> filters changes.
The default value is <code class="docutils literal notranslate"><span class="pre">False</span></code> and only applies when <code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> is given.</p>
</div></blockquote>
<p id="scheduler-attr-reason"><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>A string that will be used as the reason for the triggered build.
By default it lists the type and name of the scheduler triggering the build.</p>
</div></blockquote>
<p id="scheduler-attr-priority"><code class="docutils literal notranslate"><span class="pre">priority</span></code> (optional)</p>
<blockquote>
<div><p>Specifies the default priority for <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildRequests</span></code> created by this scheduler.
It can either be an integer or a function (see <a class="reference internal" href="../customization.html#scheduler-priority-functions"><span class="std std-ref">Scheduler Priority Functions</span></a>).
By default it creates <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildRequests</span></code> with priority 0.</p>
</div></blockquote>
<p>The remaining subsections represent a catalog of the available scheduler types.
All these schedulers are defined in modules under <code class="xref py py-mod docutils literal notranslate"><span class="pre">buildbot.schedulers</span></code>, and their docstrings are the best source of documentation on the arguments each one takes.</p>
</section>
<section id="scheduler-resiliency">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">2.5.5.2. </span>Scheduler Resiliency</a><a class="headerlink" href="#scheduler-resiliency" title="Link to this heading">ÔÉÅ</a></h2>
<p>In a multi-master configuration, schedulers with the same name can be configured on multiple masters.
Only one instance of the scheduler will be active.
If that instance becomes inactive, due to its master being shut down or failing, then another instance will become active after a short delay.
This provides resiliency in scheduler configurations, so that schedulers are not a single point of failure in a Buildbot infrastructure.</p>
<p>The Data API and web UI display the master on which each scheduler is running.</p>
<p>There is currently no mechanism to control which master‚Äôs scheduler instance becomes active.
The behavior is nondeterministic, based on the timing of polling by inactive schedulers.
The failover is non-revertive.</p>
</section>
<section id="usage-example">
<h2><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">2.5.5.3. </span>Usage example</a><a class="headerlink" href="#usage-example" title="Link to this heading">ÔÉÅ</a></h2>
<p>A <em>quick</em> scheduler might exist to give immediate feedback to developers, hoping to catch obvious problems in the code that can be detected quickly.
These typically do not run the full test suite, nor do they run on a wide variety of platforms.
They also usually do a VC update rather than performing a brand-new checkout each time.</p>
<p>A separate <em>full</em> scheduler might run more comprehensive tests, to catch more subtle problems.
It might be configured to run after the quick scheduler, to give developers time to commit fixes to bugs caught by the quick scheduler before running the comprehensive tests.
This scheduler would also feed multiple <code class="xref py py-class docutils literal notranslate"><span class="pre">Builder</span></code>s.</p>
<p>Many schedulers can be configured to wait a while after seeing a source-code change - this is the <em>tree stable timer</em>.
The timer allows multiple commits to be ‚Äúbatched‚Äù together.
This is particularly useful in distributed version control systems, where a developer may push a long sequence of changes all at once.
To save resources, it‚Äôs often desirable only to test the most recent change.</p>
<p>Schedulers can also filter out the changes they are interested in, based on a number of criteria.
For example, a scheduler that only builds documentation might skip any changes that do not affect the documentation.
Schedulers can also filter on the branch to which a commit was made.</p>
<p>Periodic builds (those which are run every N seconds rather than after new Changes arrive) are triggered by a special <a class="reference internal" href="#sched-Periodic" title="Periodic"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Periodic</span></code></a> scheduler.</p>
<p>Each scheduler creates and submits <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildSet</span></code> objects to the <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildMaster</span></code>, which is then responsible for making sure the individual <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildRequests</span></code> are delivered to the target <code class="xref py py-class docutils literal notranslate"><span class="pre">Builder</span></code>s.</p>
<p>Scheduler instances are activated by placing them in the <a class="reference internal" href="#cfg-schedulers" title="schedulers"><code class="xref bb bb-cfg docutils literal notranslate"><span class="pre">schedulers</span></code></a> list in the buildmaster config file.
Each scheduler must have a unique name.</p>
</section>
<section id="scheduler-types">
<h2><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">2.5.5.4. </span>Scheduler Types</a><a class="headerlink" href="#scheduler-types" title="Link to this heading">ÔÉÅ</a></h2>
<section id="singlebranchscheduler">
<span id="scheduler-singlebranchscheduler"></span><span id="sched-Scheduler"></span><span id="sched-SingleBranchScheduler"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink">SingleBranchScheduler</a><a class="headerlink" href="#singlebranchscheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>This is the original and still most popular scheduler class.
It follows exactly one branch, and starts a configurable tree-stable-timer after each change on that branch.
When the timer expires, it starts a build on some set of Builders.
This scheduler accepts a <code class="xref py py-meth docutils literal notranslate"><span class="pre">fileIsImportant</span></code> function which can be used to ignore some Changes if they do not affect any <em>important</em> files.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code> is not set, then this scheduler starts a build for every Change that matches its <code class="docutils literal notranslate"><span class="pre">change_filter</span></code> and satisfies <code class="xref py py-meth docutils literal notranslate"><span class="pre">fileIsImportant</span></code>.
If <code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code> is set, then a build is triggered for each set of Changes that arrive in intervals shorter than the configured time and match the filters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The behavior of this scheduler is undefined, if <code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code> is set, and changes from multiple branches, repositories or codebases are accepted by the filter.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">codebases</span></code> argument will filter out codebases not specified there, but <em>won‚Äôt</em> filter based on the branches specified there.</p>
</div>
<p>The arguments to this scheduler are:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-fileisimportant"><span class="std std-ref">fileIsImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">change_filter</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-changefilter"><span class="std std-ref">change_filter scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">onlyImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-onlyimportant"><span class="std std-ref">onlyImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-reason"><span class="std std-ref">reason scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code></p>
<blockquote>
<div><p>The scheduler will wait for this many seconds before starting the build.
If new changes are made during this interval, the timer will be restarted.
So the build will be started after this many seconds of inactivity following the last change.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then a separate build is started immediately for each Change.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">categories</span></code> (deprecated; use change_filter)</p>
<blockquote>
<div><p>A list of categories of changes that this scheduler will respond to.
If this is specified, then any non-matching changes are ignored.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">branch</span></code> (deprecated; use change_filter)</p>
<blockquote>
<div><p>The scheduler will pay attention to this branch, ignoring Changes that occur on other branches.
Setting <code class="docutils literal notranslate"><span class="pre">branch</span></code> equal to the special value of <code class="docutils literal notranslate"><span class="pre">None</span></code> means it should only pay attention to the default branch.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code> is a keyword, not a string, so write <code class="docutils literal notranslate"><span class="pre">None</span></code> and not <code class="docutils literal notranslate"><span class="pre">&quot;None&quot;</span></code>.</p>
</div>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span><span class="p">,</span> <span class="n">util</span>
<span class="n">quick</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">SingleBranchScheduler</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;quick&quot;</span><span class="p">,</span>
            <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">),</span>
            <span class="n">treeStableTimer</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
            <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;quick-linux&quot;</span><span class="p">,</span> <span class="s2">&quot;quick-netbsd&quot;</span><span class="p">])</span>
<span class="n">full</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">SingleBranchScheduler</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span>
            <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">),</span>
            <span class="n">treeStableTimer</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span>
            <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;full-linux&quot;</span><span class="p">,</span> <span class="s2">&quot;full-netbsd&quot;</span><span class="p">,</span> <span class="s2">&quot;full-OSX&quot;</span><span class="p">])</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">quick</span><span class="p">,</span> <span class="n">full</span><span class="p">]</span>
</pre></div>
</div>
<p>In this example, the two <em>quick</em> builders are triggered 60 seconds after the tree has been changed.
The <em>full</em> builders do not run quite that quickly (they wait 5 minutes), so that hopefully, if the quick builds fail due to a missing file or a simple typo, the developer can discover and fix the problem before the full builds are started.
Both schedulers only pay attention to the default branch: any changes on other branches are ignored.
Each scheduler triggers a different set of builders, referenced by name.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The old names for this scheduler, <code class="docutils literal notranslate"><span class="pre">buildbot.scheduler.Scheduler</span></code> and <code class="docutils literal notranslate"><span class="pre">buildbot.schedulers.basic.Scheduler</span></code>, are deprecated in favor of using <code class="xref py py-mod docutils literal notranslate"><span class="pre">buildbot.plugins</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span>
</pre></div>
</div>
<p>However if you must use a fully qualified name, it is <code class="docutils literal notranslate"><span class="pre">buildbot.schedulers.basic.SingleBranchScheduler</span></code>.</p>
</div>
</section>
<section id="anybranchscheduler">
<span id="sched-AnyBranchScheduler"></span><span id="id3"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink">AnyBranchScheduler</a><a class="headerlink" href="#anybranchscheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>This scheduler uses a tree-stable-timer like the default one, but uses a separate timer for each branch.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code> is not set, then this scheduler is indistinguishable from <a class="reference internal" href="#sched-SingleBranchScheduler" title="SingleBranchScheduler"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">SingleBranchScheduler</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code> is set, then a build is triggered for each set of Changes that arrive in intervals shorter than the configured time and match the filters.</p>
<p>The arguments to this scheduler are:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-fileisimportant"><span class="std std-ref">fileIsImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">change_filter</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-changefilter"><span class="std std-ref">change_filter scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">onlyImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-onlyimportant"><span class="std std-ref">onlyImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-reason"><span class="std std-ref">reason scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">treeStableTimer</span></code></p>
<blockquote>
<div><p>The scheduler will wait for this many seconds before starting a build.
If new changes are made <em>on the same branch</em> during this interval, the timer will be restarted.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">branches</span></code> (deprecated; use change_filter)</p>
<blockquote>
<div><p>Changes on branches not specified on this list will be ignored.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">categories</span></code> (deprecated; use change_filter)</p>
<blockquote>
<div><p>A list of categories of changes that this scheduler will respond to.
If this is specified, then any non-matching changes are ignored.</p>
</div></blockquote>
</section>
<section id="dependent-scheduler">
<span id="sched-Dependent"></span><span id="id4"></span><h3><a class="toc-backref" href="#id16" role="doc-backlink">Dependent Scheduler</a><a class="headerlink" href="#dependent-scheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>It is common to wind up with one kind of build which should only be performed if the same source code was successfully handled by some other kind of build first.
An example might be a packaging step: you might only want to produce .deb or RPM packages from a tree that was known to compile successfully and pass all unit tests.
You could put the packaging step in the same Build as the compile and testing steps, but there might be other reasons to not do this (in particular you might have several Builders worth of compiles/tests, but only wish to do the packaging once).
Another example is if you want to skip the <em>full</em> builds after a failing <em>quick</em> build of the same source code.
Or, if one Build creates a product (like a compiled library) that is used by some other Builder, you‚Äôd want to make sure the consuming Build is run <em>after</em> the producing one.</p>
<p>You can use <em>dependencies</em> to express this relationship to Buildbot.
There is a special kind of scheduler named <a class="reference internal" href="#sched-Dependent" title="Dependent"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Dependent</span></code></a> that will watch an <em>upstream</em> scheduler for builds to complete successfully (on all of its Builders).
Each time that happens, the same source code (i.e. the same <code class="docutils literal notranslate"><span class="pre">SourceStamp</span></code>) will be used to start a new set of builds, on a different set of Builders.
This <em>downstream</em> scheduler doesn‚Äôt pay attention to Changes at all.
It only pays attention to the upstream scheduler.</p>
<p>If the build fails on any of the Builders in the upstream set, the downstream builds will not fire.
Note that, for SourceStamps generated by a <a class="reference internal" href="#sched-Dependent" title="Dependent"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Dependent</span></code></a> scheduler, the <code class="docutils literal notranslate"><span class="pre">revision</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning HEAD.
If any changes are committed between the time the upstream scheduler begins its build and the time the dependent scheduler begins its build, then those changes will be included in the downstream build.
See the <a class="reference internal" href="#sched-Triggerable" title="Triggerable"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Triggerable</span></code></a> scheduler for a more flexible dependency mechanism that can avoid this problem.</p>
<p>The arguments to this scheduler are:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">upstream</span></code></p>
<blockquote>
<div><p>The upstream scheduler to watch.
Note that this is an <em>instance</em>, not the name of the scheduler.</p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span>
<span class="n">tests</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">SingleBranchScheduler</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;just-tests&quot;</span><span class="p">,</span>
                                         <span class="n">treeStableTimer</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span>
                                         <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;full-linux&quot;</span><span class="p">,</span>
                                                       <span class="s2">&quot;full-netbsd&quot;</span><span class="p">,</span>
                                                       <span class="s2">&quot;full-OSX&quot;</span><span class="p">])</span>
<span class="n">package</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Dependent</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;build-package&quot;</span><span class="p">,</span>
                               <span class="n">upstream</span><span class="o">=</span><span class="n">tests</span><span class="p">,</span> <span class="c1"># &lt;- no quotes!</span>
                               <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;make-tarball&quot;</span><span class="p">,</span> <span class="s2">&quot;make-deb&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;make-rpm&quot;</span><span class="p">])</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tests</span><span class="p">,</span> <span class="n">package</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="periodic-scheduler">
<span id="sched-Periodic"></span><span id="id5"></span><h3><a class="toc-backref" href="#id17" role="doc-backlink">Periodic Scheduler</a><a class="headerlink" href="#periodic-scheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>This simple scheduler just triggers a build every <em>N</em> seconds.</p>
<p>The arguments to this scheduler are:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-fileisimportant"><span class="std std-ref">fileIsImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">change_filter</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-changefilter"><span class="std std-ref">change_filter scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">onlyImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-onlyimportant"><span class="std std-ref">onlyImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-reason"><span class="std std-ref">reason scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">createAbsoluteSourceStamps</span></code> (optional)</p>
<blockquote>
<div><p>This option only has effect when using multiple codebases.
When <code class="docutils literal notranslate"><span class="pre">True</span></code>, it uses the last seen revision for each codebase that does not have a change.
When <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default), codebases without changes will use the revision from the <code class="docutils literal notranslate"><span class="pre">codebases</span></code> argument.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> (optional)</p>
<blockquote>
<div><p>If this is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then builds will be scheduled at the designated time only if the specified branch has seen an important change since the previous build.
If there is no previous build or the previous build was made when this option was <code class="docutils literal notranslate"><span class="pre">False</span></code> then the build will be scheduled even if there are no new changes.
By default this setting is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">periodicBuildTimer</span></code></p>
<blockquote>
<div><p>The time, in seconds, after which to start a build.</p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span>
<span class="n">nightly</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Periodic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">,</span>
                              <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;full-solaris&quot;</span><span class="p">],</span>
                              <span class="n">periodicBuildTimer</span><span class="o">=</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nightly</span><span class="p">]</span>
</pre></div>
</div>
<p>The scheduler in this example just runs the full solaris build once per day.
Note that this scheduler only lets you control the time between builds, not the absolute time-of-day of each Build, so this could easily wind up an <em>evening</em> or <em>every afternoon</em> scheduler depending upon when it was first activated.</p>
</section>
<section id="nightly-scheduler">
<span id="sched-Nightly"></span><span id="id6"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink">Nightly Scheduler</a><a class="headerlink" href="#nightly-scheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>This is highly configurable periodic build scheduler, which triggers a build at particular times of day, week, month, or year.
The configuration syntax is very similar to the well-known <code class="docutils literal notranslate"><span class="pre">crontab</span></code> format, in which you provide values for minute, hour, day, and month (some of which can be wildcards), and a build is triggered whenever the current time matches the given constraints.
This can run a build every night, every morning, every weekend, alternate Thursdays, on your boss‚Äôs birthday, etc.</p>
<p>Pass some subset of <code class="docutils literal notranslate"><span class="pre">minute</span></code>, <code class="docutils literal notranslate"><span class="pre">hour</span></code>, <code class="docutils literal notranslate"><span class="pre">dayOfMonth</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code>, and <code class="docutils literal notranslate"><span class="pre">dayOfWeek</span></code>; each may be a single number or a list of valid values.
The builds will be triggered whenever the current time matches these values.
Wildcards are represented by a ‚Äò*‚Äô string.
All fields default to a wildcard except ‚Äòminute‚Äô, so with no fields, this defaults to a build every hour, on the hour.
The full list of parameters is:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">fileIsImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-fileisimportant"><span class="std std-ref">fileIsImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">change_filter</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-changefilter"><span class="std std-ref">change_filter scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">onlyImportant</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-onlyimportant"><span class="std std-ref">onlyImportant scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-reason"><span class="std std-ref">reason scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">createAbsoluteSourceStamps</span></code> (optional)</p>
<blockquote>
<div><p>This option only has effect when using multiple codebases.
When <code class="docutils literal notranslate"><span class="pre">True</span></code>, it uses the last seen revision for each codebase that does not have a change.
When <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default), codebases without changes will use the revision from the <code class="docutils literal notranslate"><span class="pre">codebases</span></code> argument.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> (optional)</p>
<blockquote>
<div><p>If this is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then builds will not be scheduled at the designated time <em>unless</em> the change filter has accepted an important change since the previous build.
The default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">branch</span></code> (optional)</p>
<blockquote>
<div><p>(Deprecated; use <code class="docutils literal notranslate"><span class="pre">change_filter</span></code> and <code class="docutils literal notranslate"><span class="pre">codebases</span></code>.)
The branch to build when the time comes, and the branch to filter for if <code class="docutils literal notranslate"><span class="pre">change_filter</span></code> is not specified.
Remember that a value of <code class="docutils literal notranslate"><span class="pre">None</span></code> here means the default branch, and will not match other branches!</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">minute</span></code> (optional)</p>
<blockquote>
<div><p>The minute of the hour on which to start the build.
This defaults to 0, meaning an hourly build.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">hour</span></code> (optional)</p>
<blockquote>
<div><p>The hour of the day on which to start the build, in 24-hour notation.
This defaults to *, meaning every hour.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">dayOfMonth</span></code> (optional)</p>
<blockquote>
<div><p>The day of the month to start a build.
This defaults to <code class="docutils literal notranslate"><span class="pre">*</span></code>, meaning every day.
Use <code class="docutils literal notranslate"><span class="pre">L</span></code> to specify last day of the month.
Last day option respects leap years.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">month</span></code> (optional)</p>
<blockquote>
<div><p>The month in which to start the build, with January = 1.
This defaults to <code class="docutils literal notranslate"><span class="pre">*</span></code>, meaning every month. Month or month
range / list as standard C abbreviated name <code class="docutils literal notranslate"><span class="pre">jan-feb</span></code>, <code class="docutils literal notranslate"><span class="pre">jan,dec</span></code>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">dayOfWeek</span></code> (optional)</p>
<blockquote>
<div><p>The day of the week to start a build, with Monday = 0.
This defaults to <code class="docutils literal notranslate"><span class="pre">*</span></code>, meaning every day of the week or nth weekday of month.
Like first Monday of month <code class="docutils literal notranslate"><span class="pre">1#1</span></code>, last Monday of month <code class="docutils literal notranslate"><span class="pre">L1</span></code>,
Monday + Friday <code class="docutils literal notranslate"><span class="pre">mon,fri</span></code> or ranges Monday to Friday <code class="docutils literal notranslate"><span class="pre">mon-fri</span></code>.</p>
</div></blockquote>
<section id="forcing-builds-when-there-are-no-changes">
<h4>Forcing builds when there are no changes<a class="headerlink" href="#forcing-builds-when-there-are-no-changes" title="Link to this heading">ÔÉÅ</a></h4>
<p>Nightly scheduler supports scheduling builds even in there were no important changes and <code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> was set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
This is controlled by <code class="docutils literal notranslate"><span class="pre">force_at_*</span></code> parameters.
The feature is enabled if least one of them is set.</p>
<p>The time interval identified by <code class="docutils literal notranslate"><span class="pre">force_at_minute</span></code>, <code class="docutils literal notranslate"><span class="pre">force_at_hour</span></code>, <code class="docutils literal notranslate"><span class="pre">force_at_day_of_month</span></code>, <code class="docutils literal notranslate"><span class="pre">force_at_month</span></code> and <code class="docutils literal notranslate"><span class="pre">force_at_day_of_week</span></code> must be subset of time interval identified by <code class="docutils literal notranslate"><span class="pre">minute</span></code>, <code class="docutils literal notranslate"><span class="pre">hour</span></code>, <code class="docutils literal notranslate"><span class="pre">dayOfMonth</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code>, <code class="docutils literal notranslate"><span class="pre">dayOfWeek</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">force_at_minute</span></code> (optional)</p>
<blockquote>
<div><p>The minute of the hour on which to start the build even if there were no important changes and <code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> was set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">None</span></code> meaning this feature is disabled.
If the feature is enabled by setting another <code class="docutils literal notranslate"><span class="pre">force_at_*</span></code> parameter, then the default value is <code class="docutils literal notranslate"><span class="pre">0</span></code> meaning builds will run every hour.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">force_at_hour</span></code> (optional)</p>
<blockquote>
<div><p>The hour of the day on which to start the build even if there were no important changes and <code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> was set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">None</span></code> meaning this feature is disabled.
If the feature is enabled by setting another <code class="docutils literal notranslate"><span class="pre">force_at_*</span></code> parameter, then the default value is <code class="docutils literal notranslate"><span class="pre">*</span></code> meaning builds will run each hour.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">force_at_day_of_month</span></code> (optional)</p>
<blockquote>
<div><p>The day of the month on which to start the build even if there were no important changes and <code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> was set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">None</span></code> meaning this feature is disabled.
If the feature is enabled by setting another <code class="docutils literal notranslate"><span class="pre">force_at_*</span></code> parameter, then the default value is <code class="docutils literal notranslate"><span class="pre">*</span></code> meaning builds will run each day.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">force_at_month</span></code> (optional)</p>
<blockquote>
<div><p>The month of the year on which to start the build even if there were no important changes and <code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> was set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">None</span></code> meaning this feature is disabled.
If the feature is enabled by setting another <code class="docutils literal notranslate"><span class="pre">force_at_*</span></code> parameter, then the default value is <code class="docutils literal notranslate"><span class="pre">*</span></code> meaning builds will run each month.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">force_at_day_of_week</span></code> (optional)</p>
<blockquote>
<div><p>The day of the week on which to start the build even if there were no important changes and <code class="docutils literal notranslate"><span class="pre">onlyIfChanged</span></code> was set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">None</span></code> meaning this feature is disabled.
If the feature is enabled by setting another <code class="docutils literal notranslate"><span class="pre">force_at_*</span></code> parameter, then the default value is <code class="docutils literal notranslate"><span class="pre">*</span></code> meaning builds will run each day of the week.</p>
</div></blockquote>
</section>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Link to this heading">ÔÉÅ</a></h4>
<p>For example, the following <code class="file docutils literal notranslate"><span class="pre">master.cfg</span></code> clause will cause a build to be started every night at 3:00am:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span><span class="p">,</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">schedulers</span><span class="o">.</span><span class="n">Nightly</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;nightly&#39;</span><span class="p">,</span>
                       <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">),</span>
                       <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;builder1&#39;</span><span class="p">,</span> <span class="s1">&#39;builder2&#39;</span><span class="p">],</span>
                       <span class="n">hour</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>This scheduler will perform a build each Monday morning at 6:23am and again at 8:23am, but only if someone has committed code in the interim:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">schedulers</span><span class="o">.</span><span class="n">Nightly</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;BeforeWork&#39;</span><span class="p">,</span>
                       <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">),</span>
                       <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;builder1&#39;</span><span class="p">],</span>
                       <span class="n">dayOfWeek</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">minute</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span>
                       <span class="n">onlyIfChanged</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>The following runs a build every two hours, using Python‚Äôs <code class="xref py py-func docutils literal notranslate"><span class="pre">range</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">schedulers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">schedulers</span><span class="o">.</span><span class="n">Nightly</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;every2hours&#39;</span><span class="p">,</span>
                       <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># default branch</span>
                       <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;builder1&#39;</span><span class="p">],</span>
                       <span class="n">hour</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>Finally, this example will run only on December 24th:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">schedulers</span><span class="o">.</span><span class="n">Nightly</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;SleighPreflightCheck&#39;</span><span class="p">,</span>
                       <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># default branch</span>
                       <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flying_circuits&#39;</span><span class="p">,</span> <span class="s1">&#39;radar&#39;</span><span class="p">],</span>
                       <span class="n">month</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                       <span class="n">dayOfMonth</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                       <span class="n">hour</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                       <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="try-schedulers">
<span id="sched-Try_Userpass"></span><span id="sched-Try_Jobdir"></span><span id="id7"></span><h3><a class="toc-backref" href="#id19" role="doc-backlink">Try Schedulers</a><a class="headerlink" href="#try-schedulers" title="Link to this heading">ÔÉÅ</a></h3>
<p>This scheduler allows developers to use the <a class="reference internal" href="../cmdline.html#cmdline-try" title="try"><code class="xref bb bb-cmdline docutils literal notranslate"><span class="pre">buildbot</span> <span class="pre">try</span></code></a> command to trigger builds of code they have not yet committed.
See <a class="reference internal" href="../cmdline.html#cmdline-try" title="try"><code class="xref bb bb-cmdline docutils literal notranslate"><span class="pre">try</span></code></a> for complete details.</p>
<p>Two implementations are available: <a class="reference internal" href="#sched-Try_Jobdir" title="Try_Jobdir"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Try_Jobdir</span></code></a> and <a class="reference internal" href="#sched-Try_Userpass" title="Try_Userpass"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Try_Userpass</span></code></a>.
The former monitors a job directory, specified by the <code class="docutils literal notranslate"><span class="pre">jobdir</span></code> parameter, while the latter listens for PB connections on a specific <code class="docutils literal notranslate"><span class="pre">port</span></code>, and authenticates against <code class="docutils literal notranslate"><span class="pre">userport</span></code>.</p>
<p>The buildmaster must have a scheduler instance in the config file‚Äôs <a class="reference internal" href="#cfg-schedulers" title="schedulers"><code class="xref bb bb-cfg docutils literal notranslate"><span class="pre">schedulers</span></code></a> list to receive try requests.
This lets the administrator control who may initiate these <cite>trial</cite> builds, which branches are eligible for trial builds, and which Builders should be used for them.</p>
<p>The scheduler has various means to accept build requests.
All of them enforce more security than the usual buildmaster ports do.
Any source code being built can be used to compromise the worker accounts, but in general that code must be checked out from the VC repository first, so only people with commit privileges can get control of the workers.
The usual force-build control channels can waste worker time but do not allow arbitrary commands to be executed by people who don‚Äôt have those commit privileges.
However, the source code patch that is provided with the trial build does not have to go through the VC system first, so it is important to make sure these builds cannot be abused by a non-committer to acquire as much control over the workers as a committer has.
Ideally, only developers who have commit access to the VC repository would be able to start trial builds, but unfortunately, the buildmaster does not, in general, have access to the VC system‚Äôs user list.</p>
<p>As a result, the try scheduler requires a bit more configuration.
There are currently two ways to set this up:</p>
<p><code class="docutils literal notranslate"><span class="pre">jobdir</span></code> (ssh)</p>
<blockquote>
<div><p>This approach creates a command queue directory, called the <code class="file docutils literal notranslate"><span class="pre">jobdir</span></code>, in the buildmaster‚Äôs working directory.
The buildmaster admin sets the ownership and permissions of this directory to only grant write access to the desired set of developers, all of whom must have accounts on the machine.
The <strong class="command">buildbot try</strong> command creates a special file containing the source stamp information and drops it in the jobdir, just like a standard maildir.
When the buildmaster notices the new file, it unpacks the information inside and starts the builds.</p>
<p>The config file entries used by ‚Äòbuildbot try‚Äô either specify a local queuedir (for which write and mv are used) or a remote one (using scp and ssh).</p>
<p>The advantage of this scheme is that it is quite secure, the disadvantage is that it requires fiddling outside the buildmaster config (to set the permissions on the jobdir correctly).
If the buildmaster machine happens to also house the VC repository, then it can be fairly easy to keep the VC userlist in sync with the trial-build userlist.
If they are on different machines, this will be much more of a hassle.
It may also involve granting developer accounts on a machine that would not otherwise require them.</p>
<p>To implement this, the worker invokes <code class="samp docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-l</span> <em><span class="pre">username</span></em> <em><span class="pre">host</span></em> <span class="pre">buildbot</span> <span class="pre">tryserver</span> <em><span class="pre">ARGS</span></em></code>, passing the patch contents over stdin.
The arguments must include the inlet directory and the revision information.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">user+password</span></code> (PB)</p>
<blockquote>
<div><p>In this approach, each developer gets a username/password pair, which are all listed in the buildmaster‚Äôs configuration file.
When the developer runs <strong class="command">buildbot try</strong>, their machine connects to the buildmaster via PB and authenticates themselves using that username and password, then sends a PB command to start the trial build.</p>
<p>The advantage of this scheme is that the entire configuration is performed inside the buildmaster‚Äôs config file.
The disadvantages are that it is less secure (while the <cite>cred</cite> authentication system does not expose the password in plaintext over the wire, it does not offer most of the other security properties that SSH does).
In addition, the buildmaster admin is responsible for maintaining the username/password list, adding and deleting entries as developers come and go.</p>
</div></blockquote>
<p>For example, to set up the <cite>jobdir</cite> style of trial build, using a command queue directory of <code class="file docutils literal notranslate"><em><span class="pre">MASTERDIR</span></em><span class="pre">/jobdir</span></code> (and assuming that all your project developers were members of the <code class="docutils literal notranslate"><span class="pre">developers</span></code> unix group), you would first set up that directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>MASTERDIR/jobdir<span class="w"> </span>MASTERDIR/jobdir/new<span class="w"> </span>MASTERDIR/jobdir/cur<span class="w"> </span>MASTERDIR/jobdir/tmp
chgrp<span class="w"> </span>developers<span class="w"> </span>MASTERDIR/jobdir<span class="w"> </span>MASTERDIR/jobdir/*
chmod<span class="w"> </span>g+rwx,o-rwx<span class="w"> </span>MASTERDIR/jobdir<span class="w"> </span>MASTERDIR/jobdir/*
</pre></div>
</div>
<p>and then use the following scheduler in the buildmaster‚Äôs config file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Try_Jobdir</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;try1&quot;</span><span class="p">,</span>
                          <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;full-linux&quot;</span><span class="p">,</span> <span class="s2">&quot;full-netbsd&quot;</span><span class="p">,</span> <span class="s2">&quot;full-OSX&quot;</span><span class="p">],</span>
                          <span class="n">jobdir</span><span class="o">=</span><span class="s2">&quot;jobdir&quot;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that you must create the jobdir before telling the buildmaster to use this configuration, otherwise you will get an error.
Also remember that the buildmaster must be able to read and write to the jobdir as well.
Be sure to watch the <code class="file docutils literal notranslate"><span class="pre">twistd.log</span></code> file (<a class="reference internal" href="../installation/misc.html#logfiles"><span class="std std-ref">Logfiles</span></a>) as you start using the jobdir, to make sure the buildmaster is happy with it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Patches in the jobdir are encoded using netstrings, which place an arbitrary upper limit on patch size of 99999 bytes.
If your submitted try jobs are rejected with <cite>BadJobfile</cite>, try increasing this limit with a snippet like this in your <cite>master.cfg</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.protocols.basic</span> <span class="kn">import</span> <span class="n">NetstringReceiver</span>
<span class="n">NetstringReceiver</span><span class="o">.</span><span class="n">MAX_LENGTH</span> <span class="o">=</span> <span class="mi">1000000</span>
</pre></div>
</div>
</div>
<p>To use the username/password form of authentication, create a <code class="xref py py-class docutils literal notranslate"><span class="pre">Try_Userpass</span></code> instance instead.
It takes the same <code class="docutils literal notranslate"><span class="pre">builderNames</span></code> argument as the <code class="xref py py-class docutils literal notranslate"><span class="pre">Try_Jobdir</span></code> form, but accepts an additional <code class="docutils literal notranslate"><span class="pre">port</span></code> argument (to specify the TCP port to listen on) and a <code class="docutils literal notranslate"><span class="pre">userpass</span></code> list of username/password pairs to accept.
Remember to use good passwords for this: the security of the worker accounts depends upon it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Try_Userpass</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;try2&quot;</span><span class="p">,</span>
                            <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;full-linux&quot;</span><span class="p">,</span> <span class="s2">&quot;full-netbsd&quot;</span><span class="p">,</span> <span class="s2">&quot;full-OSX&quot;</span><span class="p">],</span>
                            <span class="n">port</span><span class="o">=</span><span class="mi">8031</span><span class="p">,</span>
                            <span class="n">userpass</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span><span class="s2">&quot;pw1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;bob&quot;</span><span class="p">,</span> <span class="s2">&quot;pw2&quot;</span><span class="p">)])</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
</pre></div>
</div>
<p>Like in most classes in Buildbot, the <code class="docutils literal notranslate"><span class="pre">port</span></code> argument takes a <cite>strports</cite> specification.
See <code class="xref py py-mod docutils literal notranslate"><span class="pre">twisted.application.strports</span></code> for details.</p>
</section>
<section id="triggerable-scheduler">
<span id="index-1"></span><span id="sched-Triggerable"></span><span id="id8"></span><h3><a class="toc-backref" href="#id20" role="doc-backlink">Triggerable Scheduler</a><a class="headerlink" href="#triggerable-scheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>The <a class="reference internal" href="#sched-Triggerable" title="Triggerable"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Triggerable</span></code></a> scheduler waits to be triggered by a <a class="reference internal" href="steps/trigger.html#step-Trigger" title="Trigger"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">Trigger</span></code></a> step (see <a class="reference internal" href="steps/trigger.html#step-trigger"><span class="std std-ref">Trigger</span></a>) in another build.
That step can optionally wait for the scheduler‚Äôs builds to complete.
This provides two advantages over <a class="reference internal" href="#sched-Dependent" title="Dependent"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Dependent</span></code></a> schedulers.
First, the same scheduler can be triggered from multiple builds.
Second, the ability to wait for <a class="reference internal" href="#sched-Triggerable" title="Triggerable"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Triggerable</span></code></a>‚Äôs builds to complete provides a form of ‚Äúsubroutine call‚Äù, where one or more builds can ‚Äúcall‚Äù a scheduler to perform some work for them, perhaps on other workers.
The <a class="reference internal" href="#sched-Triggerable" title="Triggerable"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Triggerable</span></code></a> scheduler supports multiple codebases.
The scheduler filters out all codebases from <a class="reference internal" href="steps/trigger.html#step-Trigger" title="Trigger"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">Trigger</span></code></a> steps that are not configured in the scheduler.</p>
<p>The parameters are just the basics:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-reason"><span class="std std-ref">reason scheduler argument</span></a>.</p>
</div></blockquote>
<p>This class is only useful in conjunction with the <a class="reference internal" href="steps/trigger.html#step-Trigger" title="Trigger"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">Trigger</span></code></a> step.
Here is a fully-worked example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">util</span>

<span class="n">checkin</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">SingleBranchScheduler</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;checkin&quot;</span><span class="p">,</span>
                                           <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                                           <span class="n">treeStableTimer</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span>
                                           <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;checkin&quot;</span><span class="p">])</span>
<span class="n">nightly</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Nightly</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;nightly&#39;</span><span class="p">,</span>
                             <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                             <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nightly&#39;</span><span class="p">],</span>
                             <span class="n">hour</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mktarball</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Triggerable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;mktarball&quot;</span><span class="p">,</span> <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mktarball&quot;</span><span class="p">])</span>
<span class="n">build</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Triggerable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;build-all-platforms&quot;</span><span class="p">,</span>
                               <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;build-all-platforms&quot;</span><span class="p">])</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Triggerable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;distributed-test&quot;</span><span class="p">,</span>
                              <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;distributed-test&quot;</span><span class="p">])</span>
<span class="n">package</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">Triggerable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;package-all-platforms&quot;</span><span class="p">,</span>
                                 <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;package-all-platforms&quot;</span><span class="p">])</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mktarball</span><span class="p">,</span> <span class="n">checkin</span><span class="p">,</span> <span class="n">nightly</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">package</span><span class="p">]</span>

<span class="c1"># on checkin, make a tarball, build it, and test it</span>
<span class="n">checkin_factory</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuildFactory</span><span class="p">()</span>
<span class="n">checkin_factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mktarball&#39;</span><span class="p">],</span>
                                      <span class="n">waitForFinish</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">checkin_factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;build-all-platforms&#39;</span><span class="p">],</span>
                                      <span class="n">waitForFinish</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">checkin_factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;distributed-test&#39;</span><span class="p">],</span>
                                      <span class="n">waitForFinish</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># and every night, make a tarball, build it, and package it</span>
<span class="n">nightly_factory</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuildFactory</span><span class="p">()</span>
<span class="n">nightly_factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mktarball&#39;</span><span class="p">],</span>
                                      <span class="n">waitForFinish</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">nightly_factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;build-all-platforms&#39;</span><span class="p">],</span>
                                      <span class="n">waitForFinish</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">nightly_factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;package-all-platforms&#39;</span><span class="p">],</span>
                                      <span class="n">waitForFinish</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="nightlytriggerable-scheduler">
<span id="sched-NightlyTriggerable"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink">NightlyTriggerable Scheduler</a><a class="headerlink" href="#nightlytriggerable-scheduler" title="Link to this heading">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.schedulers.timed.NightlyTriggerable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.schedulers.timed.</span></span><span class="sig-name descname"><span class="pre">NightlyTriggerable</span></span><a class="headerlink" href="#buildbot.schedulers.timed.NightlyTriggerable" title="Link to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<p>The <a class="reference internal" href="#sched-NightlyTriggerable" title="NightlyTriggerable"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">NightlyTriggerable</span></code></a> scheduler is a mix of the <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a> and <a class="reference internal" href="#sched-Triggerable" title="Triggerable"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Triggerable</span></code></a> schedulers.
This scheduler triggers builds at a particular time of day, week, or year, exactly as the <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a> scheduler.
However, the source stamp set that is used is provided by the last <a class="reference internal" href="steps/trigger.html#step-Trigger" title="Trigger"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">Trigger</span></code></a> step that targeted this scheduler.</p>
<p>The following parameters are just the basics:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-properties"><span class="std std-ref">properties scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-codebases"><span class="std std-ref">codebases scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-reason"><span class="std std-ref">reason scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">minute</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">hour</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">dayOfMonth</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">month</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">dayOfWeek</span></code> (optional)</p>
<blockquote>
<div><p>See <a class="reference internal" href="#sched-Nightly" title="Nightly"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">Nightly</span></code></a>.</p>
</div></blockquote>
<p>This class is only useful in conjunction with the <a class="reference internal" href="steps/trigger.html#step-Trigger" title="Trigger"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">Trigger</span></code></a> step.
Note that <code class="docutils literal notranslate"><span class="pre">waitForFinish</span></code> is ignored by <a class="reference internal" href="steps/trigger.html#step-Trigger" title="Trigger"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">Trigger</span></code></a> steps targeting this scheduler.</p>
<p>Here is a fully-worked example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">util</span>

<span class="n">checkin</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">SingleBranchScheduler</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;checkin&quot;</span><span class="p">,</span>
                                           <span class="n">change_filter</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChangeFilter</span><span class="p">(</span><span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                                           <span class="n">treeStableTimer</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span>
                                           <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;checkin&quot;</span><span class="p">])</span>
<span class="n">nightly</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">NightlyTriggerable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;nightly&#39;</span><span class="p">,</span>
                                        <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nightly&#39;</span><span class="p">],</span>
                                        <span class="n">hour</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">checkin</span><span class="p">,</span> <span class="n">nightly</span><span class="p">]</span>

<span class="c1"># on checkin, run tests</span>
<span class="n">checkin_factory</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuildFactory</span><span class="p">([</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">Test</span><span class="p">(),</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">Trigger</span><span class="p">(</span><span class="n">schedulerNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nightly&#39;</span><span class="p">])</span>
<span class="p">])</span>

<span class="c1"># and every night, package the latest successful build</span>
<span class="n">nightly_factory</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuildFactory</span><span class="p">([</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">ShellCommand</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;make&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">])</span>
<span class="p">])</span>
</pre></div>
</div>
</section>
<section id="forcescheduler-scheduler">
<span id="index-2"></span><span id="sched-ForceScheduler"></span><h3><a class="toc-backref" href="#id22" role="doc-backlink">ForceScheduler Scheduler</a><a class="headerlink" href="#forcescheduler-scheduler" title="Link to this heading">ÔÉÅ</a></h3>
<p>The <a class="reference internal" href="#sched-ForceScheduler" title="ForceScheduler"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">ForceScheduler</span></code></a> scheduler is the way you can configure a force build form in the web UI.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">/#/builders/:builderid</span></code> web page, you will see, on the top right of the page, one button for each <a class="reference internal" href="#sched-ForceScheduler" title="ForceScheduler"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">ForceScheduler</span></code></a> scheduler that was configured for this builder.
If you click on that button, a dialog will let you choose various parameters for requesting a new build.</p>
<p>The Buildbot framework allows you to customize exactly how the build form looks, which builders have a force build form (it might not make sense to force build every builder), and who is allowed to force builds on which builders.</p>
<p>You do so by configuring a <a class="reference internal" href="#sched-ForceScheduler" title="ForceScheduler"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">ForceScheduler</span></code></a> and adding it to the list of <a class="reference internal" href="#cfg-schedulers" title="schedulers"><code class="xref bb bb-cfg docutils literal notranslate"><span class="pre">schedulers</span></code></a>.</p>
<p>The scheduler takes the following parameters:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<blockquote>
<div><p>See <a class="reference internal" href="#scheduler-attr-name"><span class="std std-ref">name scheduler argument</span></a>.
Force buttons are ordered by this property in the UI (so you can prefix by 01, 02, etc, in order to control precisely the order).</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">builderNames</span></code></p>
<blockquote>
<div><p>List of builders where the force button should appear.
See <a class="reference internal" href="#scheduler-attr-buildernames"><span class="std std-ref">builderNames scheduler argument</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reason</span></code></p>
<blockquote>
<div><p>A <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameter</span></a> allowing the user to specify the reason for the build.
The default value is a string parameter with a default value ‚Äúforce build‚Äù.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">reasonString</span></code></p>
<blockquote>
<div><p>A string that will be used to create the build reason for the forced build.
This string can contain the placeholders <code class="docutils literal notranslate"><span class="pre">%(owner)s</span></code> and <code class="docutils literal notranslate"><span class="pre">%(reason)s</span></code>, which represents the value typed into the reason field.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">username</span></code></p>
<blockquote>
<div><p>A <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameter</span></a> specifying the username associated with the build (aka owner).
The default value is a username parameter.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">codebases</span></code></p>
<blockquote>
<div><p>A list of strings or <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">CodebaseParameter</span></a> specifying the codebases that should be presented.
The default is a single codebase with no name (i.e. <cite>codebases=[‚Äò‚Äô]</cite>).</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p>
<blockquote>
<div><p>A list of <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameters</span></a>, one for each property.
These can be arbitrary parameters, where the parameter‚Äôs name is taken as the property name, or <code class="docutils literal notranslate"><span class="pre">AnyPropertyParameter</span></code>, which allows the web user to specify the property name.
The default value is an empty list.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">buttonName</span></code></p>
<blockquote>
<div><p>The name of the ‚Äúsubmit‚Äù button on the resulting force-build form.
This defaults to the name of scheduler.</p>
</div></blockquote>
<p>An example may be better than long explanation.
What you need in your config file is something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">schedulers</span><span class="p">,</span> <span class="n">util</span>

<span class="n">sch</span> <span class="o">=</span> <span class="n">schedulers</span><span class="o">.</span><span class="n">ForceScheduler</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;force&quot;</span><span class="p">,</span>
    <span class="n">buttonName</span><span class="o">=</span><span class="s2">&quot;pushMe!&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;My nice Force form&quot;</span><span class="p">,</span>
    <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;my-builder&quot;</span><span class="p">],</span>

    <span class="n">codebases</span><span class="o">=</span><span class="p">[</span>
        <span class="n">util</span><span class="o">.</span><span class="n">CodebaseParameter</span><span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Main repository&quot;</span><span class="p">,</span>
            <span class="c1"># will generate a combo box</span>
            <span class="n">branch</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChoiceStringParameter</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span>
                <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="s2">&quot;hest&quot;</span><span class="p">],</span>
                <span class="n">default</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">),</span>

            <span class="c1"># will generate nothing in the form, but revision, repository,</span>
            <span class="c1"># and project are needed by buildbot scheduling system so we</span>
            <span class="c1"># need to pass a value (&quot;&quot;)</span>
            <span class="n">revision</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">FixedParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;revision&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">repository</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">FixedParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;repository&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">project</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">FixedParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;project&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">],</span>

    <span class="c1"># will generate a text input</span>
    <span class="n">reason</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">StringParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;reason:&quot;</span><span class="p">,</span>
                                <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>

    <span class="c1"># in case you don&#39;t require authentication, this will display</span>
    <span class="c1"># input for user to type their name</span>
    <span class="n">username</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">UserNameParameter</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;your name:&quot;</span><span class="p">,</span>
                                    <span class="n">size</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
    <span class="c1"># A completely customized property list.  The name of the</span>
    <span class="c1"># property is the name of the parameter</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">[</span>
        <span class="n">util</span><span class="o">.</span><span class="n">NestedParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Build Options&quot;</span><span class="p">,</span>
                             <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
            <span class="n">util</span><span class="o">.</span><span class="n">StringParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pull_url&quot;</span><span class="p">,</span>
                                 <span class="n">label</span><span class="o">=</span><span class="s2">&quot;optionally give a public Git pull url:&quot;</span><span class="p">,</span>
                                 <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
            <span class="n">util</span><span class="o">.</span><span class="n">BooleanParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;force_build_clean&quot;</span><span class="p">,</span>
                                  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;force a make clean&quot;</span><span class="p">,</span>
                                  <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">])</span>
</pre></div>
</div>
<p>This will result in the following UI:</p>
<img alt="Force Form Result" src="../../_images/forcedialog1.png" />
<section id="authorization">
<h4>Authorization<a class="headerlink" href="#authorization" title="Link to this heading">ÔÉÅ</a></h4>
<p>The force scheduler uses the web interface‚Äôs authorization framework to determine which user has the right to force which build.
Here is an example of code on how you can define which user has which right:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;project1-builder&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;project1-maintainer&quot;</span><span class="p">,</span> <span class="s2">&quot;john&quot;</span><span class="p">]</span> <span class="p">,</span>
    <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;project2-builder&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;project2-maintainer&quot;</span><span class="p">,</span> <span class="s2">&quot;jack&quot;</span><span class="p">],</span>
    <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;.*&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;root&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="k">def</span> <span class="nf">force_auth</span><span class="p">(</span><span class="n">user</span><span class="p">,</span>  <span class="n">status</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">user_mapping</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">users</span> <span class="ow">in</span> <span class="n">user_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># use authz_cfg in your WebStatus setup</span>
<span class="n">authz_cfg</span><span class="o">=</span><span class="n">authz</span><span class="o">.</span><span class="n">Authz</span><span class="p">(</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">my_auth</span><span class="p">,</span>
    <span class="n">forceBuild</span> <span class="o">=</span> <span class="n">force_auth</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="forcescheduler-parameters">
<span id="id9"></span><h4>ForceScheduler Parameters<a class="headerlink" href="#forcescheduler-parameters" title="Link to this heading">ÔÉÅ</a></h4>
<p>Most of the arguments to <a class="reference internal" href="#sched-ForceScheduler" title="ForceScheduler"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">ForceScheduler</span></code></a> are ‚Äúparameters‚Äù.
Several classes of parameters are available, each describing a different kind of input from a force-build form.</p>
<p>All parameter types have a few common arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code> (required)</p>
<blockquote>
<div><p>The name of the parameter.
For properties, this will correspond to the name of the property that your parameter will set.
The name is also used internally as the identifier for in the HTML form.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">label</span></code> (optional; default is same as name)</p>
<blockquote>
<div><p>The label of the parameter.
This is what is displayed to the user.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">tablabel</span></code> (optional; default is same as label)</p>
<blockquote>
<div><p>The label of the tab if this parameter is included into a tab layout NestedParameter.
This is what is displayed to the user.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">default</span></code> (optional; default: ‚Äú‚Äù)</p>
<blockquote>
<div><p>The default value for the parameter that is used if there is no user input.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">required</span></code> (optional; default: False)</p>
<blockquote>
<div><p>If this is true, then an error will be shown to user if there is no input in this field</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">maxsize</span></code> (optional; default: None)</p>
<blockquote>
<div><p>The maximum size of a field (in bytes).
Buildbot will ensure the field sent by the user is not too large.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">autopopulate</span></code> (optional; default: None)</p>
<blockquote>
<div><p>If not None, <code class="docutils literal notranslate"><span class="pre">autopopulate</span></code> is a dictionary which describes how other parameters are updated if this one changes.
This is useful for when you have lots of parameters, and defaults depends on e.g. the branch.
This is implemented generically, and all parameters can update others.
Beware of infinite loops!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">schedulers</span><span class="o">.</span><span class="n">ForceScheduler</span><span class="p">(</span>
<span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom&quot;</span><span class="p">,</span>
<span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;runtests&quot;</span><span class="p">],</span>
<span class="n">buttonName</span><span class="o">=</span><span class="s2">&quot;Start Custom Build&quot;</span><span class="p">,</span>
<span class="n">codebases</span> <span class="o">=</span> <span class="p">[</span><span class="n">util</span><span class="o">.</span><span class="n">CodebaseParameter</span><span class="p">(</span>
    <span class="n">codebase</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">branch</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">ChoiceStringParameter</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Branch&quot;</span><span class="p">,</span>
        <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="s2">&quot;dev&quot;</span><span class="p">],</span>
        <span class="n">autopopulate</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;master&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;build_name&#39;</span><span class="p">:</span> <span class="s1">&#39;build for master branch&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;dev&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;build_name&#39;</span><span class="p">:</span> <span class="s1">&#39;build for dev branch&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="p">}</span>
<span class="p">))],</span>
<span class="n">properties</span><span class="o">=</span><span class="p">[</span>
    <span class="n">util</span><span class="o">.</span><span class="n">StringParameter</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;build_name&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Name of the Build release.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)]))</span>  <span class="c1"># this parameter will be auto populated when user chooses branch</span>
</pre></div>
</div>
</div></blockquote>
<p>The parameter types are:</p>
<section id="nestedparameter">
<span id="sched-NestedParameter"></span><h5>NestedParameter<a class="headerlink" href="#nestedparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NestedParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Build options&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">]),</span>
</pre></div>
</div>
<p>This parameter type is a special parameter which contains other parameters.
This can be used to group a set of parameters together, and define the layout of your form.
You can recursively include NestedParameter into NestedParameter, to build very complex UIs.</p>
<p>It adds the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">layout</span></code> (optional, default is ‚Äúvertical‚Äù)</p>
<blockquote>
<div><p>The layout defines how the fields are placed in the form.</p>
<p>The layouts implemented in the standard web application are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">simple</span></code>: fields are displayed one by one without alignment.</p>
<blockquote>
<div><p>They take the horizontal space that they need.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">vertical</span></code>: all fields are displayed vertically, aligned in columns (as per the <code class="docutils literal notranslate"><span class="pre">column</span></code> attribute of the NestedParameter)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tabs</span></code>: each field gets its own <a class="reference external" href="https://getbootstrap.com/components/">tab</a>.</p>
<blockquote>
<div><p>This can be used to declare complex build forms which won‚Äôt fit into one screen.
The children fields are usually other NestedParameters with vertical layout.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">columns</span></code> (optional, accepted values are 1, 2, 3, 4)</p>
<blockquote>
<div><p>The number of columns to use for a <cite>vertical</cite> layout.
If omitted, it is set to 1 unless there are more than 3 visible child fields in which case it is set to 2.</p>
</div></blockquote>
</section>
<section id="fixedparameter">
<h5>FixedParameter<a class="headerlink" href="#fixedparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">FixedParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;trunk&quot;</span><span class="p">),</span>
</pre></div>
</div>
<p>This parameter type will not be shown on the web form and always generates a property with its default value.</p>
</section>
<section id="stringparameter">
<h5>StringParameter<a class="headerlink" href="#stringparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">StringParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pull_url&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;optionally give a public Git pull url:&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
<p>This parameter type will show a single-line text-entry box, and allow the user to enter an arbitrary string.
It adds the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">regex</span></code> (optional)</p>
<blockquote>
<div><p>A string that will be compiled as a regex and used to validate the input of this parameter.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">size</span></code> (optional; default is 10)</p>
<blockquote>
<div><p>The width of the input field (in characters).</p>
</div></blockquote>
</section>
<section id="textparameter">
<h5>TextParameter<a class="headerlink" href="#textparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TextParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;comments&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;comments to be displayed to the user of the built binary&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;This is a development build&quot;</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>This parameter type is similar to StringParameter, except that it is represented in the HTML form as a <code class="docutils literal notranslate"><span class="pre">textarea</span></code>, allowing multi-line input.
It adds the StringParameter arguments and the following ones:</p>
<p><code class="docutils literal notranslate"><span class="pre">cols</span></code> (optional; default is 80)</p>
<blockquote>
<div><p>The number of columns the <code class="docutils literal notranslate"><span class="pre">textarea</span></code> will have.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">rows</span></code> (optional; default is 20)</p>
<blockquote>
<div><p>The number of rows the <code class="docutils literal notranslate"><span class="pre">textarea</span></code> will have.</p>
</div></blockquote>
<p>This class could be subclassed to have more customization, e.g.</p>
<ul class="simple">
<li><p>developer could send a list of Git branches to pull from</p></li>
<li><p>developer could send a list of Gerrit changes to cherry-pick,</p></li>
<li><p>developer could send a shell script to amend the build.</p></li>
</ul>
<p>Beware of security issues anyway.</p>
</section>
<section id="intparameter">
<h5>IntParameter<a class="headerlink" href="#intparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">IntParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;debug_level&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;debug level (1-10)&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>This parameter type accepts an integer value using a text-entry box.</p>
</section>
<section id="booleanparameter">
<h5>BooleanParameter<a class="headerlink" href="#booleanparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BooleanParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;force_build_clean&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;force a make clean&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This type represents a boolean value.
It will be presented as a checkbox.</p>
</section>
<section id="usernameparameter">
<h5>UserNameParameter<a class="headerlink" href="#usernameparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UserNameParameter</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;your name:&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
<p>This parameter type accepts a username.
If authentication is active, it will use the authenticated user instead of displaying a text-entry box.</p>
<p><code class="docutils literal notranslate"><span class="pre">size</span></code> (optional; default is 10)</p>
<blockquote>
<div><p>The width of the input field (in characters).</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">need_email</span></code> (optional; default is True)</p>
<blockquote>
<div><p>If true, requires a full email address rather than arbitrary text.</p>
</div></blockquote>
</section>
<section id="choicestringparameter">
<span id="sched-ChoiceStringParameter"></span><h5>ChoiceStringParameter<a class="headerlink" href="#choicestringparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ChoiceStringParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span>
    <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">,</span><span class="s2">&quot;devel&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;main&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This parameter type lets the user choose between several choices (e.g. the list of branches you are supporting, or the test campaign to run).
If <code class="docutils literal notranslate"><span class="pre">multiple</span></code> is false, then its result is a string with one of the choices.
If <code class="docutils literal notranslate"><span class="pre">multiple</span></code> is true, then the result is a list of strings from the choices.</p>
<p>Note that for some use cases, the choices need to be generated dynamically.
This can be done via subclassing and overriding the ‚ÄògetChoices‚Äô member function.
An example of this is provided by the source for the <code class="xref py py-class docutils literal notranslate"><span class="pre">InheritBuildParameter</span></code> class.</p>
<p>Its arguments, in addition to the common options, are:</p>
<p><code class="docutils literal notranslate"><span class="pre">choices</span></code></p>
<blockquote>
<div><p>The list of available choices.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">strict</span></code> (optional; default is True)</p>
<blockquote>
<div><p>If true, verify that the user‚Äôs input is from the list.
Note that this only affects the validation of the form request; even if this argument is False, there is no HTML form component available to enter an arbitrary value.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">multiple</span></code></p>
<blockquote>
<div><p>If true, then the user may select multiple choices.</p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ChoiceStringParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;forced_tests&quot;</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="s2">&quot;smoke test campaign to run&quot;</span><span class="p">,</span>
                      <span class="n">default</span><span class="o">=</span><span class="n">default_tests</span><span class="p">,</span>
                      <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;test_builder1&quot;</span><span class="p">,</span> <span class="s2">&quot;test_builder2&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;test_builder3&quot;</span><span class="p">])</span>

<span class="c1"># .. and later base the schedulers to trigger off this property:</span>

<span class="c1"># triggers the tests depending on the property forced_test</span>
<span class="n">builder1</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">Trigger</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Trigger tests&quot;</span><span class="p">,</span>
                                <span class="n">schedulerNames</span><span class="o">=</span><span class="n">Property</span><span class="p">(</span><span class="s2">&quot;forced_tests&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>Example of scheduler allowing to choose which worker to run on:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;worker1&quot;</span><span class="p">,</span> <span class="s2">&quot;worker2&quot;</span><span class="p">,</span> <span class="s2">&quot;worker3&quot;</span><span class="p">]</span>
<span class="n">ChoiceStringParameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;worker&quot;</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="s2">&quot;worker to run the build on&quot;</span><span class="p">,</span>
                      <span class="n">default</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
                      <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">choices</span><span class="o">=</span><span class="n">worker_list</span><span class="p">)</span>

<span class="c1"># .. and in nextWorker, use this property:</span>
<span class="k">def</span> <span class="nf">nextWorker</span><span class="p">(</span><span class="n">bldr</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">buildrequest</span><span class="p">):</span>
    <span class="n">forced_worker</span> <span class="o">=</span> <span class="n">buildrequest</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s2">&quot;worker&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">forced_worker</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">workers</span><span class="p">)</span> <span class="k">if</span> <span class="n">workers</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">workername</span> <span class="o">==</span> <span class="n">forced_worker</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span>
    <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># worker not yet available</span>

<span class="n">c</span><span class="p">[</span><span class="s1">&#39;builders&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">BuilderConfig</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mybuild&#39;</span><span class="p">,</span> <span class="n">factory</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">nextWorker</span><span class="o">=</span><span class="n">nextWorker</span><span class="p">,</span>
        <span class="n">workernames</span><span class="o">=</span><span class="n">worker_list</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="codebaseparameter">
<span id="sched-CodebaseParameter"></span><h5>CodebaseParameter<a class="headerlink" href="#codebaseparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CodebaseParameter</span><span class="p">(</span><span class="n">codebase</span><span class="o">=</span><span class="s2">&quot;myrepo&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is a parameter group to specify a sourcestamp for a given codebase.</p>
<p><code class="docutils literal notranslate"><span class="pre">codebase</span></code></p>
<blockquote>
<div><p>The name of the codebase.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">branch</span></code> (optional; default is StringParameter)</p>
<blockquote>
<div><p>A <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameter</span></a> specifying the branch to build.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">revision</span></code> (optional; default is StringParameter)</p>
<blockquote>
<div><p>A <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameter</span></a> specifying the revision to build.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">repository</span></code> (optional; default is StringParameter)</p>
<blockquote>
<div><p>A <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameter</span></a> specifying the repository for the build.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">project</span></code> (optional; default is StringParameter)</p>
<blockquote>
<div><p>A <a class="reference internal" href="#forcescheduler-parameters"><span class="std std-ref">parameter</span></a> specifying the project for the build.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">patch</span></code> (optional; default is None)</p>
<blockquote>
<div><p>A <a class="reference internal" href="#sched-PatchParameter" title="PatchParameter"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">PatchParameter</span></code></a> specifying that the user can upload a patch for this codebase.</p>
</div></blockquote>
</section>
<section id="fileparameter">
<span id="sched-FileParameter"></span><h5>FileParameter<a class="headerlink" href="#fileparameter" title="Link to this heading">ÔÉÅ</a></h5>
<p>This parameter allows the user to upload a file to a build.
The user can either write some text to a text area, or select a file from the browser.
Note that the file is then stored inside a property, so a <code class="docutils literal notranslate"><span class="pre">maxsize</span></code> of 10 megabytes has been set.
You can still override that <code class="docutils literal notranslate"><span class="pre">maxsize</span></code> if you wish.</p>
</section>
<section id="patchparameter">
<span id="sched-PatchParameter"></span><h5>PatchParameter<a class="headerlink" href="#patchparameter" title="Link to this heading">ÔÉÅ</a></h5>
<p>This parameter allows the user to specify a patch to be applied at the source step.
The patch is stored within the sourcestamp, and associated to a codebase.
That is why <a class="reference internal" href="#sched-PatchParameter" title="PatchParameter"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">PatchParameter</span></code></a> must be set inside a <a class="reference internal" href="#sched-CodebaseParameter" title="CodebaseParameter"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">CodebaseParameter</span></code></a>.</p>
<p><a class="reference internal" href="#sched-PatchParameter" title="PatchParameter"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">PatchParameter</span></code></a> is actually a <a class="reference internal" href="#sched-NestedParameter" title="NestedParameter"><code class="xref bb bb-sched docutils literal notranslate"><span class="pre">NestedParameter</span></code></a> composed of following fields:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">FileParameter</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">),</span>
<span class="n">IntParameter</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="n">StringParameter</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="n">StringParameter</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="n">StringParameter</span><span class="p">(</span><span class="s1">&#39;subdir&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can customize any of these fields by overwriting their field name e.g:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;schedulers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">schedulers</span><span class="o">.</span><span class="n">ForceScheduler</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;force&quot;</span><span class="p">,</span>
        <span class="n">codebases</span><span class="o">=</span><span class="p">[</span><span class="n">util</span><span class="o">.</span><span class="n">CodebaseParameter</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">PatchParameter</span><span class="p">(</span>
            <span class="n">body</span><span class="o">=</span><span class="n">FileParameter</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="n">maxsize</span><span class="o">=</span><span class="mi">10000</span><span class="p">)))],</span>  <span class="c1"># override the maximum size</span>
                                                           <span class="c1"># of a patch to 10k instead of 10M</span>
        <span class="n">builderNames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;testy&quot;</span><span class="p">])]</span>
</pre></div>
</div>
</section>
<section id="inheritbuildparameter">
<span id="sched-InheritBuildParameter"></span><h5>InheritBuildParameter<a class="headerlink" href="#inheritbuildparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>InheritBuildParameter is not yet ported to data API, and cannot be used with buildbot nine yet (<a class="reference external" href="http://trac.buildbot.net/ticket/3521">bug #3521</a>).</p>
</div>
<p>This is a special parameter for inheriting force build properties from another build.
The user is presented with a list of compatible builds from which to choose, and all forced-build parameters from the selected build are copied into the new build.
The new parameter is:</p>
<p><code class="docutils literal notranslate"><span class="pre">compatible_builds</span></code></p>
<blockquote>
<div><p>A function to find compatible builds in the build history.
This function is given the master instance as first argument, and the current builder name as second argument, or None when forcing all builds.</p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@defer</span><span class="o">.</span><span class="n">inlineCallbacks</span>
<span class="k">def</span> <span class="nf">get_compatible_builds</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">builder</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">builder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># this is the case for force_build_all</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;cannot generate build list here&quot;</span><span class="p">]</span>
    <span class="c1"># find all successful builds in builder1 and builder2</span>
    <span class="n">builds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">builder</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;builder1&quot;</span><span class="p">,</span> <span class="s2">&quot;builder2&quot;</span><span class="p">]:</span>
        <span class="c1"># get 40 last builds for the builder</span>
        <span class="n">build_dicts</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">master</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s1">&#39;builders&#39;</span><span class="p">,</span> <span class="n">builder</span><span class="p">,</span> <span class="s1">&#39;builds&#39;</span><span class="p">),</span>
                                            <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-buildid&#39;</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">build_dict</span> <span class="ow">in</span> <span class="n">build_dicts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">build_dict</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">SUCCESS</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">builds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">builder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">build_dict</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">builds</span>

<span class="c1"># ...</span>

<span class="n">sched</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="o">...</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">[</span>
        <span class="n">InheritBuildParameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inherit&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;promote a build for merge&quot;</span><span class="p">,</span>
            <span class="n">compatible_builds</span><span class="o">=</span><span class="n">get_compatible_builds</span><span class="p">,</span>
            <span class="n">required</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
            <span class="p">])</span>
</pre></div>
</div>
</section>
<section id="workerchoiceparameter">
<span id="sched-WorkerChoiceParameter"></span><h5>WorkerChoiceParameter<a class="headerlink" href="#workerchoiceparameter" title="Link to this heading">ÔÉÅ</a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>WorkerChoiceParameter is not yet ported to data API, and cannot be used with buildbot nine yet (<a class="reference external" href="http://trac.buildbot.net/ticket/3521">bug #3521</a>).</p>
</div>
<p>This parameter allows a scheduler to require that a build is assigned to the chosen worker.
The choice is assigned to the <cite>workername</cite> property for the build.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">enforceChosenWorker</span></code> functor must be assigned to the <code class="docutils literal notranslate"><span class="pre">canStartBuild</span></code> parameter for the <code class="docutils literal notranslate"><span class="pre">Builder</span></code>.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">util</span>

<span class="c1"># schedulers:</span>
<span class="n">ForceScheduler</span><span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">[</span>
        <span class="n">WorkerChoiceParameter</span><span class="p">(),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># builders:</span>
<span class="n">BuilderConfig</span><span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="n">canStartBuild</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">enforceChosenWorker</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="anypropertyparameter">
<h5>AnyPropertyParameter<a class="headerlink" href="#anypropertyparameter" title="Link to this heading">ÔÉÅ</a></h5>
<p>This parameter type can only be used in <code class="docutils literal notranslate"><span class="pre">properties</span></code>, and allows the user to specify both the property name and value in the web form.</p>
<p>This Parameter is here to reimplement old Buildbot behavior, and should be avoided.
Stricter parameter names and types should be preferred.</p>
</section>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="changesources.html" class="btn btn-neutral float-left" title="2.5.3. Change Sources and Changes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="workers.html" class="btn btn-neutral float-right" title="2.5.6. Workers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
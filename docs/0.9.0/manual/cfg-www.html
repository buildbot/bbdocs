<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.4.12. Web Server &#8212; Buildbot 0.9.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/qtile.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/buildbot.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Buildbot 0.9.0 documentation" href="../index.html" />
    <link rel="up" title="2.4. Configuration" href="configuration.html" />
    <link rel="next" title="2.4.13. Change Hooks" href="cfg-wwwhooks.html" />
    <link rel="prev" title="2.4.11. Reporters" href="cfg-reporters.html" /> 
  <!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cfg-wwwhooks.html" title="2.4.13. Change Hooks"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cfg-reporters.html" title="2.4.11. Reporters"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Buildbot 0.9.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >2. Buildbot Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="configuration.html" accesskey="U">2.4. Configuration</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="web-server">
<span id="cfg-www"></span><h1>2.4.12. Web Server<a class="headerlink" href="#web-server" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As of Buildbot 0.9.0, the built-in web server replaces the old <code class="docutils literal"><span class="pre">WebStatus</span></code> plugin.</p>
</div>
<p>Buildbot contains a built-in web server.
This server is configured with the <code class="docutils literal"><span class="pre">www</span></code> configuration key, which specifies a dictionary with the following keys:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">port</span></code></dt>
<dd>The TCP port on which to serve requests.
Note that SSL is not supported.
To host Buildbot with SSL, use an HTTP proxy such as lighttpd, nginx, or Apache.
If this is <code class="docutils literal"><span class="pre">None</span></code>, the default, then the master will not implement a web server.</dd>
<dt><code class="docutils literal"><span class="pre">json_cache_seconds</span></code></dt>
<dd>The number of seconds into the future at which an HTTP API response should expire.</dd>
<dt><code class="docutils literal"><span class="pre">rest_minimum_version</span></code></dt>
<dd>The minimum supported REST API version.
Any versions less than this value will not be available.
This can be used to ensure that no clients are depending on API versions that will soon be removed from Buildbot.</dd>
<dt><code class="docutils literal"><span class="pre">plugins</span></code></dt>
<dd><p class="first">This key gives a dictionary of additional UI plugins to load, along with configuration for those plugins.
These plugins must be separately installed in the Python environment, e.g., <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">buildbot-waterfall-view</span></code>.
For example:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plugins&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;waterfall_view&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;num_builds&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">debug</span></code></dt>
<dd>If true, then debugging information will be output to the browser.
This is best set to false (the default) on production systems, to avoid the possibility of information leakage.</dd>
<dt><code class="docutils literal"><span class="pre">allowed_origins</span></code></dt>
<dd>This gives a list of origins which are allowed to access the Buildbot API (including control via JSONRPC 2.0).
It implements cross-origin request sharing (CORS), allowing pages at origins other than the Buildbot UI to use the API.
Each origin is interpreted as filename match expression, with <code class="docutils literal"><span class="pre">?</span></code> matching one character and <code class="docutils literal"><span class="pre">*</span></code> matching anything.
Thus <code class="docutils literal"><span class="pre">['*']</span></code> will match all origins, and <code class="docutils literal"><span class="pre">['https://*.buildbot.net']</span></code> will match secure sites under <code class="docutils literal"><span class="pre">buildbot.net</span></code>.
The Buildbot UI will operate correctly without this parameter; it is only useful for allowing access from other web applications.</dd>
<dt><code class="docutils literal"><span class="pre">auth</span></code></dt>
<dd>Authentication module to use for the web server.
See <a class="reference internal" href="#web-authentication"><span class="std std-ref">Authentication plugins</span></a>.</dd>
<dt><code class="docutils literal"><span class="pre">avatar_methods</span></code></dt>
<dd><p class="first">List of methods that can be used to get avatar pictures to use for the web server.
By default, buildbot uses Gravatar to get images associated with each users, if you want to disable this you can just specify empty list:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;avatar_methods&#39;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="last">For use of corporate pictures, you can use LdapUserInfo, which can also acts as an avatar provider.
See <a class="reference internal" href="#web-authentication"><span class="std std-ref">Authentication plugins</span></a>.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">logfileName</span></code></dt>
<dd>Filename used for http access logs, relative to the master directory.
If set to <code class="docutils literal"><span class="pre">None</span></code> or the empty string, the content of the logs will land in the main <code class="file docutils literal"><span class="pre">twisted.log</span></code> log file.
(Default to <code class="docutils literal"><span class="pre">http.log</span></code>)</dd>
<dt><code class="docutils literal"><span class="pre">logRotateLength</span></code></dt>
<dd>The amount of bytes after which the <code class="file docutils literal"><span class="pre">http.log</span></code> file will be rotated.
(Default to the same value as for the <code class="file docutils literal"><span class="pre">twisted.log</span></code> file, set in <code class="file docutils literal"><span class="pre">buildbot.tac</span></code>)</dd>
<dt><code class="docutils literal"><span class="pre">maxRotatedFiles</span></code></dt>
<dd>The amount of log files that will be kept when rotating
(Default to the same value as for the <code class="file docutils literal"><span class="pre">twisted.log</span></code> file, set in <code class="file docutils literal"><span class="pre">buildbot.tac</span></code>)</dd>
<dt><code class="docutils literal"><span class="pre">versions</span></code></dt>
<dd><p class="first">Custom component versions that you'd like to display on the About page.
Buildbot will automatically prepend the versions of Python, twisted and buildbot itself to the list.</p>
<p><code class="docutils literal"><span class="pre">versions</span></code> should be a list of tuples. for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;versions&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;master.cfg&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;OS&#39;</span><span class="p">,</span> <span class="s1">&#39;Ubuntu 14.04&#39;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="last">The first element of a tuple stands for the name of the component, the second stands for the corresponding version.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">custom_templates_dir</span></code></dt>
<dd><p class="first">This directory will be parsed for custom angularJS templates to replace the one of the original website templates.
if the directory string is relative, it will be joined to the master's basedir.
Either <code class="docutils literal"><span class="pre">*.jade</span></code> files or <code class="docutils literal"><span class="pre">*.html</span></code> files can be used, and will be used to override <code class="docutils literal"><span class="pre">views/&lt;filename&gt;.html</span></code> templates in the angularjs templateCache.
Unlike with the regular nodejs based angularjs build system, Python only jade interpreter is used to parse the jade templates.
<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyjade</span></code> is be required to use jade templates.
You can also override plugin's directives, but they have to be in another directory.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span># replace the template whose source is in:
# www/base/src/app/builders/build/build.tpl.jade
build.jade

# replace the template whose source is in
# www/console_view/src/module/view/builders-header/buildersheader.tpl.jade
console_view/buildersheader.html
</pre></div>
</div>
<p>Known differences between nodejs jade and pyjade:</p>
<blockquote class="last">
<div><ul class="simple">
<li>quotes in attributes are not quoted. <a class="reference external" href="https://github.com/syrusakbary/pyjade/issues/132">https://github.com/syrusakbary/pyjade/issues/132</a>
This means you should use double quotes for attributes e.g: <code class="docutils literal"><span class="pre">tr(ng-repeat=&quot;br</span> <span class="pre">in</span> <span class="pre">buildrequests</span> <span class="pre">|</span> <span class="pre">orderBy:'-submitted_at'&quot;)</span></code></li>
</ul>
</div></blockquote>
</dd>
<dt><code class="docutils literal"><span class="pre">change_hook_dialects</span></code></dt>
<dd>See <a class="reference internal" href="cfg-wwwhooks.html#change-hooks"><span class="std std-ref">Change Hooks</span></a>.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="cfg-global.html#cfg-buildbotURL" title="buildbotURL"><code class="xref bb bb-cfg docutils literal"><span class="pre">buildbotURL</span></code></a> configuration value gives the base URL that all masters will use to generate links.
The <a class="reference internal" href="#cfg-www" title="www"><code class="xref bb bb-cfg docutils literal"><span class="pre">www</span></code></a> configuration gives the settings for the webserver.
In simple cases, the <code class="docutils literal"><span class="pre">buildbotURL</span></code> contains the hostname and port of the master, e.g., <code class="docutils literal"><span class="pre">http://master.example.com:8010/</span></code>.
In more complex cases, with multiple masters, web proxies, or load balancers, the correspondance may be less obvious.</p>
</div>
<div class="section" id="authentication-plugins">
<span id="web-authentication"></span><h2>2.4.12.1. Authentication plugins<a class="headerlink" href="#authentication-plugins" title="Permalink to this headline">¶</a></h2>
<p>By default, Buildbot does not require people to authenticate in order to see the readonly data.
In order to access control features in the web UI, you will need to configure an authentication plugin.</p>
<p>Authentication plugins are implemented as classes, and passed as the <code class="docutils literal"><span class="pre">auth</span></code> parameter to <a class="reference internal" href="#cfg-www" title="www"><code class="xref bb bb-cfg docutils literal"><span class="pre">www</span></code></a>.</p>
<p>The available classes are described here:</p>
<dl class="class">
<dt id="buildbot.www.auth.NoAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.auth.</code><code class="descname">NoAuth</code><a class="headerlink" href="#buildbot.www.auth.NoAuth" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is the default authentication plugin, which disables authentication</p>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.auth.UserPasswordAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.auth.</code><code class="descname">UserPasswordAuth</code><span class="sig-paren">(</span><em>users</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.UserPasswordAuth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>users</strong> -- list of <code class="docutils literal"><span class="pre">(&quot;user&quot;,&quot;password&quot;)</span></code> tuples, or a dictionary of <code class="docutils literal"><span class="pre">{&quot;user&quot;:</span> <span class="pre">&quot;password&quot;,</span> <span class="pre">..}</span></code></td>
</tr>
</tbody>
</table>
<p>Simple username/password authentication using a list of user/password tuples provided in the configuration file.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="k">import</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">UserPasswordAuth</span><span class="p">({</span><span class="s2">&quot;homer&quot;</span><span class="p">:</span> <span class="s2">&quot;doh!&quot;</span><span class="p">}),</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.auth.HTPasswdAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.auth.</code><code class="descname">HTPasswdAuth</code><span class="sig-paren">(</span><em>passwdFile</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.HTPasswdAuth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>passwdFile</strong> -- An <code class="file docutils literal"><span class="pre">.htpasswd</span></code> file to read</td>
</tr>
</tbody>
</table>
<p>This class implements simple username/password authentication against a standard <code class="file docutils literal"><span class="pre">.htpasswd</span></code> file.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="k">import</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">HTPasswdAuth</span><span class="p">(</span><span class="s2">&quot;my_htpasswd&quot;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.oauth2.GoogleAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.oauth2.</code><code class="descname">GoogleAuth</code><span class="sig-paren">(</span><em>clientId</em>, <em>clientSecret</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.oauth2.GoogleAuth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>clientId</strong> -- The client ID of your buildbot application</li>
<li><strong>clientSecret</strong> -- The client secret of your buildbot application</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This class implements an authentication with <a class="reference external" href="https://developers.google.com/accounts/docs/OAuth2">Google</a> single sign-on.
You can look at the <a class="reference external" href="https://developers.google.com/accounts/docs/OAuth2">Google</a> oauth2 documentation on how to register your Buildbot instance to the Google systems.
The developer console will give you the two parameters you have to give to <code class="docutils literal"><span class="pre">GoogleAuth</span></code></p>
<p>Register your Buildbot instance with the <code class="docutils literal"><span class="pre">BUILDBOT_URL/auth/login</span></code> url as the allowed redirect URI.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="k">import</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">GoogleAuth</span><span class="p">(</span><span class="s2">&quot;clientid&quot;</span><span class="p">,</span> <span class="s2">&quot;clientsecret&quot;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>in order to use this module, you need to install the Python <code class="docutils literal"><span class="pre">requests</span></code> module</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>pip install requests
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.oauth2.GitHubAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.oauth2.</code><code class="descname">GitHubAuth</code><span class="sig-paren">(</span><em>clientId</em>, <em>clientSecret</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.oauth2.GitHubAuth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>clientId</strong> -- The client ID of your buildbot application</li>
<li><strong>clientSecret</strong> -- The client secret of your buildbot application</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This class implements an authentication with <a class="reference external" href="http://developer.github.com/v3/oauth_authorizations/">GitHub</a> single sign-on.
It functions almost identically to the <a class="reference internal" href="#buildbot.www.oauth2.GoogleAuth" title="buildbot.www.oauth2.GoogleAuth"><code class="xref py py-class docutils literal"><span class="pre">GoogleAuth</span></code></a> class.</p>
<p>Register your Buildbot instance with the <code class="docutils literal"><span class="pre">BUILDBOT_URL/auth/login</span></code> url as the allowed redirect URI.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="k">import</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">GitHubAuth</span><span class="p">(</span><span class="s2">&quot;clientid&quot;</span><span class="p">,</span> <span class="s2">&quot;clientsecret&quot;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.oauth2.GitLabAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.oauth2.</code><code class="descname">GitLabAuth</code><span class="sig-paren">(</span><em>instanceUri</em>, <em>clientId</em>, <em>clientSecret</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.oauth2.GitLabAuth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>instanceUri</strong> -- The URI of your GitLab instance</li>
<li><strong>clientId</strong> -- The client ID of your buildbot application</li>
<li><strong>clientSecret</strong> -- The client secret of your buildbot application</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This class implements an authentication with <a class="reference external" href="http://doc.gitlab.com/ce/integration/oauth_provider.html">GitLab</a> single sign-on.
It functions almost identically to the <a class="reference internal" href="#buildbot.www.oauth2.GoogleAuth" title="buildbot.www.oauth2.GoogleAuth"><code class="xref py py-class docutils literal"><span class="pre">GoogleAuth</span></code></a> class.</p>
<p>Register your Buildbot instance with the <code class="docutils literal"><span class="pre">BUILDBOT_URL/auth/login</span></code> url as the allowed redirect URI.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="k">import</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">GitLabAuth</span><span class="p">(</span><span class="s2">&quot;https://gitlab.com&quot;</span><span class="p">,</span> <span class="s2">&quot;clientid&quot;</span><span class="p">,</span> <span class="n">clientsecret</span><span class="s2">&quot;),</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.auth.RemoteUserAuth">
<em class="property">class </em><code class="descclassname">buildbot.www.auth.</code><code class="descname">RemoteUserAuth</code><a class="headerlink" href="#buildbot.www.auth.RemoteUserAuth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>header</strong> -- header to use to get the username (defaults to <code class="docutils literal"><span class="pre">REMOTE_USER</span></code>)</li>
<li><strong>headerRegex</strong> -- regular expression to get the username from header value (defaults to <code class="docutils literal"><span class="pre">&quot;(?P&lt;username&gt;[^</span> <span class="pre">&#64;]+)&#64;(?P&lt;realm&gt;[^</span> <span class="pre">&#64;]+)&quot;)</span></code>.
Note that your at least need to specify a <code class="docutils literal"><span class="pre">?P&lt;username&gt;</span></code> regular expression named group.</li>
<li><strong>userInfoProvider</strong> -- user info provider; see <a class="reference internal" href="#user-information"><span class="std std-ref">User Information</span></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If the Buildbot UI is served through a reverse proxy that supports HTTP-based authentication (like apache or lighttpd), it's possible to to tell Buildbot to trust the web server and get the username from th request headers.</p>
<p>Administrator must make sure that it's impossible to get access to Buildbot using other way than through frontend.
Usually this means that Buildbot should listen for incoming connections only on localhost (or on some firewall-protected port).
The reverse proxy must require HTTP authentication to access Buildbot pages (using any source for credentials, such as htpasswd, PAM, LDAP, Kerberos).</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="k">import</span> <span class="n">util</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">RemoteUserAuth</span><span class="p">(),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A corresponding Apache configuration example</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&lt;Location &quot;/&quot;&gt;
        AuthType Kerberos
        AuthName &quot;Buildbot login via Kerberos&quot;
        KrbMethodNegotiate On
        KrbMethodK5Passwd On
        KrbAuthRealms &lt;&lt;YOUR CORP REALMS&gt;&gt;
        KrbVerifyKDC off
        KrbServiceName Any
        Krb5KeyTab /etc/krb5/krb5.keytab
        KrbSaveCredentials Off
        require valid-user
        Order allow,deny

        Satisfy Any

        #] SSO
        RewriteEngine On
        RewriteCond %{LA-U:REMOTE_USER} (.+)$
        RewriteRule . - [E=RU:%1,NS]
        RequestHeader set REMOTE_USER %{RU}e

&lt;/Location&gt;
</pre></div>
</div>
<p>The advantage of this sort of authentication is that it is uses a proven and fast implementation for authentication.
The problem is that the only information that is passed to Buildbot is the username, and there is no way to pass any other information like user email, user groups, etc.
That information can be very useful to the mailstatus plugin, or for authorization processes.
See <a class="reference internal" href="#user-information"><span class="std std-ref">User Information</span></a> for a mechanism to supply that information.</p>
</dd></dl>

</div>
<div class="section" id="user-information">
<span id="id1"></span><h2>2.4.12.2. User Information<a class="headerlink" href="#user-information" title="Permalink to this headline">¶</a></h2>
<p>For authentication mechanisms which cannot provide complete information about a user, Buildbot needs another way to get user data.
This is useful both for authentication (to fetch more data about the logged-in user) and for avatars (to fetch data about other users).</p>
<p>This extra information is provided by, appropriately enough, user info providers.
These can be passed to <a class="reference internal" href="#buildbot.www.auth.RemoteUserAuth" title="buildbot.www.auth.RemoteUserAuth"><code class="xref py py-class docutils literal"><span class="pre">RemoteUserAuth</span></code></a> and as an element of <code class="docutils literal"><span class="pre">avatar_methods</span></code>.</p>
<p>This can also be passed to oauth2 authentication plugins.
In this case the username provided by oauth2 will be used, and all other informations will be taken from ldap (Full Name, email, and groups):</p>
<p>Currently only one provider is available:</p>
<dl class="class">
<dt id="buildbot.ldapuserinfo.LdapUserInfo">
<em class="property">class </em><code class="descclassname">buildbot.ldapuserinfo.</code><code class="descname">LdapUserInfo</code><span class="sig-paren">(</span><em>uri</em>, <em>bindUser</em>, <em>bindPw</em>, <em>accountBase</em>, <em>accountPattern</em>, <em>groupBase=None</em>, <em>groupMemberPattern=None</em>, <em>groupName=None</em>, <em>accountFullName</em>, <em>accountEmail</em>, <em>avatarPattern=None</em>, <em>avatarData=None</em>, <em>accountExtraFields=None</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.ldapuserinfo.LdapUserInfo" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param uri:</th><td class="field-body">uri of the ldap server</td>
</tr>
<tr class="field-even field"><th class="field-name">param bindUser:</th><td class="field-body">username of the ldap account that is used to get the infos for other users (usually a &quot;faceless&quot; account)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param bindPw:</th><td class="field-body">password of the <code class="docutils literal"><span class="pre">bindUser</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param accountBase:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">the base dn (distinguished name)of the user database</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param accountPattern:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">the pattern for searching in the account database.
This must contain the <code class="docutils literal"><span class="pre">%(username)s</span></code> string, which is replaced by the searched username</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param accountFullName:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">the name of the field in account ldap database where the full user name is to be found.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param accountEmail:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">the name of the field in account ldap database where the user email is to be found.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param groupBase:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">the base dn of the groups database.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param groupMemberPattern:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">the pattern for searching in the group database.
This must contain the <code class="docutils literal"><span class="pre">%(dn)s</span></code> string, which is replaced by the searched username's dn</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param groupName:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">the name of the field in groups ldap database where the group name is to be found.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param avatarPattern:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">the pattern for searching avatars from emails in the account database.
This must contain the <code class="docutils literal"><span class="pre">%(email)s</span></code> string, which is replaced by the searched email</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param avatarData:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">the name of the field in groups ldap database where the avatar picture is to be found.
This field is supposed to contain the raw picture, format is automatically detected from jpeg, png or git.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param accountExtraFields:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">extra fields to extracts for use with the authorization policies.</td>
</tr>
</tbody>
</table>
<p>If one of the three optional groups parameters is supplied, then all of them become mandatory. If none is supplied, the retrieved user info has an empty list of groups.</p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    from buildbot.plugins import util

    # this configuration works for MS Active Directory ldap implementation
    # we use it for user info, and avatars
    userInfoProvider = util.LdapUserInfo(
        uri=&#39;ldap://ldap.mycompany.com:3268&#39;,
        bindUser=&#39;ldap_user&#39;,
        bindPw=&#39;p4$$wd&#39;,
        accountBase=&#39;dc=corp,dc=mycompany,dc=com&#39;,
        groupBase=&#39;dc=corp,dc=mycompany,dc=com&#39;,
        accountPattern=&#39;(&amp;(objectClass=person)(sAMAccountName=%(username)s))&#39;,
        accountFullName=&#39;displayName&#39;,
        accountEmail=&#39;mail&#39;,
        groupMemberPattern=&#39;(&amp;(objectClass=group)(member=%(dn)s))&#39;,
        groupName=&#39;cn&#39;,
        avatarPattern=&#39;(&amp;(objectClass=person)(mail=%(email)s))&#39;,
        avatarData=&#39;thumbnailPhoto&#39;,
    )
    c[&#39;www&#39;] = dict(port=PORT, allowed_origins=[&quot;*&quot;],
                    url=c[&#39;buildbotURL&#39;],
                    auth=util.RemoteUserAuth(userInfoProvider=userInfoProvider),
                    avatar_methods=[userInfoProvider,
                                    util.AvatarGravatar()])

.. note::

    In order to use this module, you need to install the ``python3-ldap`` module:

    .. code-block:: bash

        pip install python3-ldap

In the case of oauth2 authentications, you have to pass the userInfoProvider as keyword argument::

        from buildbot.plugins import util
        userInfoProvider = util.LdapUserInfo(...)
        c[&#39;www&#39;] = {
            # ...
            &#39;auth&#39;: util.GoogleAuth(&quot;clientid&quot;, &quot;clientsecret&quot;, userInfoProvider=userInfoProvider),
        }
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="reverse-proxy-configuration">
<span id="reverse-proxy-config"></span><h2>2.4.12.3. Reverse Proxy Configuration<a class="headerlink" href="#reverse-proxy-configuration" title="Permalink to this headline">¶</a></h2>
<p>It is usually better to put buildbot behind a reverse proxy in production.</p>
<ul class="simple">
<li>Provides automatic gzip compression</li>
<li>Provides SSL support with a widely used implementation</li>
<li>Provides support for http/2 or spdy for fast parallel REST api access from the browser</li>
</ul>
<p>Reverse proxy however might be problematic for websocket, you have to configure it specifically to pass web socket requests.
Here is an nginx configuration that is known to work (nginx 1.6.2):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>server {
        # Enable SSL and SPDY
        listen 443 ssl spdy default_server;

        server_name yourdomain.com;

        root html;
        index index.html index.htm;

        ssl on;
        ssl_certificate /etc/nginx/ssl/server.cer;
        ssl_certificate_key /etc/nginx/ssl/server.key;

        # put a one day session timeout for websockets to stay longer
        ssl_session_cache      shared:SSL:1440m;
        ssl_session_timeout  1440m;
        add_header        Alternate-Protocol  443:npn-spdy/3;

        # please consult latest nginx documentation for current secure encryption settings
        ssl_protocols ..
        ssl_ciphers ..
        ssl_prefer_server_ciphers   on;
        #

        # force https
        add_header Strict-Transport-Security &quot;max-age=31536000; includeSubdomains;&quot;;
        spdy_headers_comp 5;

        # you could use / if you use domain based proxy instead of path based proxy
        location /buildbot/ {
            proxy_pass http://localhost:5000/;
        }
        location /buildbot/sse/ {
            # proxy buffering will prevent sse to work
            proxy_buffering off;
            proxy_pass http://localhost:5000/sse/;
        }
        # required for websocket
        location /buildbot/ws {
              proxy_http_version 1.1;
              proxy_set_header Upgrade $http_upgrade;
              proxy_set_header Connection &quot;upgrade&quot;;
              proxy_pass http://localhost:5000/ws;
              # raise the proxy timeout for the websocket
              proxy_read_timeout 6000s;
        }
}
</pre></div>
</div>
<p>To run with Apache2, you'll need <a class="reference external" href="https://httpd.apache.org/docs/2.4/mod/mod_proxy_wstunnel.html">mod_proxy_wstunnel</a> in addition to <a class="reference external" href="https://httpd.apache.org/docs/2.4/mod/mod_proxy_http.html">mod_proxy_http</a>. Serving HTTPS (<a class="reference external" href="https://httpd.apache.org/docs/2.4/mod/mod_ssl.html">mod_ssl</a>) is advised to prevent issues with enterprise proxies (see <a class="reference internal" href="../developer/www-server.html#sse"><span class="std std-ref">Server Sent Events</span></a>), even if you don't need the encryption itself.</p>
<p>Here is a configuration that is known to work (Apache 2.4.10 / Debian 8), directly at the top of the domain.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&lt;VirtualHost *:443&gt;
    ServerName buildbot.example
    ServerAdmin webmaster@buildbot.example

    &lt;Location /ws&gt;
      ProxyPass ws://localhost:8020/ws
      ProxyPassReverse ws://localhost:8020/ws
    &lt;/Location&gt;

    ProxyPass /ws !
    ProxyPass / http://localhost:8020/
    ProxyPassReverse / http://localhost:8020/

    SetEnvIf X-Url-Scheme https HTTPS=1
    ProxyPreserveHost On

    SSLEngine on
    SSLCertificateFile /path/to/cert.pem
    SSLCertificateKeyFile /path/to/cert.key

    # check Apache2 documentation for current safe SSL settings
    # This is actually the Debian 8 default at the time of this writing:
    SSLProtocol all -SSLv3

&lt;/VirtualHost&gt;
</pre></div>
</div>
</div>
<div class="section" id="authorization-rules">
<span id="web-authorization"></span><h2>2.4.12.4. Authorization rules<a class="headerlink" href="#authorization-rules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="endpoint-matchers">
<h3>Endpoint matchers<a class="headerlink" href="#endpoint-matchers" title="Permalink to this headline">¶</a></h3>
<p>Endpoint matchers are responsible for creating rules to match REST endpoints, and requiring roles for them.
The following sequence is implemented by each EndpointMatcher class</p>
<ul class="simple">
<li>Check whether the requested endpoint is supported by this matcher</li>
<li>Get necessary info from data api, and decides whether it matches.</li>
<li>Looks if the users has the required role.</li>
</ul>
<p>Several endpoints  matchers are currently implemented</p>
<dl class="class">
<dt id="buildbot.www.authz.endpointmatchers.AnyEndpointMatcher">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.endpointmatchers.</code><code class="descname">AnyEndpointMatcher</code><span class="sig-paren">(</span><em>role</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.endpointmatchers.AnyEndpointMatcher" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>role</strong> -- The role which grants access to any endpoint.</td>
</tr>
</tbody>
</table>
<p>AnyEndpointMatcher grants all rights to a people with given role (usually &quot;admins&quot;)</p>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.authz.endpointmatchers.ForceBuildEndpointMatcher">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.endpointmatchers.</code><code class="descname">ForceBuildEndpointMatcher</code><span class="sig-paren">(</span><em>builder</em>, <em>role</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.endpointmatchers.ForceBuildEndpointMatcher" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>builder</strong> -- name of the builder.</li>
<li><strong>role</strong> -- The role needed to get access to such endpoints.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>ForceBuildEndpointMatcher grants all rights to a people with given role (usually &quot;admins&quot;)</p>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.authz.endpointmatchers.StopBuildEndpointMatcher">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.endpointmatchers.</code><code class="descname">StopBuildEndpointMatcher</code><span class="sig-paren">(</span><em>builder</em>, <em>role</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.endpointmatchers.StopBuildEndpointMatcher" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>builder</strong> -- name of the builder.</li>
<li><strong>role</strong> -- The role needed to get access to such endpoints.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>StopBuildEndpointMatcher grants all rights to a people with given role (usually &quot;admins&quot;)</p>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.authz.endpointmatchers.RebuildBuildEndpointMatcher">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.endpointmatchers.</code><code class="descname">RebuildBuildEndpointMatcher</code><span class="sig-paren">(</span><em>builder</em>, <em>role</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.endpointmatchers.RebuildBuildEndpointMatcher" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>builder</strong> -- name of the builder.</li>
<li><strong>role</strong> -- The role needed to get access to such endpoints.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>RebuildBuildEndpointMatcher grants all rights to a people with given role (usually &quot;admins&quot;)</p>
</dd></dl>

</div>
<div class="section" id="role-matchers">
<h3>Role matchers<a class="headerlink" href="#role-matchers" title="Permalink to this headline">¶</a></h3>
<p>Endpoint matchers are responsible for creating rules to match people and grant them roles.
You can grant roles from groups information provided by the Auth plugins, or if you prefer directly to people's email.</p>
<dl class="class">
<dt id="buildbot.www.authz.roles.RolesFromGroups">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.roles.</code><code class="descname">RolesFromGroups</code><span class="sig-paren">(</span><em>groupPrefix</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.roles.RolesFromGroups" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>groupPrefix</strong> -- prefix to remove from each group</td>
</tr>
</tbody>
</table>
<p>RolesFromGroups grants roles from the groups of the user.
If a user has group <code class="docutils literal"><span class="pre">buildbot-admin</span></code>, and groupPrefix is <code class="docutils literal"><span class="pre">buildbot-</span></code>, then user will be granted the role 'admin'</p>
<p>ex:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">roleMatchers</span><span class="o">=</span><span class="p">[</span>
  <span class="n">util</span><span class="o">.</span><span class="n">RolesFromGroups</span><span class="p">(</span><span class="n">groupPrefix</span><span class="o">=</span><span class="s2">&quot;buildbot-&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.authz.roles.RolesFromEmails">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.roles.</code><code class="descname">RolesFromEmails</code><span class="sig-paren">(</span><em>roledict</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.roles.RolesFromEmails" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>roledict</strong> -- dictionary with key=role, and value=list of email strings</td>
</tr>
</tbody>
</table>
<p>RolesFromEmails grants roles to users according to the hardcoded emails.</p>
<p>ex:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">roleMatchers</span><span class="o">=</span><span class="p">[</span>
  <span class="n">util</span><span class="o">.</span><span class="n">RolesFromEmails</span><span class="p">(</span><span class="n">admins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;my@email.com&quot;</span><span class="p">])</span>
<span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="buildbot.www.authz.roles.RolesFromOwner">
<em class="property">class </em><code class="descclassname">buildbot.www.authz.roles.</code><code class="descname">RolesFromOwner</code><span class="sig-paren">(</span><em>roledict</em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.authz.roles.RolesFromOwner" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>roledict</strong> -- dictionary with key=role, and value=list of email strings</td>
</tr>
</tbody>
</table>
<p>RolesFromOwner grants a given role when property owner matches the email of the user</p>
<p>ex:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">roleMatchers</span><span class="o">=</span><span class="p">[</span>
    <span class="n">RolesFromOwner</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="example-configs">
<h3>Example Configs<a class="headerlink" href="#example-configs" title="Permalink to this headline">¶</a></h3>
<p>Simple config which allows admin people to run everything:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">authz</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">Authz</span><span class="p">(</span>
  <span class="n">allowRules</span><span class="o">=</span><span class="p">[</span>
    <span class="n">util</span><span class="o">.</span><span class="n">StopBuildEndpointMatcher</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;admins&quot;</span><span class="p">),</span>
    <span class="n">util</span><span class="o">.</span><span class="n">ForceBuildEndpointMatcher</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;admins&quot;</span><span class="p">),</span>
    <span class="n">util</span><span class="o">.</span><span class="n">RebuildBuildEndpointMatcher</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;admins&quot;</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="n">roleMatchers</span><span class="o">=</span><span class="p">[</span>
    <span class="n">util</span><span class="o">.</span><span class="n">RolesFromEmails</span><span class="p">(</span><span class="n">admins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;my@email.com&quot;</span><span class="p">])</span>
  <span class="p">]</span>
<span class="p">)</span>
<span class="n">auth</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">UserPasswordAuth</span><span class="p">({</span><span class="s1">&#39;my@email.com&#39;</span><span class="p">:</span> <span class="s1">&#39;mypass&#39;</span><span class="p">})</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">][</span><span class="s1">&#39;auth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">auth</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">][</span><span class="s1">&#39;authz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">authz</span>
</pre></div>
</div>
<p>More complex config with separation per branch:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">authz</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">Authz</span><span class="p">(</span>
    <span class="n">stringsMatcher</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">fnmatchStrMatcher</span><span class="p">,</span>  <span class="c1"># simple matcher with &#39;*&#39; glob character</span>
    <span class="c1"># stringsMatcher = util.reStrMatcher,   # if you prefer regular expressions</span>
    <span class="n">allowRules</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># admins can do anything,</span>
        <span class="c1"># defaultDeny=False: if user does not have the admin role, we continue parsing rules</span>
        <span class="n">util</span><span class="o">.</span><span class="n">AnyEndpointMatcher</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;admins&quot;</span><span class="p">,</span> <span class="n">defaultDeny</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>

        <span class="n">StopBuildEndpointMatcher</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;owner&quot;</span><span class="p">),</span>

        <span class="c1"># *-try groups can start &quot;try&quot; builds</span>
        <span class="n">util</span><span class="o">.</span><span class="n">ForceBuildEndpointMatcher</span><span class="p">(</span><span class="n">builder</span><span class="o">=</span><span class="s2">&quot;try&quot;</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;*-try&quot;</span><span class="p">),</span>
        <span class="c1"># *-mergers groups can start &quot;merge&quot; builds</span>
        <span class="n">util</span><span class="o">.</span><span class="n">ForceBuildEndpointMatcher</span><span class="p">(</span><span class="n">builder</span><span class="o">=</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;*-mergers&quot;</span><span class="p">),</span>
        <span class="c1"># *-releasers groups can start &quot;release&quot; builds</span>
        <span class="n">util</span><span class="o">.</span><span class="n">ForceBuildEndpointMatcher</span><span class="p">(</span><span class="n">builder</span><span class="o">=</span><span class="s2">&quot;release&quot;</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;*-releasers&quot;</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">roleMatchers</span><span class="o">=</span><span class="p">[</span>
        <span class="n">RolesFromGroups</span><span class="p">(</span><span class="n">groupPrefix</span><span class="o">=</span><span class="s2">&quot;buildbot-&quot;</span><span class="p">),</span>
        <span class="n">RolesFromEmails</span><span class="p">(</span><span class="n">admins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;homer@springfieldplant.com&quot;</span><span class="p">],</span>
                        <span class="n">reaper</span><span class="o">-</span><span class="k">try</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;007@mi6.uk&quot;</span><span class="p">]),</span>
        <span class="c1"># role owner is granted when property owner matches the email of the user</span>
        <span class="n">RolesFromOwner</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;www&#39;</span><span class="p">][</span><span class="s1">&#39;authz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">authz</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/header-text-transparent.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Table Of Contents</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation/index.html">2.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="configuration.html">2.4. Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cfg-intro.html">2.4.1. Configuring Buildbot</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-global.html">2.4.2. Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-changesources.html">2.4.3. Change Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-schedulers.html">2.4.4. Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-workers.html">2.4.5. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-builders.html">2.4.6. Builder Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-buildfactories.html">2.4.7. Build Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-properties.html">2.4.8. Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-buildsteps.html">2.4.9. Build Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-interlocks.html">2.4.10. Interlocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-reporters.html">2.4.11. Reporters</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.4.12. Web Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-wwwhooks.html">2.4.13. Change Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-services.html">2.4.14. Custom Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfg-dbconfig.html">2.4.15. DbConfig</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="worker-transition.html">2.5. Transition to &quot;worker&quot; terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-style-steps.html">2.7. New-Style Build Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmdline.html">2.8. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="resources.html">2.9. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">2.10. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">2.11. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html">2.12. Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html">4. Release Notes for Buildbot <code class="docutils literal"><span class="pre">0.9.0</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices.html">5. Indices and Tables</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cfg-reporters.html"
                        title="previous chapter">2.4.11. Reporters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cfg-wwwhooks.html"
                        title="next chapter">2.4.13. Change Hooks</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/manual/cfg-www.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>
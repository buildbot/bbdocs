<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.10.17. Authentication &mdash; Buildbot 4.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/buildbot_rtd.css?v=915d5e18" />

  
    <link rel="shortcut icon" href="../_static/icon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=04fc738e"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.10.18. Avatars" href="cls-avatar.html" />
    <link rel="prev" title="3.10.16. LogObservers" href="cls-logobserver.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Buildbot
              <img src="../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">2. Buildbot Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. Buildbot Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">3.1. Development Quick-start</a></li>
<li class="toctree-l2"><a class="reference internal" href="pull-request.html">3.2. Submitting Pull Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="general.html">3.3. General Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="rest.html">3.4. REST API</a></li>
<li class="toctree-l2"><a class="reference internal" href="raml/index.html">3.5. REST API Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">3.6. Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="database.html">3.7. Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="database/index.html">3.8. Database connectors API</a></li>
<li class="toctree-l2"><a class="reference internal" href="mq.html">3.9. Messaging and Queues</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="classes.html">3.10. Classes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cls-build.html">3.10.1. Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-worker.html">3.10.2. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-buildfactory.html">3.10.3. BuildFactory</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-changesources.html">3.10.4. Change Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-remotecommands.html">3.10.5. RemoteCommands</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-buildsteps.html">3.10.6. BuildSteps</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-basescheduler.html">3.10.7. BaseScheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-forcesched.html">3.10.8. ForceScheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-irenderable.html">3.10.9. IRenderable</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-iproperties.html">3.10.10. IProperties</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-iconfigurator.html">3.10.11. IConfigurator</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-resultspec.html">3.10.12. ResultSpecs</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-protocols.html">3.10.13. Protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-workermanager.html">3.10.14. WorkerManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-log.html">3.10.15. Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-logobserver.html">3.10.16. LogObservers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.10.17. Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#buildbot.www.auth.AuthBase"><code class="docutils literal notranslate"><span class="pre">AuthBase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#buildbot.www.auth.UserInfoProviderBase"><code class="docutils literal notranslate"><span class="pre">UserInfoProviderBase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#buildbot.www.oauth2.OAuth2Auth"><code class="docutils literal notranslate"><span class="pre">OAuth2Auth</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cls-avatar.html">3.10.18. Avatars</a></li>
<li class="toctree-l3"><a class="reference internal" href="cls-www.html">3.10.19. Web Server Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">3. </span>Buildbot Development</a></li>
          <li class="breadcrumb-item"><a href="classes.html"><span class="section-number">3.10. </span>Classes</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.10.17. </span>Authentication</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developer/cls-auth.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-buildbot.www.auth">
<span id="authentication"></span><h1><span class="section-number">3.10.17. </span>Authentication<a class="headerlink" href="#module-buildbot.www.auth" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.www.auth.</span></span><span class="sig-name descname"><span class="pre">AuthBase</span></span><a class="headerlink" href="#buildbot.www.auth.AuthBase" title="Link to this definition"></a></dt>
<dd><p>This class is the base class for all authentication methods.
All authentications are not done at the same level, so several optional methods are available.
This class implements a default implementation.
The login session is stored via twisted’s <code class="docutils literal notranslate"><span class="pre">request.getSession()</span></code>, and detailed used information is stored in <code class="docutils literal notranslate"><span class="pre">request.getSession().user_info</span></code>.
The session information is then sent to the UI via the <code class="docutils literal notranslate"><span class="pre">config</span></code> constant (in the <code class="docutils literal notranslate"><span class="pre">user</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">config</span></code>).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase.userInfoProvider">
<span class="sig-name descname"><span class="pre">userInfoProvider</span></span><a class="headerlink" href="#buildbot.www.auth.AuthBase.userInfoProvider" title="Link to this definition"></a></dt>
<dd><p>Authentication modules are responsible for providing user information as detailed as possible.
When there is a need to get additional information from another source, a userInfoProvider can optionally be specified.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase.reconfigAuth">
<span class="sig-name descname"><span class="pre">reconfigAuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.AuthBase.reconfigAuth" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>master</strong> – the reference to the master</p></li>
<li><p><strong>new_config</strong> – the reference to the new configuration</p></li>
</ul>
</dd>
</dl>
<p>Reconfigure the authentication module.
In the base class, this simply sets <code class="docutils literal notranslate"><span class="pre">self.master</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase.maybeAutoLogin">
<span class="sig-name descname"><span class="pre">maybeAutoLogin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.AuthBase.maybeAutoLogin" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> – the request object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deferred</p>
</dd>
</dl>
<p>This method is called when <code class="docutils literal notranslate"><span class="pre">/config.js</span></code> is fetched.
If the authentication method supports automatic login, e.g., from a header provided by a frontend proxy, this method handles the login.</p>
<p>If it succeeds, the method sets <code class="docutils literal notranslate"><span class="pre">request.getSession().user_info</span></code>.
If the login fails unexpectedly, it raises <code class="docutils literal notranslate"><span class="pre">resource.Error</span></code>.
The default implementation simply returns without setting <code class="docutils literal notranslate"><span class="pre">user_info</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase.getLoginResource">
<span class="sig-name descname"><span class="pre">getLoginResource</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.AuthBase.getLoginResource" title="Link to this definition"></a></dt>
<dd><p>Return the resource representing <code class="docutils literal notranslate"><span class="pre">/auth/login</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase.getLogout">
<span class="sig-name descname"><span class="pre">getLogout</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.AuthBase.getLogout" title="Link to this definition"></a></dt>
<dd><p>Return the resource representing <code class="docutils literal notranslate"><span class="pre">/auth/logout</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.auth.AuthBase.updateUserInfo">
<span class="sig-name descname"><span class="pre">updateUserInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.AuthBase.updateUserInfo" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> – the request object</p>
</dd>
</dl>
<p>Separate entrypoint for getting user information.
This is a means to call self.userInfoProvider if provided.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="buildbot.www.auth.UserInfoProviderBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.www.auth.</span></span><span class="sig-name descname"><span class="pre">UserInfoProviderBase</span></span><a class="headerlink" href="#buildbot.www.auth.UserInfoProviderBase" title="Link to this definition"></a></dt>
<dd><p>Class that can be used, to get more info for the user, like groups, from a separate database.</p>
<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.auth.UserInfoProviderBase.getUserInfo">
<span class="sig-name descname"><span class="pre">getUserInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.auth.UserInfoProviderBase.getUserInfo" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the user info for the username used for login, via a Deferred</p>
</dd>
</dl>
<p>Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> with following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">email</span></code>: email address of the user</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full_name</span></code>: Full name of the user, like “Homer Simpson”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groups</span></code>: groups the user belongs to, like [“duff fans”, “dads”]</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-buildbot.www.oauth2">
<dt class="sig sig-object py" id="buildbot.www.oauth2.OAuth2Auth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.www.oauth2.</span></span><span class="sig-name descname"><span class="pre">OAuth2Auth</span></span><a class="headerlink" href="#buildbot.www.oauth2.OAuth2Auth" title="Link to this definition"></a></dt>
<dd><p>OAuth2Auth implements oauth2 two-factor authentication.
With this method, <code class="docutils literal notranslate"><span class="pre">/auth/login</span></code> is called twice.
The first time (without argument), it should return the URL the browser has to redirect to in order to perform oauth2 authentication and authorization.
Then the oauth2 provider will redirect to <code class="docutils literal notranslate"><span class="pre">/auth/login?code=???</span></code> and the Buildbot web server will verify the code using the oauth2 provider.</p>
<p>Typical login process is:</p>
<ul class="simple">
<li><p>UI calls the <code class="docutils literal notranslate"><span class="pre">/auth/login</span></code> API and redirects the browser to the returned oauth2 provider URL</p></li>
<li><p>oauth2 provider shows a web page with a form for the user to authenticate, and asks the user for permission for Buildbot to access their account</p></li>
<li><p>oauth2 provider redirects the browser to <code class="docutils literal notranslate"><span class="pre">/auth/login?code=???</span></code></p></li>
<li><p>OAuth2Auth module verifies the code, and get the user’s additional information</p></li>
<li><p>Buildbot UI is reloaded, with the user authenticated</p></li>
</ul>
<p>This implementation is using <a class="reference external" href="https://requests.readthedocs.io/en/master/">requests</a>.
Subclasses must override the following class attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Name of the oauth plugin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">faIcon</span></code>: Font awesome class to use for login button logo</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resourceEndpoint</span></code>: URI of the resource where the authentication token is used</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">authUri</span></code>: URI the browser is pointed to let the user enter creds</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenUri</span></code>: URI to verify the browser code and get auth token</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">authUriAdditionalParams</span></code>: Additional parameters for the authUri</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenUriAdditionalParams</span></code>: Additional parameters for the tokenUri</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="buildbot.www.oauth2.OAuth2Auth.getUserInfoFromOAuthClient">
<span class="sig-name descname"><span class="pre">getUserInfoFromOAuthClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.www.oauth2.OAuth2Auth.getUserInfoFromOAuthClient" title="Link to this definition"></a></dt>
<dd><p>This method is called after a successful authentication to get additional information about the user from the oauth2 provider.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cls-logobserver.html" class="btn btn-neutral float-left" title="3.10.16. LogObservers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cls-avatar.html" class="btn btn-neutral float-right" title="3.10.18. Avatars" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
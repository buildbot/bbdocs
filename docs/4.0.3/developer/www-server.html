<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.3.9. WWW Server &mdash; Buildbot 4.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/buildbot_rtd.css?v=915d5e18" />

  
    <link rel="shortcut icon" href="../_static/icon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=04fc738e"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.3.10. Javascript Data Module" href="www-data-module.html" />
    <link rel="prev" title="3.3.8. Build Result Codes" href="results.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Buildbot
              <img src="../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">2. Buildbot Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. Buildbot Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">3.1. Development Quick-start</a></li>
<li class="toctree-l2"><a class="reference internal" href="pull-request.html">3.2. Submitting Pull Requests</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="general.html">3.3. General Documents</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="master-overview.html">3.3.1. Master Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="style.html">3.3.2. Buildbot Coding Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="tests.html">3.3.3. Buildbot’s Test Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html">3.3.4. Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#configuration-in-angularjs">3.3.5. Configuration in AngularJS</a></li>
<li class="toctree-l3"><a class="reference internal" href="schedulers.html">3.3.6. Writing Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">3.3.7. Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="results.html">3.3.8. Build Result Codes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.3.9. WWW Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#history-and-motivation">3.3.9.1. History and Motivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#design-overview">3.3.9.2. Design Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rest-api">3.3.9.3. REST API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#server-side-session">3.3.9.4. Server-Side Session</a></li>
<li class="toctree-l4"><a class="reference internal" href="#message-api">3.3.9.5. Message API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="www-data-module.html">3.3.10. Javascript Data Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="www-base-app.html">3.3.11. Base web application</a></li>
<li class="toctree-l3"><a class="reference internal" href="auth.html">3.3.12. Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="authz.html">3.3.13. Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="master-worker.html">3.3.14. Master-Worker API</a></li>
<li class="toctree-l3"><a class="reference internal" href="master-worker-msgpack.html">3.3.15. Master-Worker connection with MessagePack over WebSocket protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="br-claiming.html">3.3.16. Claiming Build Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="encodings.html">3.3.17. String Encodings</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html">3.3.18. Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="secrets.html">3.3.19. Secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="secrets.html#secrets-manager">3.3.20. Secrets manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="secrets.html#secrets-providers">3.3.21. Secrets providers</a></li>
<li class="toctree-l3"><a class="reference internal" href="stats-service.html">3.3.22. Statistics Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins-publish.html">3.3.23. How to package Buildbot plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rest.html">3.4. REST API</a></li>
<li class="toctree-l2"><a class="reference internal" href="raml/index.html">3.5. REST API Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">3.6. Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="database.html">3.7. Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="database/index.html">3.8. Database connectors API</a></li>
<li class="toctree-l2"><a class="reference internal" href="mq.html">3.9. Messaging and Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes.html">3.10. Classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">3. </span>Buildbot Development</a></li>
          <li class="breadcrumb-item"><a href="general.html"><span class="section-number">3.3. </span>General Documents</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.3.9. </span>WWW Server</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developer/www-server.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="www-server">
<span id="www"></span><span id="id1"></span><h1><span class="section-number">3.3.9. </span>WWW Server<a class="headerlink" href="#www-server" title="Link to this heading"></a></h1>
<section id="history-and-motivation">
<h2><span class="section-number">3.3.9.1. </span>History and Motivation<a class="headerlink" href="#history-and-motivation" title="Link to this heading"></a></h2>
<p>One of the goals of the ‘nine’ project is to rework Buildbot’s web services to use a more modern, consistent design and implement UI features in client-side JavaScript instead of server-side Python.</p>
<p>The rationale behind this is that a client side UI relieves pressure on the server while being more responsive for the user.
The web server only concentrates on serving data via a REST interface wrapping the <a class="reference internal" href="data.html#data-api"><span class="std std-ref">Data API</span></a>.
This removes a lot of sources of latency where, in previous versions, long synchronous calculations were made on the server to generate complex pages.</p>
<p>Another big advantage is live updates of status pages, without having to poll or reload.
The new system uses Comet techniques in order to relay Data API events to connected clients.</p>
<p>Finally, making web services an integral part of Buildbot, rather than a status plugin, allows tighter integration with the rest of the application.</p>
</section>
<section id="design-overview">
<h2><span class="section-number">3.3.9.2. </span>Design Overview<a class="headerlink" href="#design-overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">www</span></code> service exposes three pieces via HTTP:</p>
<ul class="simple">
<li><p>A REST interface wrapping <a class="reference internal" href="data.html#data-api"><span class="std std-ref">Data API</span></a>;</p></li>
<li><p>HTTP-based messaging protocols wrapping the <a class="reference internal" href="mq.html#messaging-and-queues"><span class="std std-ref">Messaging and Queues</span></a> interface; and</p></li>
<li><p>Static resources implementing the client-side UI.</p></li>
</ul>
<p>The REST interface is a very thin wrapper: URLs are translated directly into Data API paths, and results are returned directly, in JSON format.
It is based on <a class="reference external" href="http://jsonapi.org/">JSON API</a>.
Control calls are handled with a simplified form of <a class="reference external" href="http://www.jsonrpc.org/specification">JSONRPC 2.0</a>.</p>
<p>The message interface is also a thin wrapper around Buildbot’s MQ mechanism.
Clients can subscribe to messages, and receive copies of the messages, in JSON, as they are received by the buildmaster.</p>
<p>The client-side UI is an AngularJS application.
Buildbot uses the Python setuptools entry-point mechanism to allow multiple packages to be combined into a single client-side experience.
This allows frontend developers and users to build custom components for the web UI without hacking Buildbot itself.</p>
<p>Python development and AngularJS development are very different processes, requiring different environment requirements and skillsets.
To maximize hackability, Buildbot separates the two cleanly.
An experienced AngularJS hacker should be quite comfortable in the <a class="reference external" href="https://github.com/buildbot/buildbot/tree/master/www/">www/</a> directory, with a few exceptions described below.
Similarly, an experienced Python hacker can simply download the pre-built web UI (from pypi!) and never venture near the <a class="reference external" href="https://github.com/buildbot/buildbot/tree/master/www/">www/</a> directory.</p>
<section id="urls">
<h3>URLs<a class="headerlink" href="#urls" title="Link to this heading"></a></h3>
<p>The Buildbot web interface is rooted at its base URL, as configured by the user.
It is entirely possible for this base URL to contain path components, e.g., <code class="docutils literal notranslate"><span class="pre">http://build.example.org/buildbot/</span></code>, if hosted behind an HTTP proxy.
To accomplish this, all URLs are generated relative to the base URL.</p>
<p>Overall, the space under the base URL looks like this:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> – The HTML document that loads the UI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/config</span></code> – Returns implementation-defined master configuration used by the frontend UI.
The same data may be embedded directly into the HTML document returned by the <code class="docutils literal notranslate"><span class="pre">/</span></code> URL.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/api/v{version}</span></code> – The root of the REST APIs, each versioned numerically.
Users should, in general, use the latest version.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/ws</span></code> – The WebSocket endpoint to subscribe to messages from the mq system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/sse</span></code> – The <a class="reference external" href="http://en.wikipedia.org/wiki/Server-sent_events">server sent event</a> endpoint where clients can subscribe to messages from the mq system.</p></li>
</ul>
</section>
</section>
<section id="rest-api">
<h2><span class="section-number">3.3.9.3. </span>REST API<a class="headerlink" href="#rest-api" title="Link to this heading"></a></h2>
<p>Rest API is described in its own section.</p>
</section>
<section id="server-side-session">
<h2><span class="section-number">3.3.9.4. </span>Server-Side Session<a class="headerlink" href="#server-side-session" title="Link to this heading"></a></h2>
<p>The web server keeps a session state for each user, keyed on a session cookie.
This session is available from <code class="docutils literal notranslate"><span class="pre">request.getSession()</span></code>, and data is stored as attributes.
The following attributes may be available:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">user_info</span></code></dt><dd><p>A dictionary maintained by the <a class="reference internal" href="auth.html"><span class="doc">authentication subsystem</span></a>.
It may have the following information about the logged-in user:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">username</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">email</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full_name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groups</span></code> (a list of group names)</p></li>
</ul>
<p>As well as additional fields specific to the user info implementation.</p>
<p>The contents of the <code class="docutils literal notranslate"><span class="pre">user_info</span></code> dictionary are made available to the UI as <code class="docutils literal notranslate"><span class="pre">config.user</span></code>.</p>
</dd>
</dl>
</section>
<section id="message-api">
<h2><span class="section-number">3.3.9.5. </span>Message API<a class="headerlink" href="#message-api" title="Link to this heading"></a></h2>
<p>Currently, messages are implemented with two protocols, WebSockets and <a class="reference external" href="http://en.wikipedia.org/wiki/Server-sent_events">server sent events</a>.</p>
<section id="websocket">
<h3>WebSocket<a class="headerlink" href="#websocket" title="Link to this heading"></a></h3>
<p>WebSocket is a protocol for arbitrary messaging to and from a browser.
As an HTTP extension, the protocol is not yet well supported by all HTTP proxy technologies. Although, it has been reported to work well used behind the https protocol. Only one WebSocket connection is needed per browser.</p>
<p>The client can connect using the url <code class="docutils literal notranslate"><span class="pre">ws[s]://&lt;BB_BASE_URL&gt;/ws</span></code>.</p>
<p>The protocol used is a simple in-house protocol based on json. The structure of a command from the client is as follows:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;cmd&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;command name&gt;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_id&#39;</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">id</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">command</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;arg1&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">arg1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;arg2&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">arg2</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cmd</span></code> is used to reference a command name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_id</span></code> is used to track the response, can be any unique number or string, generated by the client.
It needs to be unique per websocket session.</p></li>
</ul>
<p>Response is sent asynchronously, reusing <code class="docutils literal notranslate"><span class="pre">_id</span></code> to track which command is responded.</p>
<p>Success answer example would be:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;msg&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;code&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Error answer example would be:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;code&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">404</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;no such command &#39;poing&#39;&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>The client can send several commands without waiting for a response.</p>
<p>Responses are not guaranteed to be sent in order.</p>
<p>Several commands are implemented:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">ping</span></code></dt><dd><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;cmd&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ping&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>The server will respond with a “pong” message:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;msg&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pong&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;code&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">startConsuming</span></code></dt><dd><p>Start consuming events that match <code class="docutils literal notranslate"><span class="pre">path</span></code>.
<code class="docutils literal notranslate"><span class="pre">path</span></code>s are described in the <a class="reference internal" href="mq.html#messaging-and-queues"><span class="std std-ref">Messaging and Queues</span></a> section.
For size optimization reasons, paths are joined with “/”, and with the None wildcard replaced by “*”.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;cmd&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;startConsuming&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;path&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;change/*/*&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Success answer example will be:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;msg&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;code&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">stopConsuming</span></code></dt><dd><p>Stop consuming events that were previously registered with <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;cmd&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;stopConsuming&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;path&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;change/*/*&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Success answer example will be:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;msg&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;code&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
<p>The client will receive events as websocket frames encoded in json with the following format:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;k&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;m&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="sse">
<span id="id2"></span><h3>Server Sent Events<a class="headerlink" href="#sse" title="Link to this heading"></a></h3>
<p>SSE is a simpler protocol than WebSockets and is more REST compliant. It uses the chunk-encoding HTTP feature to stream the events. SSE also does not work well behind an enterprise proxy, unless you use the https protocol.</p>
<p>The client can connect using following endpoints:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">http[s]://&lt;BB_BASE_URL&gt;/sse/listen/&lt;path&gt;</span></code>: Start listening to events on the http connection.
Optionally, setup a first event filter on <code class="docutils literal notranslate"><span class="pre">&lt;path&gt;</span></code>.
The first message send is a handshake, giving a uuid that can be used to add or remove event filters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">http[s]://&lt;BB_BASE_URL&gt;/sse/add/&lt;uuid&gt;/&lt;path&gt;</span></code>: Configure a sse session to add an event filter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">http[s]://&lt;BB_BASE_URL&gt;/sse/remove/&lt;uuid&gt;/&lt;path&gt;</span></code>: Configure a sse session to remove an event filter</p></li>
</ul>
<p>Note that if a load balancer is setup as a front end to buildbot web masters, the load balancer must be configured to always use the same master given a client IP address for /sse endpoint.</p>
<p>The client will receive events as sse events, encoded with the following format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>event: event
data: { &quot;key&quot;: &lt;key&gt;, &quot;message&quot;: &lt;message&gt; }
</pre></div>
</div>
<p>The first event received is a handshake, and is used to inform the client about the uuid to use for configuring additional event filters</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>event: handshake
data: &lt;uuid&gt;
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="results.html" class="btn btn-neutral float-left" title="3.3.8. Build Result Codes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="www-data-module.html" class="btn btn-neutral float-right" title="3.3.10. Javascript Data Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.5.25.3. TestBuildStepMixin &mdash; Buildbot 4.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/buildbot_rtd.css?v=915d5e18" />

  
    <link rel="shortcut icon" href="../../../_static/icon.png"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=74d6e94f"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.6. Customization" href="../../customization.html" />
    <link rel="prev" title="2.5.25.2. TestReactorMixin" href="reactor.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Buildbot
              <img src="../../../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/index.html">2.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../secretsmanagement.html">2.4. Secret Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">2.5. Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro.html">2.5.1. Configuring Buildbot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../global.html">2.5.2. Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changesources.html">2.5.3. Change Sources and Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changesources.html#changes">2.5.4. Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../schedulers.html">2.5.5. Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workers.html">2.5.6. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builders.html">2.5.7. Builder Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../projects.html">2.5.8. Projects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../buildfactories.html">2.5.9. Build Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../buildsets.html">2.5.10. Build Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../properties.html">2.5.11. Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../steps/index.html">2.5.12. Build Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interlocks.html">2.5.13. Interlocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../report_generators/index.html">2.5.14. Report Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reporters/index.html">2.5.15. Reporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../www.html">2.5.16. Web Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wwwhooks.html">2.5.17. Change Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../services/index.html">2.5.18. Custom Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dbconfig.html">2.5.19. DbConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configurators.html">2.5.20. Configurators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manhole.html">2.5.21. Manhole</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multimaster.html">2.5.22. Multimaster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multicodebase.html">2.5.23. Multiple-Codebase Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/index.html">2.5.24. Miscellaneous Configuration</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">2.5.25. Testing Utilities</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="expect.html">2.5.25.1. Worker command expectations</a></li>
<li class="toctree-l4"><a class="reference internal" href="reactor.html">2.5.25.2. TestReactorMixin</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">2.5.25.3. TestBuildStepMixin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmdline.html">2.7. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources.html">2.8. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization.html">2.9. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">2.10. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deploy.html">2.11. Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrading/index.html">2.12. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><span class="section-number">2. </span>Buildbot Manual</a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">2.5. </span>Configuration</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">2.5.25. </span>Testing Utilities</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.5.25.3. </span>TestBuildStepMixin</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/manual/configuration/tests/steps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="testbuildstepmixin">
<span id="test-testbuildstepmixin"></span><h1><span class="section-number">2.5.25.3. </span>TestBuildStepMixin<a class="headerlink" href="#testbuildstepmixin" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.test.steps.</span></span><span class="sig-name descname"><span class="pre">TestBuildStepMixin</span></span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin" title="Link to this definition"></a></dt>
<dd><p>The class <code class="xref py py-class docutils literal notranslate"><span class="pre">TestBuildStepMixin</span></code> allows to test build steps.
It mocks the connection to the worker.
The commands sent to the worker can be verified and command results can be injected back into the step under test.
Additionally, the step under test is modified to allow checking how the step runs and what results it produces.</p>
<p>The following is an example of a basic step test:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RemovePYCs</span><span class="p">(</span><span class="n">TestBuildStepMixin</span><span class="p">,</span> <span class="n">TestReactorMixin</span><span class="p">,</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@defer</span><span class="o">.</span><span class="n">inlineCallbacks</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_test_reactor</span><span class="p">()</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_test_build_step</span><span class="p">()</span>

    <span class="nd">@defer</span><span class="o">.</span><span class="n">inlineCallbacks</span>
    <span class="k">def</span> <span class="nf">test_run_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_step</span><span class="p">(</span><span class="n">python_twisted</span><span class="o">.</span><span class="n">RemovePYCs</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expect_commands</span><span class="p">(</span>
            <span class="n">ExpectShell</span><span class="p">(</span><span class="n">workdir</span><span class="o">=</span><span class="s1">&#39;wkdir&#39;</span><span class="p">,</span>
                        <span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;find&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;-name&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">*.pyc</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;-exec&#39;</span><span class="p">,</span> <span class="s1">&#39;rm&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expect_outcome</span><span class="p">(</span><span class="n">result</span><span class="o">=</span><span class="n">SUCCESS</span><span class="p">,</span> <span class="n">state_string</span><span class="o">=</span><span class="s1">&#39;remove .pycs&#39;</span><span class="p">)</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
</pre></div>
</div>
<p>Basic workflow is as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>The test case must derive from <code class="docutils literal notranslate"><span class="pre">TestReactorMixin</span></code> and properly setup it.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">setUp()</span></code> of test case call <code class="docutils literal notranslate"><span class="pre">self.setup_test_build_step()</span></code>.</p></li>
<li><dl class="simple">
<dt>In unit test first optionally call <code class="docutils literal notranslate"><span class="pre">self.setup_build(...)</span></code> function to setup information</dt><dd><p>that will be available to the step during the test.</p>
</dd>
</dl>
</li>
<li><p>In unit test call <code class="docutils literal notranslate"><span class="pre">self.setup_step(step)</span></code> which will setup the step for testing.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">self.expect_commands(commands)</span></code> to specify commands that the step is expected to run and the results of these commands.</p></li>
<li><p>Call various other <code class="docutils literal notranslate"><span class="pre">expect_*</span></code> member functions to define other expectations.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">self.run_step()</span></code> to actually run the step.</p></li>
</ul>
</div></blockquote>
<p>All expectations are verified once the step has completed running.</p>
<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.setup_test_build_step">
<span class="sig-name descname"><span class="pre">setup_test_build_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.setup_test_build_step" title="Link to this definition"></a></dt>
<dd><p>Call this function in the <code class="docutils literal notranslate"><span class="pre">setUp()</span></code> method of the test case to setup step testing machinery.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.setup_build">
<span class="sig-name descname"><span class="pre">setup_build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.setup_build" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>worker_env</strong> (<em>dict</em>) – An optional dictionary of environment variables on the mock worker.</p></li>
<li><p><strong>build_files</strong> (<em>list</em>) – An optional list of source files that were changed in the build.</p></li>
</ul>
</dd>
</dl>
<p>Sets up build and worker information that will be available to the tested step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.setup_step">
<span class="sig-name descname"><span class="pre">setup_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.setup_step" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<a class="reference internal" href="../../../developer/cls-buildsteps.html#buildbot.process.buildstep.BuildStep" title="buildbot.process.buildstep.BuildStep"><em>BuildStep</em></a>) – An instance of <code class="docutils literal notranslate"><span class="pre">BuildStep</span></code> to test.</p></li>
<li><p><strong>worker_env</strong> (<em>dict</em>) – An optional dictionary of environment variables on the mock worker (deprecated).</p></li>
<li><p><strong>build_files</strong> (<em>list</em>) – An optional list of source files that were changed in the build (deprecated).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of prepared step (not the same as the <code class="docutils literal notranslate"><span class="pre">step</span></code> argument).</p>
</dd>
</dl>
<p>Prepares the given step for testing. This function may be invoked multiple times.
The <code class="docutils literal notranslate"><span class="pre">step</span></code> argument is used as a step factory, just like in real Buildbot.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.step">
<span class="sig-name descname"><span class="pre">step</span></span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.step" title="Link to this definition"></a></dt>
<dd><p>(deprecated) The step under test.
This attribute is available after <code class="docutils literal notranslate"><span class="pre">setup_step()</span></code> is run.</p>
<p>This function has been deprecated, use <code class="docutils literal notranslate"><span class="pre">get_nth_step(0)</span></code> as a replacement</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.get_nth_step">
<span class="sig-name descname"><span class="pre">get_nth_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.get_nth_step" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – The index of the step to retrieve</p>
</dd>
</dl>
<p>Retrieves the instance of a step that has been created by <code class="docutils literal notranslate"><span class="pre">setup_step()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_commands">
<span class="sig-name descname"><span class="pre">expect_commands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">commands</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_commands" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>commands</strong> – A list of commands that are expected to be run (a subclass of <a class="reference internal" href="expect.html#buildbot.test.steps.Expect" title="buildbot.test.steps.Expect"><code class="xref py py-class docutils literal notranslate"><span class="pre">buildbot.test.steps.Expect</span></code></a>).</p>
</dd>
</dl>
<p>Sets up an expectation of step sending the given commands to worker.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_outcome">
<span class="sig-name descname"><span class="pre">expect_outcome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_outcome" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> – A result from <cite>buildbot.process.results</cite>.</p></li>
<li><p><strong>state_string</strong> (<em>str</em>) – An optional status text.</p></li>
</ul>
</dd>
</dl>
<p>Sets up an expectation of the step result. If there are multiple steps registered to the
test, then there must be as many calls to <code class="docutils literal notranslate"><span class="pre">expect_outcome</span></code> as there are steps, in the
same order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_property">
<span class="sig-name descname"><span class="pre">expect_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_property" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property</strong> (<em>str</em>) – The name of the property</p></li>
<li><p><strong>value</strong> (<em>str</em>) – The value of the property</p></li>
<li><p><strong>source</strong> (<em>str</em>) – An optional source of the property</p></li>
</ul>
</dd>
</dl>
<p>Sets up an expectation of a property set by the step. If there are multiple steps
registered to the test, then this function tests the cumulative set of properties set
on the build.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_no_property">
<span class="sig-name descname"><span class="pre">expect_no_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_no_property" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>property</strong> (<em>str</em>) – The name of the property</p>
</dd>
</dl>
<p>Sets up an expectation of an absence of a property set by the step. If there are multiple
steps registered to the test, then this function expects that no tests set the property.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_log_file">
<span class="sig-name descname"><span class="pre">expect_log_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_log_file" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfile</strong> (<em>str</em>) – The name of the log file</p></li>
<li><p><strong>contents</strong> (<em>str</em>) – The contents of the log file</p></li>
<li><p><strong>step_index</strong> (<em>int</em>) – The index of the step whose logs to investigate.</p></li>
</ul>
</dd>
</dl>
<p>Sets up an expectation of a log file being produced by the step.
Only the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> associated with the log file is checked.
To check the <code class="docutils literal notranslate"><span class="pre">stderr</span></code> see <code class="docutils literal notranslate"><span class="pre">expect_log_file_stderr()</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_log_file_stderr">
<span class="sig-name descname"><span class="pre">expect_log_file_stderr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_log_file_stderr" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfile</strong> (<em>str</em>) – The name of the log file</p></li>
<li><p><strong>contents</strong> (<em>str</em>) – The contents of the log file</p></li>
<li><p><strong>step_index</strong> (<em>int</em>) – The index of the step whose logs to investigate.</p></li>
</ul>
</dd>
</dl>
<p>Sets up an expectation of a <code class="docutils literal notranslate"><span class="pre">stderr</span></code> output in log file being produced by the step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_build_data">
<span class="sig-name descname"><span class="pre">expect_build_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_build_data" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the build data.</p></li>
<li><p><strong>value</strong> (<em>str</em>) – The value of the build data.</p></li>
<li><p><strong>source</strong> (<em>str</em>) – The source of the build data.</p></li>
</ul>
</dd>
</dl>
<p>Sets up an expectation of build data produced by the step. If there are multiple steps
registered to the test, then this function tests the cumulative set of build data added to
the build.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_hidden">
<span class="sig-name descname"><span class="pre">expect_hidden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_hidden" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hidden</strong> (<em>bool</em>) – Whether the step should be hidden.</p>
</dd>
</dl>
<p>Sets up an expectation of step being hidden on completion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.expect_exception">
<span class="sig-name descname"><span class="pre">expect_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expection_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.expect_exception" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>expection_class</strong> – The type of the class to expect.</p>
</dd>
</dl>
<p>Sets up an expectation of an exception being raised during the runtime of the step.
The expected result of the step is automatically set to <code class="docutils literal notranslate"><span class="pre">EXCEPTION</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buildbot.test.steps.TestBuildStepMixin.run_step">
<span class="sig-name descname"><span class="pre">run_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#buildbot.test.steps.TestBuildStepMixin.run_step" title="Link to this definition"></a></dt>
<dd><p>Runs the steps and validates the expectations setup before this function.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reactor.html" class="btn btn-neutral float-left" title="2.5.25.2. TestReactorMixin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../customization.html" class="btn btn-neutral float-right" title="2.6. Customization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.5.11.42. Transferring Files &mdash; Buildbot 3.7.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/buildbot_rtd.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/icon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.5.11.44. MasterShellCommand" href="master_shell_command.html" />
    <link rel="prev" title="2.5.11.41. Worker Filesystem Steps" href="worker_filesystem.html" /> 
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Buildbot
            <img src="../../../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">1. Buildbot Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">2. Buildbot Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/index.html">2.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts.html">2.3. Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../secretsmanagement.html">2.4. Secret Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">2.5. Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro.html">2.5.1. Configuring Buildbot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../global.html">2.5.2. Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changesources.html">2.5.3. Change Sources and Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changesources.html#changes">2.5.4. Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../schedulers.html">2.5.5. Schedulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workers.html">2.5.6. Workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builders.html">2.5.7. Builder Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../buildfactories.html">2.5.8. Build Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../buildsets.html">2.5.9. Build Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../properties.html">2.5.10. Properties</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">2.5.11. Build Steps</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="common.html">2.5.11.1. Parameters Common to all Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_common.html">2.5.11.2. Common Parameters of source checkout operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_bzr.html">2.5.11.3. Bzr</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_cvs.html">2.5.11.4. CVS</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_darcs.html">2.5.11.5. Darcs</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_gerrit.html">2.5.11.6. Gerrit</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_github.html">2.5.11.7. GitHub</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_gitlab.html">2.5.11.8. GitLab</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_git.html">2.5.11.9. Git</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_mercurial.html">2.5.11.10. Mercurial</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_monotone.html">2.5.11.11. Monotone</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_p4.html">2.5.11.12. P4</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_repo.html">2.5.11.13. Repo</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_svn.html">2.5.11.14. SVN</a></li>
<li class="toctree-l4"><a class="reference internal" href="gitcommit.html">2.5.11.15. GitCommit</a></li>
<li class="toctree-l4"><a class="reference internal" href="gittag.html">2.5.11.16. GitTag</a></li>
<li class="toctree-l4"><a class="reference internal" href="gitpush.html">2.5.11.17. GitPush</a></li>
<li class="toctree-l4"><a class="reference internal" href="git_diffinfo.html">2.5.11.18. GitDiffInfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="shell_command.html">2.5.11.19. ShellCommand</a></li>
<li class="toctree-l4"><a class="reference internal" href="shell_sequence.html">2.5.11.20. Shell Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="compile.html">2.5.11.21. Compile</a></li>
<li class="toctree-l4"><a class="reference internal" href="configure.html">2.5.11.22. Configure</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmake.html">2.5.11.23. CMake</a></li>
<li class="toctree-l4"><a class="reference internal" href="visual_cxx.html">2.5.11.24. Visual C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="cppcheck.html">2.5.11.25. Cppcheck</a></li>
<li class="toctree-l4"><a class="reference internal" href="robocopy.html">2.5.11.26. Robocopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="test.html">2.5.11.27. Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="treesize.html">2.5.11.28. TreeSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="perl_module_test.html">2.5.11.29. PerlModuleTest</a></li>
<li class="toctree-l4"><a class="reference internal" href="subunit_shell_command.html">2.5.11.30. SubunitShellCommand</a></li>
<li class="toctree-l4"><a class="reference internal" href="hlint.html">2.5.11.31. HLint</a></li>
<li class="toctree-l4"><a class="reference internal" href="maxq.html">2.5.11.32. MaxQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="trigger.html">2.5.11.33. Trigger</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_epydoc.html">2.5.11.34. BuildEPYDoc</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyflakes.html">2.5.11.35. PyFlakes</a></li>
<li class="toctree-l4"><a class="reference internal" href="sphinx.html">2.5.11.36. Sphinx</a></li>
<li class="toctree-l4"><a class="reference internal" href="pylint.html">2.5.11.37. PyLint</a></li>
<li class="toctree-l4"><a class="reference internal" href="trial.html">2.5.11.38. Trial</a></li>
<li class="toctree-l4"><a class="reference internal" href="remove_pycs.html">2.5.11.39. RemovePYCs</a></li>
<li class="toctree-l4"><a class="reference internal" href="http_step.html">2.5.11.40. HTTP Requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="worker_filesystem.html">2.5.11.41. Worker Filesystem Steps</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">2.5.11.42. Transferring Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transferring-strings">2.5.11.43. Transferring Strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="master_shell_command.html">2.5.11.44. MasterShellCommand</a></li>
<li class="toctree-l4"><a class="reference internal" href="log_renderable.html">2.5.11.45. LogRenderable</a></li>
<li class="toctree-l4"><a class="reference internal" href="assert.html">2.5.11.46. Assert</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_property.html">2.5.11.47. SetProperty</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_properties.html">2.5.11.48. SetProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_property_from_command.html">2.5.11.49. SetPropertyFromCommand</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_properties_from_env.html">2.5.11.50. SetPropertiesFromEnv</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm_build.html">2.5.11.51. RpmBuild</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm_lint.html">2.5.11.52. RpmLint</a></li>
<li class="toctree-l4"><a class="reference internal" href="mock_build_srpm.html">2.5.11.53. MockBuildSRPM Step</a></li>
<li class="toctree-l4"><a class="reference internal" href="mock_rebuild.html">2.5.11.54. MockRebuild</a></li>
<li class="toctree-l4"><a class="reference internal" href="deb_pbuilder.html">2.5.11.55. DebPbuilder</a></li>
<li class="toctree-l4"><a class="reference internal" href="deb_pbuilder.html#debcowbuilder">2.5.11.56. DebCowbuilder</a></li>
<li class="toctree-l4"><a class="reference internal" href="deb_lintian.html">2.5.11.57. DebLintian</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#id2">2.5.11.58. Build steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interlocks.html">2.5.12. Interlocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../report_generators/index.html">2.5.13. Report Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reporters/index.html">2.5.14. Reporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../www.html">2.5.15. Web Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wwwhooks.html">2.5.16. Change Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../services/index.html">2.5.17. Custom Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dbconfig.html">2.5.18. DbConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configurators.html">2.5.19. Configurators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manhole.html">2.5.20. Manhole</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multimaster.html">2.5.21. Multimaster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multicodebase.html">2.5.22. Multiple-Codebase Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/index.html">2.5.23. Miscellaneous Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tests/index.html">2.5.24. Testing Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../customization.html">2.6. Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmdline.html">2.7. Command-line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources.html">2.8. Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization.html">2.9. Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">2.10. Plugin Infrastructure in Buildbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deploy.html">2.11. Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrading/index.html">2.12. Upgrading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">3. Buildbot Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../relnotes/index.html">4. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../relnotes/index.html#older-release-notes">5. Older Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indices.html">6. API Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Buildbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html"><span class="section-number">2. </span>Buildbot Manual</a> &raquo;</li>
          <li><a href="../index.html"><span class="section-number">2.5. </span>Configuration</a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">2.5.11. </span>Build Steps</a> &raquo;</li>
      <li><span class="section-number">2.5.11.42. </span>Transferring Files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/manual/configuration/steps/file_transfer.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Buildbot no longer supports Python 2.7 on the Buildbot master.</p>
</div>
<span class="target" id="index-0"></span><span class="target" id="step-FileUpload"></span><section id="transferring-files">
<span id="step-filetransfer"></span><span id="step-FileDownload"></span><h1><span class="section-number">2.5.11.42. </span>Transferring Files<a class="headerlink" href="#transferring-files" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.FileUpload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">FileUpload</span></span><a class="headerlink" href="#buildbot.steps.transfer.FileUpload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.FileDownload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">FileDownload</span></span><a class="headerlink" href="#buildbot.steps.transfer.FileDownload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Most of the work involved in a build will take place on the worker.
But occasionally it is useful to do some work on the buildmaster side.
The most basic way to involve the buildmaster is simply to move a file from the worker to the master, or vice versa.
There are a pair of steps named <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a> and <a class="reference internal" href="#step-FileDownload" title="FileDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileDownload</span></code></a> to provide this functionality.
<a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a> moves a file <em>up to</em> the master, while <a class="reference internal" href="#step-FileDownload" title="FileDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileDownload</span></code></a> moves a file <em>down from</em> the master.</p>
<p>As an example, let’s assume that there is a step which produces an HTML file within the source tree that contains some sort of generated project documentation.
And let’s assume that we run nginx web server on the buildmaster host for serving static files.
We want to move this file to the buildmaster, into a <code class="file docutils literal notranslate"><span class="pre">/usr/share/nginx/www/</span></code> directory, so it can be visible to developers.
This file will wind up in the worker-side working directory under the name <code class="file docutils literal notranslate"><span class="pre">docs/reference.html</span></code>.
We want to put it into the master-side <code class="file docutils literal notranslate"><span class="pre">/usr/share/nginx/www/ref.html</span></code>, and add a link to the HTML status to the uploaded file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">ShellCommand</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;docs&quot;</span><span class="p">]))</span>
<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">FileUpload</span><span class="p">(</span><span class="n">workersrc</span><span class="o">=</span><span class="s2">&quot;docs/reference.html&quot;</span><span class="p">,</span>
                           <span class="n">masterdest</span><span class="o">=</span><span class="s2">&quot;/usr/share/nginx/www/ref.html&quot;</span><span class="p">,</span>
                           <span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://somesite/~buildbot/ref.html&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">masterdest=</span></code> argument will be passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">os.path.expanduser</span></code>, so things like <code class="docutils literal notranslate"><span class="pre">~</span></code> will be expanded properly.
Non-absolute paths will be interpreted relative to the buildmaster’s base directory.
Likewise, the <code class="docutils literal notranslate"><span class="pre">workersrc=</span></code> argument will be expanded and interpreted relative to the builder’s working directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The copied file will have the same permissions on the master as on the worker, look at the <code class="docutils literal notranslate"><span class="pre">mode=</span></code> parameter to set it differently.</p>
</div>
<p>To move a file from the master to the worker, use the <a class="reference internal" href="#step-FileDownload" title="FileDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileDownload</span></code></a> command.
For example, let’s assume that some step requires a configuration file that, for whatever reason, could not be recorded in the source code repository or generated on the worker side:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">FileDownload</span><span class="p">(</span><span class="n">mastersrc</span><span class="o">=</span><span class="s2">&quot;~/todays_build_config.txt&quot;</span><span class="p">,</span>
                             <span class="n">workerdest</span><span class="o">=</span><span class="s2">&quot;build_config.txt&quot;</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">ShellCommand</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<p>Like <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a>, the <code class="docutils literal notranslate"><span class="pre">mastersrc=</span></code> argument is interpreted relative to the buildmaster’s base directory, and the <code class="docutils literal notranslate"><span class="pre">workerdest=</span></code> argument is relative to the builder’s working directory.
If the worker is running in <code class="file docutils literal notranslate"><span class="pre">~worker</span></code>, and the builder’s <code class="docutils literal notranslate"><span class="pre">builddir</span></code> is something like <code class="file docutils literal notranslate"><span class="pre">tests-i386</span></code>, then the workdir is going to be <code class="file docutils literal notranslate"><span class="pre">~worker/tests-i386/build</span></code>, and a <code class="docutils literal notranslate"><span class="pre">workerdest=</span></code> of <code class="file docutils literal notranslate"><span class="pre">foo/bar.html</span></code> will get put in <code class="file docutils literal notranslate"><span class="pre">~worker/tests-i386/build/foo/bar.html</span></code>.
Both of these commands will create any missing intervening directories.</p>
<section id="other-parameters">
<h2>Other Parameters<a class="headerlink" href="#other-parameters" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">maxsize=</span></code> argument lets you set a maximum size for the file to be transferred.
This may help to avoid surprises: transferring a 100MB coredump when you were expecting to move a 10kB status file might take an awfully long time.
The <code class="docutils literal notranslate"><span class="pre">blocksize=</span></code> argument controls how the file is sent over the network: larger blocksizes are slightly more efficient but also consume more memory on each end, and there is a hard-coded limit of about 640kB.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mode=</span></code> argument allows you to control the access permissions of the target file, traditionally expressed as an octal integer.
The most common value is probably <code class="docutils literal notranslate"><span class="pre">0o755</span></code>, which sets the <cite>x</cite> executable bit on the file (useful for shell scripts and the like).
The default value for <code class="docutils literal notranslate"><span class="pre">mode=</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means the permission bits will default to whatever the umask of the writing process is.
The default umask tends to be fairly restrictive, but at least on the worker you can make it less restrictive with a <code class="docutils literal notranslate"><span class="pre">--umask</span></code> command-line option at creation time (<a class="reference internal" href="../../installation/worker.html#worker-options"><span class="std std-ref">Worker Options</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">keepstamp=</span></code> argument is a boolean that, when <code class="docutils literal notranslate"><span class="pre">True</span></code>, forces the modified and accessed time of the destination file to match the times of the source file.
When <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default), the modified and accessed times of the destination file are set to the current time on the buildmaster.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">url=</span></code> argument allows you to specify an url that will be displayed in the HTML status.
The title of the url will be the name of the item transferred (directory for <code class="xref py py-class docutils literal notranslate"><span class="pre">DirectoryUpload</span></code> or file for <code class="xref py py-class docutils literal notranslate"><span class="pre">FileUpload</span></code>).
This allows the user to add a link to the uploaded item if that one is uploaded to an accessible place.</p>
<p>For <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a>, the <code class="docutils literal notranslate"><span class="pre">urlText=</span></code> argument allows you to specify the url title that will be displayed in the web UI.</p>
</section>
<section id="transferring-directories">
<span id="step-DirectoryUpload"></span><h2>Transferring Directories<a class="headerlink" href="#transferring-directories" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.DirectoryUpload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">DirectoryUpload</span></span><a class="headerlink" href="#buildbot.steps.transfer.DirectoryUpload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>To transfer complete directories from the worker to the master, there is a <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildStep</span></code> named <a class="reference internal" href="#step-DirectoryUpload" title="DirectoryUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">DirectoryUpload</span></code></a>.
It works like <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a>, just for directories.
However it does not support the <code class="docutils literal notranslate"><span class="pre">maxsize</span></code>, <code class="docutils literal notranslate"><span class="pre">blocksize</span></code> and <code class="docutils literal notranslate"><span class="pre">mode</span></code> arguments.
As an example, let’s assume an generated project documentation, which consists of many files (like the output of <strong class="command">doxygen</strong> or <strong class="command">epydoc</strong>).
And let’s assume that we run nginx web server on buildmaster host for serving static files.
We want to move the entire documentation to the buildmaster, into a <code class="file docutils literal notranslate"><span class="pre">/usr/share/nginx/www/docs</span></code> directory, and add a link to the uploaded documentation on the HTML status page.
On the worker-side the directory can be found under <code class="file docutils literal notranslate"><span class="pre">docs</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">ShellCommand</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;docs&quot;</span><span class="p">]))</span>
<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">DirectoryUpload</span><span class="p">(</span><span class="n">workersrc</span><span class="o">=</span><span class="s2">&quot;docs&quot;</span><span class="p">,</span>
                                <span class="n">masterdest</span><span class="o">=</span><span class="s2">&quot;/usr/share/nginx/www/docs&quot;</span><span class="p">,</span>
                                <span class="n">url</span><span class="o">=</span><span class="s2">&quot;~buildbot/docs&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#step-DirectoryUpload" title="DirectoryUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">DirectoryUpload</span></code></a> step will create all necessary directories and transfers empty directories, too.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">maxsize</span></code> and <code class="docutils literal notranslate"><span class="pre">blocksize</span></code> parameters are the same as for <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a>, although note that the size of the transferred data is implementation-dependent, and probably much larger than you expect due to the encoding used (currently tar).</p>
<p>The optional <code class="docutils literal notranslate"><span class="pre">compress</span></code> argument can be given as <code class="docutils literal notranslate"><span class="pre">'gz'</span></code> or <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code> to compress the datastream.</p>
<p>For <a class="reference internal" href="#step-DirectoryUpload" title="DirectoryUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">DirectoryUpload</span></code></a> the <code class="docutils literal notranslate"><span class="pre">urlText=</span></code> argument allows you to specify the url title that will be displayed in the web UI.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The permissions on the copied files will be the same on the master as originally on the worker, see option <code class="docutils literal notranslate"><span class="pre">buildbot-worker</span> <span class="pre">create-worker</span> <span class="pre">--umask</span></code> to change the default one.</p>
</div>
</section>
<section id="transferring-multiple-files-at-once">
<span id="step-MultipleFileUpload"></span><h2>Transferring Multiple Files At Once<a class="headerlink" href="#transferring-multiple-files-at-once" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.MultipleFileUpload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">MultipleFileUpload</span></span><a class="headerlink" href="#buildbot.steps.transfer.MultipleFileUpload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>In addition to the <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a> and <a class="reference internal" href="#step-DirectoryUpload" title="DirectoryUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">DirectoryUpload</span></code></a> steps there is the <a class="reference internal" href="#step-MultipleFileUpload" title="MultipleFileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">MultipleFileUpload</span></code></a> step for uploading a bunch of files (and directories) in a single <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildStep</span></code>.
The step supports all arguments that are supported by <a class="reference internal" href="#step-FileUpload" title="FileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileUpload</span></code></a> and <a class="reference internal" href="#step-DirectoryUpload" title="DirectoryUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">DirectoryUpload</span></code></a>, but instead of a the single <code class="docutils literal notranslate"><span class="pre">workersrc</span></code> parameter it takes a (plural) <code class="docutils literal notranslate"><span class="pre">workersrcs</span></code> parameter.
This parameter should either be a list, something that can be rendered as a list or a string which will be converted to a list.
Additionally it supports the <code class="docutils literal notranslate"><span class="pre">glob</span></code> parameter if this parameter is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> all arguments in <code class="docutils literal notranslate"><span class="pre">workersrcs</span></code> will be parsed through <code class="docutils literal notranslate"><span class="pre">glob</span></code> and the results will be uploaded to <code class="docutils literal notranslate"><span class="pre">masterdest</span></code>.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">ShellCommand</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]))</span>
<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">ShellCommand</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;docs&quot;</span><span class="p">]))</span>
<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">MultipleFileUpload</span><span class="p">(</span><span class="n">workersrcs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;docs&quot;</span><span class="p">,</span> <span class="s2">&quot;test-results.html&quot;</span><span class="p">],</span>
                                   <span class="n">masterdest</span><span class="o">=</span><span class="s2">&quot;/usr/share/nginx/www/&quot;</span><span class="p">,</span>
                                   <span class="n">url</span><span class="o">=</span><span class="s2">&quot;~buildbot&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">url=</span></code> parameter, can be used to specify a link to be displayed in the HTML status of the step.</p>
<p>The way URLs are added to the step can be customized by extending the <a class="reference internal" href="#step-MultipleFileUpload" title="MultipleFileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">MultipleFileUpload</span></code></a> class.
The <cite>allUploadsDone</cite> method is called after all files have been uploaded and sets the URL.
The <cite>uploadDone</cite> method is called once for each uploaded file and can be used to create file-specific links.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="k">class</span> <span class="nc">CustomFileUpload</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">MultipleFileUpload</span><span class="p">):</span>
    <span class="n">linkTypes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">linkFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basename</span><span class="p">):</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkTypes</span>

    <span class="k">def</span> <span class="nf">uploadDone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">masterdest</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkFile</span><span class="p">(</span><span class="n">basename</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addURL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">basename</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">allUploadsDone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">masterdest</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
            <span class="n">notLinked</span> <span class="o">=</span> <span class="p">[</span><span class="n">src</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">sources</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkFile</span><span class="p">(</span><span class="n">src</span><span class="p">)]</span>
            <span class="n">numFiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">notLinked</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">numFiles</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addURL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;... </span><span class="si">%d</span><span class="s1"> more&#39;</span> <span class="o">%</span> <span class="n">numFiles</span><span class="p">)</span>
</pre></div>
</div>
<p>For <a class="reference internal" href="#step-MultipleFileUpload" title="MultipleFileUpload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">MultipleFileUpload</span></code></a> the <code class="docutils literal notranslate"><span class="pre">urlText=</span></code> argument allows you to specify the url title that will be displayed in the web UI.</p>
<span class="target" id="step-StringDownload"></span><span class="target" id="step-JSONStringDownload"></span></section>
</section>
<section id="transferring-strings">
<span id="step-JSONPropertiesDownload"></span><h1><span class="section-number">2.5.11.43. </span>Transferring Strings<a class="headerlink" href="#transferring-strings" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.StringDownload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">StringDownload</span></span><a class="headerlink" href="#buildbot.steps.transfer.StringDownload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.JSONStringDownload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">JSONStringDownload</span></span><a class="headerlink" href="#buildbot.steps.transfer.JSONStringDownload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="buildbot.steps.transfer.JSONPropertiesDownload">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">buildbot.steps.transfer.</span></span><span class="sig-name descname"><span class="pre">JSONPropertiesDownload</span></span><a class="headerlink" href="#buildbot.steps.transfer.JSONPropertiesDownload" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Sometimes it is useful to transfer a calculated value from the master to the worker.
Instead of having to create a temporary file and then use FileDownload, you can use one of the string download steps.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span><span class="p">,</span> <span class="n">util</span>

<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">StringDownload</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">Interpolate</span><span class="p">(</span><span class="s2">&quot;%(src::branch)s-%(prop:got_revision)s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">workerdest</span><span class="o">=</span><span class="s2">&quot;buildid.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><a class="reference internal" href="#step-StringDownload" title="StringDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">StringDownload</span></code></a> works just like <a class="reference internal" href="#step-FileDownload" title="FileDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">FileDownload</span></code></a> except it takes a single argument, <code class="docutils literal notranslate"><span class="pre">s</span></code>, representing the string to download instead of a <code class="docutils literal notranslate"><span class="pre">mastersrc</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="n">buildinfo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;branch&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="s1">&#39;branch&#39;</span><span class="p">),</span>
    <span class="s1">&#39;got_revision&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="s1">&#39;got_revision&#39;</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">JSONStringDownload</span><span class="p">(</span><span class="n">buildinfo</span><span class="p">,</span> <span class="n">workerdest</span><span class="o">=</span><span class="s2">&quot;buildinfo.json&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><a class="reference internal" href="#step-JSONStringDownload" title="JSONStringDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">JSONStringDownload</span></code></a> is similar, except it takes an <code class="docutils literal notranslate"><span class="pre">o</span></code> argument, which must be JSON serializable, and transfers that as a JSON-encoded string to the worker.</p>
<div class="highlight-python notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">steps</span>

<span class="n">f</span><span class="o">.</span><span class="n">addStep</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">JSONPropertiesDownload</span><span class="p">(</span><span class="n">workerdest</span><span class="o">=</span><span class="s2">&quot;build-properties.json&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><a class="reference internal" href="#step-JSONPropertiesDownload" title="JSONPropertiesDownload"><code class="xref bb bb-step docutils literal notranslate"><span class="pre">JSONPropertiesDownload</span></code></a> transfers a json-encoded string that represents a dictionary where properties maps to a dictionary of build property <code class="docutils literal notranslate"><span class="pre">name</span></code> to property <code class="docutils literal notranslate"><span class="pre">value</span></code>; and <code class="docutils literal notranslate"><span class="pre">sourcestamp</span></code> represents the build’s sourcestamp.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="worker_filesystem.html" class="btn btn-neutral float-left" title="2.5.11.41. Worker Filesystem Steps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="master_shell_command.html" class="btn btn-neutral float-right" title="2.5.11.44. MasterShellCommand" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Buildbot Team Members.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>